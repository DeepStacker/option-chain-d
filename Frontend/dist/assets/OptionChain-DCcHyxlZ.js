import{r as o,j as t,R as V,t as ws}from"./animations-CCQynVHD.js";import{e as Jr,u as le,w as yn}from"./redux-CHwIDTp6.js";import{n as Ve,b as ir,o as or,p as cr,q as kn,c as jn,r as Js,t as wn,v as Nn,w as Cn,x as Sn,y as $n,z as _n,A as Lr,C as Bt,d as En,D as Fn,E as Zs,F as Zr,G as Tt,I as Cr,J as Tn,K as Pn,M as In,N as Sr,O as Ln,f as Mn,u as On,H as Rn}from"./index-DUqnRfh4.js";import{d as Ns}from"./network-htDwveLI.js";import{P as ie,C as Qs,B as ea}from"./Card-wJW6FCvb.js";import{x as wt,a as qe,_ as Mr,$ as Or,a0 as ta,a1 as Vn,a2 as Cs,g as ra,q as An,a3 as Bn,N as Dn,F as Ot,b as sa,C as aa,e as Gn,a4 as Hn,a5 as Ss,y as Wn,i as Un,a6 as zn,X as Kn,Y as qn}from"./icons-1ld_-Ybk.js";import{g as Yn,a as Xn,b as Jn,c as Zn,d as Qn}from"./analyticsApi-D381RQui.js";import{S as el}from"./Skeleton-Dr9iDnWc.js";import{h as $r,W as tl,g as rl}from"./charts-SeOzVKbO.js";import"./firebase-UuSzqDeJ.js";const bt="option_chain_table_settings",Xt={sortOrder:"desc",highlightITM:!0,compactMode:!0,showStrikePanel:!1,selectedStrike:null,strikesPerPage:21},na=o.createContext(null);function sl({children:e}){const[r,s]=o.useState(()=>{try{const u=localStorage.getItem(bt);if(u)return{...Xt,...JSON.parse(u)}}catch(u){console.warn("Failed to load table settings:",u)}return Xt}),a=o.useCallback((u,h)=>{s(m=>{const p={...m,[u]:h};return localStorage.setItem(bt,JSON.stringify(p)),p})},[]),n=o.useCallback(()=>{s(u=>{const h=u.sortOrder==="asc"?"desc":"asc",m={...u,sortOrder:h};return localStorage.setItem(bt,JSON.stringify(m)),m})},[]),l=o.useCallback(()=>{s(u=>{const h={...u,highlightITM:!u.highlightITM};return localStorage.setItem(bt,JSON.stringify(h)),h})},[]),i=o.useCallback(()=>{s(u=>{const h={...u,compactMode:!u.compactMode};return localStorage.setItem(bt,JSON.stringify(h)),h})},[]),c=o.useCallback(u=>{s(h=>({...h,selectedStrike:u,showStrikePanel:u!==null}))},[]),d=o.useCallback(()=>{localStorage.setItem(bt,JSON.stringify(Xt)),s(Xt)},[]),g=o.useMemo(()=>({settings:r,updateSetting:a,toggleSortOrder:n,toggleITMHighlight:l,toggleCompactMode:i,selectStrike:c,resetSettings:d}),[r,a,n,l,i,c,d]);return t.jsx(na.Provider,{value:g,children:e})}function dr(){const e=o.useContext(na);if(!e)throw new Error("useTableSettings must be used within TableSettingsProvider");return e}const al=(e,r={})=>{const s=o.useRef(null),a=o.useRef(null),[n,l]=o.useState(!1),[i,c]=o.useState(null),[d,g]=o.useState(null),{enabled:u=!0,autoReconnect:h=!0,reconnectInterval:m=5e3,maxReconnectAttempts:p=3,socketUrl:x="ws://localhost:8000/ws/options"}=r,b=o.useRef(0),v=async f=>{try{if(f instanceof Blob){const E=await f.arrayBuffer();return Ns(new Uint8Array(E))}return f instanceof ArrayBuffer?Ns(new Uint8Array(f)):typeof f=="string"?JSON.parse(f):f}catch(E){throw console.error("Error decoding message:",E),E}},y=o.useRef(e);o.useEffect(()=>{y.current=e},[e]);const k=o.useCallback(()=>{try{s.current&&s.current.close();const f=x.includes("/ws/")?x:`${x}/ws/options`;Ve.log("ðŸ”Œ Connecting to WebSocket:",f),s.current=new WebSocket(f),s.current.onopen=()=>{Ve.log("âœ… WebSocket Connected"),l(!0),c(null),b.current=0,s.current.readyState===WebSocket.OPEN&&s.current.send(JSON.stringify({type:"ping"}))},s.current.onmessage=async E=>{try{Ve.debug("ðŸ“© WebSocket raw message type:",typeof E.data,E.data instanceof Blob?"Blob":E.data instanceof ArrayBuffer?"ArrayBuffer":"String");const P=await v(E.data);Ve.debug("ðŸ“¦ WebSocket decoded data:",(P==null?void 0:P.type)||"live_data",P!=null&&P.oc?`(${Object.keys(P.oc).length} strikes)`:""),P.type==="connected"?(Ve.log("âœ… Connection confirmed, client_id:",P.client_id),c(null)):P.type==="subscribed"?(Ve.log("âœ… Subscribed to:",P.symbol,P.expiry),g({symbol:P.symbol,expiry:P.expiry}),c(null)):P.type==="unsubscribed"?(Ve.log("âœ… Unsubscribed"),g(null)):P.type==="pong"||(P.type==="error"?(console.error("WebSocket Error Message:",P.message),c(P.message)):(i&&c(null),Ve.debug("ðŸ“¡ Passing live data to callback"),y.current&&y.current(P)))}catch(P){console.error("Error processing WebSocket message:",P)}},s.current.onerror=()=>{c("WebSocket connection error"),l(!1)},s.current.onclose=E=>{Ve.log("ðŸ”Œ WebSocket Disconnected:",E.code,E.reason),l(!1),g(null),h&&b.current<p&&!E.wasClean?(b.current+=1,Ve.log(`â³ Reconnecting... Attempt ${b.current}/${p}`),a.current=setTimeout(()=>{k()},m)):b.current>=p&&(console.warn("âš ï¸ WebSocket unavailable, using REST polling"),c("WebSocket unavailable - using polling"))}}catch(f){console.error("Error creating WebSocket:",f),c(f.message)}},[x,h,m,p]),N=o.useCallback(()=>{a.current&&clearTimeout(a.current),s.current&&(s.current.close(1e3,"Client disconnect"),s.current=null),l(!1),g(null)},[]),_=o.useCallback(f=>{if(s.current&&s.current.readyState===WebSocket.OPEN){const E=typeof f=="string"?f:JSON.stringify(f);return s.current.send(E),!0}else return console.warn("WebSocket is not connected. Message not sent:",f),!1},[]),C=o.useCallback((f,E)=>n?_({type:"subscribe",sid:f.toUpperCase(),exp_sid:E}):(console.warn("Cannot subscribe: WebSocket not connected"),!1),[n,_]),w=o.useCallback(()=>_({type:"unsubscribe"}),[_]);return o.useEffect(()=>(u?k():N(),()=>{N()}),[u,k,N]),{isConnected:n,error:i,subscription:d,sendMessage:_,subscribe:C,unsubscribe:w,disconnect:N,reconnect:k}},la=()=>{const e=Jr(),r=le(ir),s=le(or),a=le(cr),n=le(kn),l=le(jn),i=le(Js),c=le(wn),[d,g]=o.useState(!1),[u,h]=o.useState(3e3),[m,p]=o.useState(null),[x,b]=o.useState(!0),[v,y]=o.useState(!0),k=o.useRef(null),N=o.useRef(null),_=o.useRef(null),C=o.useMemo(()=>!!(a&&a.oc&&Object.keys(a.oc).length>0),[a]);o.useMemo(()=>!r||!s?null:`${r}:${s}`,[r,s]);const w=o.useMemo(()=>s&&typeof s=="number"&&s>0,[s]),f=o.useCallback(W=>{if((W==null?void 0:W.type)==="error"){console.warn("WebSocket error:",W.message);return}W&&(W.oc||W.spot||W.futures)&&(e(Nn(W)),p(new Date),x&&b(!1))},[e,x]),{isConnected:E,error:P,subscribe:L,unsubscribe:O,subscription:I}=al(f,{enabled:v});o.useEffect(()=>{e(Cn(E&&!!I)),e(Sn(E?"websocket":"api"))},[E,I,e]),o.useEffect(()=>{if(!v||d||!E||!r||!w)return;const W=`${r}:${s}`;_.current!==W&&(_.current&&(Ve.log("ðŸ“¡ Unsubscribing from:",_.current),O()),L(r,String(s)),_.current=W)},[E,r,s,w,d,v,L,O]),o.useEffect(()=>()=>{_.current&&(O(),_.current=null)},[O]);const q=o.useCallback(async()=>{if(!r||d)return;const W=`${r}:${s||"auto"}`;try{await e($n({symbol:r,expiry:s?String(s):null})).unwrap(),p(new Date),N.current=W,x&&b(!1)}catch(M){console.error("Failed to fetch option chain data:",M),x&&b(!1)}},[r,s,d,e,x]),se=o.useRef(s);o.useEffect(()=>{!r||!w||(se.current!==null&&se.current!==s&&q(),se.current=s)},[r,s,w,q]),o.useEffect(()=>{if(k.current&&(clearInterval(k.current),k.current=null),!(E&&I&&v&&!P)&&!(a!=null&&a.error&&(a.error.includes("404")||a.error.includes("Invalid")))&&!(d||!r))return k.current=setInterval(q,u),()=>{k.current&&(clearInterval(k.current),k.current=null)}},[q,u,d,r,E,I,v,P,a==null?void 0:a.error]);const te=o.useCallback(()=>{q()},[q]),S=o.useCallback(()=>{g(W=>!W)},[]),D=o.useCallback(W=>{h(W)},[]),H=o.useCallback(()=>{y(W=>!W)},[]);return o.useMemo(()=>({data:a,spotData:n,futuresData:l,expiryList:i,symbol:r,expiry:s,isLoading:c,isInitialLoad:x,isPaused:d,lastUpdated:m,refreshInterval:u,hasData:C,isWebSocketConnected:E,isStreaming:E&&!!I,wsError:P,useWebSocket:v,refresh:te,togglePause:S,setRefreshInterval:D,toggleWebSocket:H}),[a,n,l,i,r,s,c,x,d,m,u,C,E,I,P,v,te,S,D,H])},nl=["volume","oi","oichng"],ll=["ce","pe"],il=(e,r,s)=>r?s==="ce"?e<r?Math.round((r-e)/50):0:e>r?Math.round((e-r)/50):0:0,ol=(e,r,s,a)=>e>100?"bg-blue-200 dark:bg-blue-800 text-blue-900 dark:text-blue-100 font-bold border border-blue-300 dark:border-blue-600":r===1?s==="ce"?"bg-rose-200 dark:bg-rose-800 text-rose-950 dark:text-white font-bold border border-rose-300 dark:border-rose-600 shadow-sm":"bg-emerald-200 dark:bg-emerald-800 text-emerald-950 dark:text-white font-bold border border-emerald-300 dark:border-emerald-600 shadow-sm":r===2?"bg-yellow-100 dark:bg-yellow-900/40 text-yellow-900 dark:text-yellow-100 font-semibold border border-yellow-200 dark:border-yellow-700/50":r===3?s==="ce"?"bg-rose-50/50 dark:bg-rose-900/10 text-rose-700 dark:text-rose-300/70":"bg-emerald-50/50 dark:bg-emerald-900/10 text-emerald-700 dark:text-emerald-300/70":"",cl=(e,r,s,a,n)=>{const l={},i=[];e.forEach(x=>{var f,E;const b=x.toString(),y=(((f=r==null?void 0:r.oc)==null?void 0:f[b])||((E=r==null?void 0:r.oc)==null?void 0:E[`${x}.000000`])||{})[n]||{};let k=0,N=0,_=!1;a==="volume"?(k=y.volume||0,N=k):a==="oi"?(k=y.OI||y.oi||0,N=k):a==="oichng"&&(N=y.oichng||0,_=N<0,k=N>0?N:0);const C=il(x,s,n),w=C<=2;i.push({strike:x,value:k,rawValue:N,isNegative:_,itmDepth:C,isValidFor100:w})});const c=i.filter(x=>x.isValidFor100&&x.value>0),d=c.length>0?Math.max(...c.map(x=>x.value)):0;if(d===0)return e.forEach(x=>{l[x]={pct:0,rank:0,color:""}}),l;const g=i.map(x=>({...x,pct:a==="oichng"&&x.isNegative?Math.abs(x.rawValue)/d*100:x.value/d*100})),u=[...g].filter(x=>x.value>0).sort((x,b)=>b.value-x.value),h={};let m=0,p=null;return u.forEach((x,b)=>{x.value>0&&(x.value!==p&&(m=b+1,p=x.value),h[x.strike]=m)}),g.forEach(x=>{const b=h[x.strike]||0,v=x.value>0&&!x.isNegative?ol(x.pct,b,n,x.itmDepth):"";l[x.strike]={pct:x.pct,rank:b,color:v}}),l},dl=(e,r,s)=>o.useMemo(()=>{if(!e||e.length===0||!(r!=null&&r.oc))return{};const a={};return e.forEach(n=>{a[n]={}}),ll.forEach(n=>{nl.forEach(l=>{const i=cl(e,r,s,l,n),c=`${n}_${l}`;Object.entries(i).forEach(([d,g])=>{a[d]&&(a[d][c]=g)})})}),a},[e,r,s]),Jt={ce_ltp:{id:"ce_ltp",label:"LTP",side:"ce",category:"price",defaultVisible:!0,width:"w-20"},ce_chng:{id:"ce_chng",label:"Chg",side:"ce",category:"price",defaultVisible:!1,width:"w-16"},ce_volume:{id:"ce_volume",label:"Volume",side:"ce",category:"volume",defaultVisible:!0,width:"w-20"},ce_oi:{id:"ce_oi",label:"OI",side:"ce",category:"oi",defaultVisible:!0,width:"w-24"},ce_oichng:{id:"ce_oichng",label:"OI Chg",side:"ce",category:"oi",defaultVisible:!0,width:"w-20"},ce_iv:{id:"ce_iv",label:"IV",side:"ce",category:"greeks",defaultVisible:!0,width:"w-16"},ce_delta:{id:"ce_delta",label:"Delta",side:"ce",category:"greeks",defaultVisible:!0,width:"w-16"},ce_gamma:{id:"ce_gamma",label:"Gamma",side:"ce",category:"greeks",defaultVisible:!1,width:"w-16"},ce_theta:{id:"ce_theta",label:"Theta",side:"ce",category:"greeks",defaultVisible:!1,width:"w-16"},ce_vega:{id:"ce_vega",label:"Vega",side:"ce",category:"greeks",defaultVisible:!1,width:"w-16"},ce_buildup:{id:"ce_buildup",label:"Buildup",side:"ce",category:"analysis",defaultVisible:!1,width:"w-16"},ce_bid:{id:"ce_bid",label:"Bid",side:"ce",category:"depth",defaultVisible:!1,width:"w-16"},ce_ask:{id:"ce_ask",label:"Ask",side:"ce",category:"depth",defaultVisible:!1,width:"w-16"},ce_pcr:{id:"ce_pcr",label:"PCR",side:"ce",category:"analysis",defaultVisible:!1,width:"w-16"},pe_ltp:{id:"pe_ltp",label:"LTP",side:"pe",category:"price",defaultVisible:!0,width:"w-20"},pe_chng:{id:"pe_chng",label:"Chg",side:"pe",category:"price",defaultVisible:!1,width:"w-16"},pe_volume:{id:"pe_volume",label:"Volume",side:"pe",category:"volume",defaultVisible:!0,width:"w-20"},pe_oi:{id:"pe_oi",label:"OI",side:"pe",category:"oi",defaultVisible:!0,width:"w-24"},pe_oichng:{id:"pe_oichng",label:"OI Chg",side:"pe",category:"oi",defaultVisible:!0,width:"w-20"},pe_iv:{id:"pe_iv",label:"IV",side:"pe",category:"greeks",defaultVisible:!0,width:"w-16"},pe_delta:{id:"pe_delta",label:"Delta",side:"pe",category:"greeks",defaultVisible:!0,width:"w-16"},pe_gamma:{id:"pe_gamma",label:"Gamma",side:"pe",category:"greeks",defaultVisible:!1,width:"w-16"},pe_theta:{id:"pe_theta",label:"Theta",side:"pe",category:"greeks",defaultVisible:!1,width:"w-16"},pe_vega:{id:"pe_vega",label:"Vega",side:"pe",category:"greeks",defaultVisible:!1,width:"w-16"},pe_buildup:{id:"pe_buildup",label:"Buildup",side:"pe",category:"analysis",defaultVisible:!1,width:"w-16"},pe_bid:{id:"pe_bid",label:"Bid",side:"pe",category:"depth",defaultVisible:!1,width:"w-16"},pe_ask:{id:"pe_ask",label:"Ask",side:"pe",category:"depth",defaultVisible:!1,width:"w-16"},pe_pcr:{id:"pe_pcr",label:"PCR",side:"pe",category:"analysis",defaultVisible:!1,width:"w-16"},strike_reversal:{id:"strike_reversal",label:"Reversal",side:"strike",category:"signals",defaultVisible:!1,width:"w-20"},strike_signals:{id:"strike_signals",label:"Signals",side:"strike",category:"signals",defaultVisible:!1,width:"w-24"}},ul={oi:{label:"Open Interest",color:"bg-blue-500"},volume:{label:"Volume",color:"bg-purple-500"},price:{label:"Price",color:"bg-green-500"},greeks:{label:"Greeks",color:"bg-orange-500"},depth:{label:"Market Depth",color:"bg-cyan-500"},analysis:{label:"Analysis",color:"bg-pink-500"},signals:{label:"Signals",color:"bg-yellow-500"}},Zt="option_chain_columns",$s=["ce_iv","ce_delta","ce_oichng","ce_oi","ce_volume","ce_ltp"],_s=["pe_ltp","pe_volume","pe_oi","pe_oichng","pe_delta","pe_iv"],ia=o.createContext(null);function gl({children:e}){const[r,s]=o.useState(()=>{try{const u=localStorage.getItem(Zt);if(u)return JSON.parse(u)}catch(u){console.warn("Failed to load column config:",u)}const g={};return Object.values(Jt).forEach(u=>{g[u.id]=u.defaultVisible}),{visibility:g,ceOrder:$s,peOrder:_s}}),a=o.useCallback(g=>{s(u=>{const h={...u,visibility:{...u.visibility,[g]:!u.visibility[g]}};return localStorage.setItem(Zt,JSON.stringify(h)),h})},[]),n=o.useCallback(g=>{s(u=>{const h={...u,visibility:{...u.visibility,...g}};return localStorage.setItem(Zt,JSON.stringify(h)),h})},[]),l=o.useCallback(()=>{const g={};Object.values(Jt).forEach(h=>{g[h.id]=h.defaultVisible});const u={visibility:g,ceOrder:$s,peOrder:_s};localStorage.setItem(Zt,JSON.stringify(u)),s(u)},[]),i=o.useCallback(g=>(g==="ce"?r.ceOrder:r.peOrder).filter(h=>r.visibility[h]).map(h=>Jt[h]).filter(Boolean),[r]),c=o.useCallback(g=>r.visibility[g]??!1,[r.visibility]),d=o.useMemo(()=>({columnConfig:r,toggleColumn:a,setColumnsVisibility:n,resetToDefaults:l,getVisibleColumns:i,isColumnVisible:c,allColumns:Jt,categories:ul}),[r,a,n,l,i,c]);return t.jsx(ia.Provider,{value:d,children:e})}function Qr(){const e=o.useContext(ia);if(!e)throw new Error("useColumnConfig must be used within ColumnConfigProvider");return e}const oa=o.memo(({onColumnClick:e})=>{const{isColumnVisible:r}=Qr(),{settings:s}=dr(),n=s.compactMode?"p-1.5":"p-2.5",l=`${n} text-center font-semibold text-sm uppercase text-gray-600 dark:text-gray-300 tracking-wide whitespace-nowrap border-b border-gray-200 dark:border-gray-700`,i=`${l} cursor-pointer hover:bg-blue-50 dark:hover:bg-blue-900/20 hover:text-blue-600 transition-colors`,c=`${n} text-center font-bold text-base tracking-wide sticky left-0 z-20 bg-gray-100 dark:bg-gray-800 border-x-2 border-gray-300 dark:border-gray-600 min-w-[100px]`,d=["ce_iv","ce_delta","ce_gamma","ce_theta","ce_vega","ce_oichng","ce_oi","ce_volume","ce_ltp","ce_chng","ce_buildup","ce_bid","ce_ask"],g=["pe_ltp","pe_chng","pe_bid","pe_ask","pe_volume","pe_oi","pe_oichng","pe_delta","pe_iv","pe_gamma","pe_theta","pe_vega","pe_buildup"],u=d.filter(m=>r(m)).length||1,h=g.filter(m=>r(m)).length||1;return t.jsxs("thead",{className:"bg-gray-50 dark:bg-gray-900 sticky top-0 z-20 shadow-sm",children:[t.jsxs("tr",{children:[t.jsxs("th",{colSpan:u,className:`${n} text-center font-bold text-base border-b border-rose-200 dark:border-rose-900/50 bg-white dark:bg-slate-900 group`,children:[t.jsx("span",{className:"text-rose-600 dark:text-rose-400",children:"CALLS"})," ",t.jsx("span",{className:"text-gray-400 text-xs font-normal ml-1",children:"(Resistance)"})]}),t.jsx("th",{className:`${n} bg-gray-50 dark:bg-slate-800 border-b border-gray-200 dark:border-gray-700`}),t.jsxs("th",{colSpan:h,className:`${n} text-center font-bold text-base border-b border-emerald-200 dark:border-emerald-900/50 bg-white dark:bg-slate-900 group`,children:[t.jsx("span",{className:"text-emerald-600 dark:text-emerald-400",children:"PUTS"})," ",t.jsx("span",{className:"text-gray-400 text-xs font-normal ml-1",children:"(Support)"})]})]}),t.jsxs("tr",{className:"bg-gray-100 dark:bg-gray-800/50",children:[r("ce_iv")&&t.jsx("th",{className:`${l} cursor-help text-blue-600 dark:text-blue-400`,title:"Hover for all Greeks",children:"IV â“˜"}),r("ce_delta")&&t.jsx("th",{className:l,children:"Î”"}),r("ce_gamma")&&t.jsx("th",{className:l,children:"Î“"}),r("ce_theta")&&t.jsx("th",{className:`${l} text-red-500`,children:"Î˜"}),r("ce_vega")&&t.jsx("th",{className:l,children:"Î½"}),r("ce_oichng")&&t.jsx("th",{className:i,onClick:()=>e==null?void 0:e("oi_chng"),title:"Click for OI Change Distribution",children:"OI Chg ðŸ“Š"}),r("ce_oi")&&t.jsx("th",{className:i,onClick:()=>e==null?void 0:e("oi"),title:"Click for OI Distribution",children:"OI ðŸ“Š"}),r("ce_volume")&&t.jsx("th",{className:i,onClick:()=>e==null?void 0:e("volume"),title:"Click for Volume Distribution",children:"Vol ðŸ“Š"}),r("ce_buildup")&&t.jsx("th",{className:l,children:"Buildup"}),r("ce_ltp")&&t.jsx("th",{className:`${l} font-bold`,children:"LTP / Chg"}),r("ce_chng")&&!r("ce_ltp")&&t.jsx("th",{className:l,children:"Chg"}),r("ce_bid")&&t.jsx("th",{className:l,children:"Bid"}),r("ce_ask")&&t.jsx("th",{className:l,children:"Ask"}),t.jsx("th",{className:c,children:t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("span",{children:"STRIKE"}),t.jsx("span",{className:"text-[9px] text-gray-500 font-normal",children:"PCR"})]})}),r("pe_bid")&&t.jsx("th",{className:`${l}`,children:"Bid"}),r("pe_ask")&&t.jsx("th",{className:`${l}`,children:"Ask"}),r("pe_ltp")&&t.jsx("th",{className:`${l} font-bold`,children:"LTP / Chg"}),r("pe_chng")&&!r("pe_ltp")&&t.jsx("th",{className:`${l}`,children:"Chg"}),r("pe_buildup")&&t.jsx("th",{className:`${l}`,children:"Buildup"}),r("pe_volume")&&t.jsx("th",{className:i,onClick:()=>e==null?void 0:e("volume"),title:"Click for Volume Distribution",children:"Vol ðŸ“Š"}),r("pe_oi")&&t.jsx("th",{className:i,onClick:()=>e==null?void 0:e("oi"),title:"Click for OI Distribution",children:"OI ðŸ“Š"}),r("pe_oichng")&&t.jsx("th",{className:i,onClick:()=>e==null?void 0:e("oi_chng"),title:"Click for OI Change Distribution",children:"OI Chg ðŸ“Š"}),r("pe_delta")&&t.jsx("th",{className:`${l}`,children:"Î”"}),r("pe_iv")&&t.jsx("th",{className:`${l} cursor-help text-blue-600 dark:text-blue-400`,title:"Hover for all Greeks",children:"IV â“˜"}),r("pe_gamma")&&t.jsx("th",{className:`${l}`,children:"Î“"}),r("pe_theta")&&t.jsx("th",{className:`${l} text-red-500`,children:"Î˜"}),r("pe_vega")&&t.jsx("th",{className:`${l}`,children:"Î½"})]})]})});oa.displayName="TableHeader";const Es={LB:{code:"LB",name:"LONG BUILDUP",color:"success",description:"Bullish - Price up, OI up"},SB:{code:"SB",name:"SHORT BUILDUP",color:"danger",description:"Bearish - Price down, OI up"},SC:{code:"SC",name:"SHORT COVERING",color:"success",description:"Bullish - Price up, OI down"},LC:{code:"LC",name:"LONG UNWINDING",color:"danger",description:"Bearish - Price down, OI down"},NT:{code:"NT",name:"NEUTRAL",color:"default",description:"No significant change"}},Ue=e=>{if(e==null)return"â€”";if(e===0)return"0";const r=Math.abs(e),s=e<0?"-":"";return r>=1e12?s+(r/1e12).toFixed(2)+"T":r>=1e9?s+(r/1e9).toFixed(2)+"B":r>=1e6?s+(r/1e6).toFixed(2)+"M":r>=1e3?s+(r/1e3).toFixed(1)+"K":s+r.toFixed(0)},Rr=o.memo(({optgeeks:e,isVisible:r,position:s})=>{if(!r||!e)return null;const a=[{key:"delta",label:"Î” Delta",color:"text-blue-500"},{key:"gamma",label:"Î“ Gamma",color:"text-green-500"},{key:"theta",label:"Î˜ Theta",color:"text-red-500"},{key:"vega",label:"Î½ Vega",color:"text-purple-500"},{key:"rho",label:"Ï Rho",color:"text-cyan-500"},{key:"vanna",label:"Vanna",color:"text-orange-400"},{key:"vomma",label:"Vomma",color:"text-pink-500"},{key:"charm",label:"Charm",color:"text-yellow-500"},{key:"speed",label:"Speed",color:"text-indigo-500"},{key:"zomma",label:"Zomma",color:"text-lime-500"},{key:"color",label:"Color",color:"text-amber-500"},{key:"ultima",label:"Ultima",color:"text-rose-500"}];return t.jsxs("div",{className:`
        absolute z-50 bg-gray-900/95 dark:bg-gray-800/95 text-white
        rounded-lg shadow-2xl p-3 min-w-[220px]
        border border-gray-700
        ${s==="left"?"right-full mr-2":"left-full ml-2"}
      `,style:{top:"50%",transform:"translateY(-50%)"},children:[t.jsx("div",{className:"text-xs font-semibold text-gray-400 mb-2 uppercase tracking-wider",children:"Option Greeks"}),t.jsx("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1.5",children:a.map(({key:n,label:l,color:i})=>{var c;return t.jsxs("div",{className:"flex justify-between items-center text-xs",children:[t.jsx("span",{className:`${i} font-medium`,children:l}),t.jsx("span",{className:"text-gray-300 font-mono",children:((c=e[n])==null?void 0:c.toFixed(4))??"â€”"})]},n)})})]})});Rr.displayName="GreeksTooltip";const ca=o.memo(({data:e,strike:r,spotPrice:s,onClose:a})=>{var N,_,C,w,f,E,P,L,O;if(!e)return null;const n=e.ce||{},l=e.pe||{},i=n.OI||n.oi||0,c=l.OI||l.oi||0,d=n.oichng||0,g=l.oichng||0,u=i>0?c/i:0,h=d!==0?g/d:0,m=e.reversal||0,p=e.wkly_reversal||0,x=e.fut_reversal||0,b=r>(s||0),v=e.pcr||u,y=e.trading_signals||{};e.price_range,e.market_regimes;const k=I=>I>1.5?"text-green-600 bg-green-50 dark:bg-green-900/30":I>1?"text-green-500 bg-green-50/50 dark:bg-green-900/20":I>.7?"text-amber-600 bg-amber-50 dark:bg-amber-900/30":"text-red-600 bg-red-50 dark:bg-red-900/30";return t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:a,children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-lg w-full p-6 max-h-[90vh] overflow-y-auto",onClick:I=>I.stopPropagation(),children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{children:[t.jsxs("h3",{className:"text-2xl font-bold",children:["Strike ",r]}),t.jsx("span",{className:`text-sm ${b?"text-red-500":"text-green-500"}`,children:b?"â†‘ Above Spot (Resistance Zone)":"â†“ Below Spot (Support Zone)"})]}),t.jsx("button",{onClick:a,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:t.jsx(wt,{className:"w-6 h-6"})})]}),t.jsxs("div",{className:"mb-5 p-4 rounded-xl bg-gradient-to-r from-purple-50 to-blue-50 dark:from-purple-900/20 dark:to-blue-900/20 border border-purple-200 dark:border-purple-700/50",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(qe,{className:"w-5 h-5 text-purple-600"}),t.jsx("span",{className:"font-semibold text-purple-700 dark:text-purple-300",children:b?"Resistance Level":"Support Level"})]}),m&&t.jsx("button",{onClick:()=>navigator.clipboard.writeText(m.toFixed(2)),className:"px-2 py-1 text-xs bg-purple-100 dark:bg-purple-800 text-purple-700 dark:text-purple-200 rounded hover:bg-purple-200 dark:hover:bg-purple-700",title:"Copy to clipboard",children:"ðŸ“‹ Copy"})]}),t.jsx("div",{className:"text-3xl font-bold text-purple-800 dark:text-purple-200 mb-2 cursor-pointer select-all",onClick:()=>m&&navigator.clipboard.writeText(m.toFixed(2)),title:"Click to copy",children:m?m.toFixed(2):"N/A"}),t.jsxs("div",{className:"grid grid-cols-3 gap-3 text-sm",children:[t.jsxs("div",{className:"cursor-pointer hover:bg-purple-100 dark:hover:bg-purple-800/50 p-1 rounded",onClick:()=>p&&navigator.clipboard.writeText(p.toFixed(2)),children:[t.jsx("span",{className:"text-gray-500 text-xs",children:"Weekly:"}),t.jsx("span",{className:"ml-1 font-medium select-all",children:p?p.toFixed(2):"â€”"})]}),t.jsxs("div",{className:"cursor-pointer hover:bg-purple-100 dark:hover:bg-purple-800/50 p-1 rounded",onClick:()=>x&&navigator.clipboard.writeText(x.toFixed(2)),children:[t.jsx("span",{className:"text-gray-500 text-xs",children:"Futures:"}),t.jsx("span",{className:"ml-1 font-medium select-all",children:x?x.toFixed(2):"â€”"})]}),t.jsxs("div",{className:"cursor-pointer hover:bg-purple-100 dark:hover:bg-purple-800/50 p-1 rounded",onClick:()=>v&&navigator.clipboard.writeText(v.toFixed(2)),children:[t.jsx("span",{className:"text-gray-500 text-xs",children:"PCR:"}),t.jsx("span",{className:"ml-1 font-medium select-all",children:v?v.toFixed(2):"â€”"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-5",children:[t.jsxs("div",{className:`p-4 rounded-xl ${k(u)}`,children:[t.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"OI PCR (PE/CE)"}),t.jsx("div",{className:"text-2xl font-bold",children:u.toFixed(2)}),t.jsx("div",{className:"text-xs mt-1",children:u>1?"ðŸŸ¢ Bullish":"ðŸ”´ Bearish"})]}),t.jsxs("div",{className:`p-4 rounded-xl ${k(Math.abs(h))}`,children:[t.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"OI Chng PCR"}),t.jsx("div",{className:"text-2xl font-bold",children:h.toFixed(2)}),t.jsx("div",{className:"text-xs mt-1",children:h>1?"ðŸ“ˆ Put Activity":"ðŸ“‰ Call Activity"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-5",children:[t.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900/20 rounded-xl",children:[t.jsx("div",{className:"text-xs text-green-600 mb-1",children:"Call OI"}),t.jsx("div",{className:"text-xl font-bold text-green-700",children:Ue(i)}),t.jsxs("div",{className:`text-sm ${d>=0?"text-green-600":"text-red-600"}`,children:[d>=0?"+":"",Ue(d)]})]}),t.jsxs("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 rounded-xl",children:[t.jsx("div",{className:"text-xs text-red-600 mb-1",children:"Put OI"}),t.jsx("div",{className:"text-xl font-bold text-red-700",children:Ue(c)}),t.jsxs("div",{className:`text-sm ${g>=0?"text-red-600":"text-green-600"}`,children:[g>=0?"+":"",Ue(g)]})]})]}),t.jsxs("div",{className:"space-y-2 text-sm border-t pt-4 border-gray-200 dark:border-gray-700",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-500",children:"CE LTP"}),t.jsxs("span",{className:"font-medium",children:["â‚¹",((N=n.ltp)==null?void 0:N.toFixed(2))||"â€”",t.jsxs("span",{className:`ml-1 text-xs ${n.p_chng>=0?"text-green-600":"text-red-600"}`,children:["(",n.p_chng>=0?"+":"",((_=n.p_chng)==null?void 0:_.toFixed(2))||0,")"]})]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-500",children:"PE LTP"}),t.jsxs("span",{className:"font-medium",children:["â‚¹",((C=l.ltp)==null?void 0:C.toFixed(2))||"â€”",t.jsxs("span",{className:`ml-1 text-xs ${l.p_chng>=0?"text-green-600":"text-red-600"}`,children:["(",l.p_chng>=0?"+":"",((w=l.p_chng)==null?void 0:w.toFixed(2))||0,")"]})]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-500",children:"CE IV / PE IV"}),t.jsxs("span",{className:"font-medium",children:[((f=n.iv)==null?void 0:f.toFixed(1))||"â€”","% / ",((E=l.iv)==null?void 0:E.toFixed(1))||"â€”","%"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-500",children:"Straddle"}),t.jsxs("span",{className:"font-bold text-purple-600",children:["â‚¹",((n.ltp||0)+(l.ltp||0)).toFixed(2)]})]})]}),y.entry&&t.jsxs("div",{className:"mt-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-xl",children:[t.jsx("div",{className:"text-xs text-blue-600 font-medium mb-2",children:"Trading Signals"}),t.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Entry:"})," ",t.jsx("span",{className:"font-bold",children:(P=y.entry)==null?void 0:P.toFixed(2)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"SL:"})," ",t.jsx("span",{className:"font-bold text-red-600",children:(L=y.stop_loss)==null?void 0:L.toFixed(2)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"TP:"})," ",t.jsx("span",{className:"font-bold text-green-600",children:(O=y.take_profit)==null?void 0:O.toFixed(2)})]})]})]})]})})});ca.displayName="StrikeDetailPopup";const xe=o.memo(({children:e,onClick:r,className:s=""})=>t.jsx("div",{onClick:r,className:`
      cursor-pointer transition-all duration-150
      hover:bg-blue-100 dark:hover:bg-blue-900/40
      hover:ring-1 hover:ring-blue-300 dark:hover:ring-blue-700
      rounded px-1 -mx-1
      ${s}
    `,children:e}));xe.displayName="ClickableCell";const Vr=o.memo(({type:e})=>{const r=Es[e]||Es.NT,s={success:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300",danger:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300",default:"bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400"};return t.jsx("span",{className:`px-1.5 py-0.5 text-[11px] rounded font-medium ${s[r.color]}`,title:`${r.name}: ${r.description||""}`,children:e})});Vr.displayName="BuildupIndicator";const da=o.memo(({oiPcr:e,oiChngPcr:r,volPcr:s,compact:a=!1})=>{const n=c=>!c||c===0?"text-gray-400 bg-gray-100 dark:bg-gray-700":c>1.2?"text-green-700 bg-green-100 dark:bg-green-900/50 dark:text-green-300":c>.8?"text-amber-700 bg-amber-100 dark:bg-amber-900/50 dark:text-amber-300":"text-red-700 bg-red-100 dark:bg-red-900/50 dark:text-red-300",l=a?"text-[8px]":"text-[10px]",i=a?"px-0.5":"";return t.jsxs("div",{className:`flex items-center gap-0.5 ${l}`,children:[t.jsx("span",{className:`rounded font-medium ${i} bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400`,title:"OI PCR (PE/CE)",children:e>0?e.toFixed(1):"â€”"}),t.jsxs("span",{className:`rounded font-medium ${i} ${n(Math.abs(r))}`,title:"OI Change PCR",children:["Î”",r!==0?Math.abs(r).toFixed(1):"â€”"]}),t.jsxs("span",{className:`rounded font-medium ${i} bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400`,title:"Volume PCR (PE/CE)",children:["V",s>0?s.toFixed(1):"â€”"]})]})});da.displayName="PCRDisplay";const es=o.memo(({data:e,strike:r,atmStrike:s,spotPrice:a,onCellClick:n,onStrikeSelect:l,onStrikeClick:i,highlightData:c})=>{var Q,G,me,be,Le,pe,Me,Oe,Ct,St,Wt,Ut,zt,Kt,st,$t,Ge,ht,_t,Et,F,T;const{isColumnVisible:d}=Qr(),{settings:g}=dr(),u=B=>{var Y;return((Y=c==null?void 0:c[B])==null?void 0:Y.color)||""},h=B=>{var Y;return((Y=c==null?void 0:c[B])==null?void 0:Y.pct)||0},m=o.useMemo(()=>e.ce||{},[e.ce]),p=o.useMemo(()=>e.pe||{},[e.pe]),[x,b]=o.useState(null),[v,y]=o.useState(!1),k=Math.abs(r-s)<.01,N=m.mness==="I",_=p.mness==="I",C=g.highlightITM,w=g.compactMode,f=m.OI||m.oi||0,E=p.OI||p.oi||0,P=m.oichng||0,L=p.oichng||0,O=m.volume||0,I=p.volume||0,q=f>0?E/f:0,se=P!==0?L/P:0,te=O>0?I/O:0,S=o.useCallback((B,Y,ce)=>{n&&n({strike:r,side:B,field:Y,value:ce,symbol:B==="ce"?m.sym:p.sym,sid:B==="ce"?m.sid:p.sid,fullData:e})},[r,m.sym,m.sid,p.sym,p.sid,n,e]),D=o.useCallback(()=>{i?i({strike:r,ce:m,pe:p,...e}):y(!0)},[i,r,m,p,e]),H=w?"py-1 px-1.5":"p-2",W="text-sm",M=B=>C&&B?"bg-yellow-50/50 dark:bg-yellow-900/10":"",$=(B,Y="")=>{const ce=Y||M(B);return`${H} ${W} text-center border-r border-gray-100 dark:border-gray-800 ${ce}`};return t.jsxs(t.Fragment,{children:[t.jsxs("tr",{className:`
          border-b border-gray-100 dark:border-gray-800
          hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors
          ${k?"bg-gradient-to-r from-yellow-50 via-amber-50 to-yellow-50 dark:from-yellow-900/30 dark:via-amber-900/20 dark:to-yellow-900/30 ring-2 ring-yellow-400 dark:ring-yellow-500 shadow-[0_0_15px_rgba(234,179,8,0.3)] relative z-10":""}
        `,children:[d("ce_iv")&&t.jsxs("td",{className:`${$(N)} text-blue-600 dark:text-blue-400 relative`,onMouseEnter:()=>b("ce"),onMouseLeave:()=>b(null),children:[t.jsx(xe,{onClick:()=>S("ce","iv",m.iv),children:t.jsx("span",{className:"cursor-help underline decoration-dotted decoration-blue-400/50 font-medium",children:((Q=m.iv)==null?void 0:Q.toFixed(1))||"â€”"})}),t.jsx(Rr,{optgeeks:m.optgeeks,isVisible:x==="ce",position:"right"})]}),d("ce_delta")&&t.jsx("td",{className:$(N),children:t.jsx(xe,{onClick:()=>{var B;return S("ce","delta",(B=m.optgeeks)==null?void 0:B.delta)},children:((me=(G=m.optgeeks)==null?void 0:G.delta)==null?void 0:me.toFixed(3))||"â€”"})}),d("ce_gamma")&&t.jsx("td",{className:$(N),children:t.jsx(xe,{onClick:()=>{var B;return S("ce","gamma",(B=m.optgeeks)==null?void 0:B.gamma)},children:((Le=(be=m.optgeeks)==null?void 0:be.gamma)==null?void 0:Le.toFixed(5))||"â€”"})}),d("ce_theta")&&t.jsx("td",{className:`${$(N)} text-red-500`,children:t.jsx(xe,{onClick:()=>{var B;return S("ce","theta",(B=m.optgeeks)==null?void 0:B.theta)},children:((Me=(pe=m.optgeeks)==null?void 0:pe.theta)==null?void 0:Me.toFixed(2))||"â€”"})}),d("ce_vega")&&t.jsx("td",{className:$(N),children:t.jsx(xe,{onClick:()=>{var B;return S("ce","vega",(B=m.optgeeks)==null?void 0:B.vega)},children:((Ct=(Oe=m.optgeeks)==null?void 0:Oe.vega)==null?void 0:Ct.toFixed(3))||"â€”"})}),d("ce_oichng")&&t.jsx("td",{className:$(N,u("ce_oichng")),children:t.jsx(xe,{onClick:()=>S("ce","oichng",m.oichng),children:t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsxs("span",{className:`font-medium ${m.oichng>0?"text-green-600":m.oichng<0?"text-red-600":""}`,children:[m.oichng>0?"+":"",Ue(m.oichng)]}),h("ce_oichng")>0&&t.jsxs("span",{className:"text-xs text-gray-500",children:[h("ce_oichng").toFixed(0),"%"]})]})})}),d("ce_oi")&&t.jsx("td",{className:$(N,u("ce_oi")),children:t.jsx(xe,{onClick:()=>S("ce","OI",m.OI),children:t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("span",{className:"font-semibold text-gray-700 dark:text-gray-300",children:Ue(m.OI)}),h("ce_oi")>0&&t.jsxs("span",{className:"text-xs text-gray-500",children:[h("ce_oi").toFixed(0),"%"]})]})})}),d("ce_volume")&&t.jsx("td",{className:`${$(N,u("ce_volume"))} text-gray-600 dark:text-gray-400`,children:t.jsx(xe,{onClick:()=>S("ce","volume",m.volume),children:t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("span",{children:Ue(m.volume)}),h("ce_volume")>0&&t.jsxs("span",{className:"text-xs text-gray-500",children:[h("ce_volume").toFixed(0),"%"]})]})})}),d("ce_buildup")&&t.jsx("td",{className:$(N),children:t.jsx(xe,{onClick:()=>S("ce","buildup",m.btyp),children:t.jsx(Vr,{type:m.btyp})})}),d("ce_ltp")&&t.jsx("td",{className:`${$(N)} font-semibold`,children:t.jsx(xe,{onClick:()=>S("ce","ltp",m.ltp),children:t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("span",{className:"text-gray-900 dark:text-white",children:((St=m.ltp)==null?void 0:St.toFixed(2))||"â€”"}),t.jsxs("span",{className:`text-xs ${m.p_chng>0?"text-green-600":m.p_chng<0?"text-red-600":"text-gray-400"}`,children:[m.p_chng>0?"+":"",((Wt=m.p_chng)==null?void 0:Wt.toFixed(1))||"0"]})]})})}),d("ce_bid")&&t.jsx("td",{className:`${$(N)} text-xs text-gray-400`,children:t.jsx(xe,{onClick:()=>S("ce","bid",m.bid),children:m.bid||"â€”"})}),d("ce_ask")&&t.jsx("td",{className:`${$(N)} text-xs text-gray-400`,children:t.jsx(xe,{onClick:()=>S("ce","ask",m.ask),children:m.ask||"â€”"})}),t.jsx("td",{onClick:D,className:`
            ${w?"py-0.5 px-1":H} text-center font-bold sticky left-0 z-10 cursor-pointer
            ${k?"text-blue-600 dark:text-blue-400":"text-gray-800 dark:text-gray-200"}
            ${w?"text-sm":"text-lg"}
            bg-gray-100 dark:bg-gray-800 border-x-2 border-gray-300 dark:border-gray-600
            hover:bg-blue-100 dark:hover:bg-blue-900/50 transition-colors
            min-w-[60px]
          `,children:t.jsxs("div",{className:`flex flex-col items-center ${w?"gap-0 leading-tight":"gap-0.5"}`,children:[t.jsx("span",{className:k?"font-bold":"",children:r}),!w&&k&&t.jsx("span",{className:"text-[10px] text-blue-500 font-medium px-1.5 py-0.5 bg-blue-100 dark:bg-blue-900/50 rounded",children:"ATM"}),t.jsx(da,{oiPcr:q,oiChngPcr:se,volPcr:te,compact:w})]})}),d("pe_bid")&&t.jsx("td",{className:`${$(_)} text-xs text-gray-400`,children:t.jsx(xe,{onClick:()=>S("pe","bid",p.bid),children:p.bid||"â€”"})}),d("pe_ask")&&t.jsx("td",{className:`${$(_)} text-xs text-gray-400`,children:t.jsx(xe,{onClick:()=>S("pe","ask",p.ask),children:p.ask||"â€”"})}),d("pe_ltp")&&t.jsx("td",{className:`${$(_)} font-semibold`,children:t.jsx(xe,{onClick:()=>S("pe","ltp",p.ltp),children:t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("span",{className:"text-gray-900 dark:text-white",children:((Ut=p.ltp)==null?void 0:Ut.toFixed(2))||"â€”"}),t.jsxs("span",{className:`text-xs ${p.p_chng>0?"text-green-600":p.p_chng<0?"text-red-600":"text-gray-400"}`,children:[p.p_chng>0?"+":"",((zt=p.p_chng)==null?void 0:zt.toFixed(1))||"0"]})]})})}),d("pe_buildup")&&t.jsx("td",{className:$(_),children:t.jsx(xe,{onClick:()=>S("pe","buildup",p.btyp),children:t.jsx(Vr,{type:p.btyp})})}),d("pe_volume")&&t.jsx("td",{className:`${$(_,u("pe_volume"))} text-gray-600 dark:text-gray-400`,children:t.jsx(xe,{onClick:()=>S("pe","volume",p.volume),children:t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("span",{children:Ue(p.volume)}),h("pe_volume")>0&&t.jsxs("span",{className:"text-xs text-gray-500",children:[h("pe_volume").toFixed(0),"%"]})]})})}),d("pe_oi")&&t.jsx("td",{className:$(_,u("pe_oi")),children:t.jsx(xe,{onClick:()=>S("pe","OI",p.OI),children:t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("span",{className:"font-semibold text-gray-700 dark:text-gray-300",children:Ue(p.OI)}),h("pe_oi")>0&&t.jsxs("span",{className:"text-xs text-gray-500",children:[h("pe_oi").toFixed(0),"%"]})]})})}),d("pe_oichng")&&t.jsx("td",{className:$(_,u("pe_oichng")),children:t.jsx(xe,{onClick:()=>S("pe","oichng",p.oichng),children:t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsxs("span",{className:`font-medium ${p.oichng>0?"text-green-600":p.oichng<0?"text-red-600":""}`,children:[p.oichng>0?"+":"",Ue(p.oichng)]}),h("pe_oichng")>0&&t.jsxs("span",{className:"text-xs text-gray-500",children:[h("pe_oichng").toFixed(0),"%"]})]})})}),d("pe_delta")&&t.jsx("td",{className:$(_),children:t.jsx(xe,{onClick:()=>{var B;return S("pe","delta",(B=p.optgeeks)==null?void 0:B.delta)},children:((st=(Kt=p.optgeeks)==null?void 0:Kt.delta)==null?void 0:st.toFixed(3))||"â€”"})}),d("pe_iv")&&t.jsxs("td",{className:`${$(_)} text-blue-600 dark:text-blue-400 relative`,onMouseEnter:()=>b("pe"),onMouseLeave:()=>b(null),children:[t.jsx(xe,{onClick:()=>S("pe","iv",p.iv),children:t.jsx("span",{className:"cursor-help underline decoration-dotted decoration-blue-400/50 font-medium",children:(($t=p.iv)==null?void 0:$t.toFixed(1))||"â€”"})}),t.jsx(Rr,{optgeeks:p.optgeeks,isVisible:x==="pe",position:"left"})]}),d("pe_gamma")&&t.jsx("td",{className:$(_),children:t.jsx(xe,{onClick:()=>{var B;return S("pe","gamma",(B=p.optgeeks)==null?void 0:B.gamma)},children:((ht=(Ge=p.optgeeks)==null?void 0:Ge.gamma)==null?void 0:ht.toFixed(5))||"â€”"})}),d("pe_theta")&&t.jsx("td",{className:`${$(_)} text-red-500`,children:t.jsx(xe,{onClick:()=>{var B;return S("pe","theta",(B=p.optgeeks)==null?void 0:B.theta)},children:((Et=(_t=p.optgeeks)==null?void 0:_t.theta)==null?void 0:Et.toFixed(2))||"â€”"})}),d("pe_vega")&&t.jsx("td",{className:$(_),children:t.jsx(xe,{onClick:()=>{var B;return S("pe","vega",(B=p.optgeeks)==null?void 0:B.vega)},children:((T=(F=p.optgeeks)==null?void 0:F.vega)==null?void 0:T.toFixed(3))||"â€”"})})]}),v&&t.jsx(ca,{data:e,strike:r,spotPrice:a,onClose:()=>y(!1)})]})});es.displayName="StrikeRow";es.propTypes={data:ie.object.isRequired,strike:ie.number.isRequired,atmStrike:ie.number,spotPrice:ie.number,onCellClick:ie.func,onStrikeSelect:ie.func};const Pt=o.memo(({label:e,value:r,change:s,highlight:a=!1})=>{var i;const n=s>0,l=s===0||s===void 0;return t.jsxs("div",{className:`
            flex items-center gap-2 px-3 py-1.5 rounded-full border shadow-sm transition-all duration-200
            ${a?"bg-blue-50/50 dark:bg-blue-900/10 border-blue-200 dark:border-blue-700/50":"bg-white/50 dark:bg-gray-800/50 border-gray-200 dark:border-gray-700"}
            backdrop-blur-md
        `,children:[t.jsx("span",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide",children:e}),t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx("span",{className:`text-sm font-bold tracking-tight ${a?"text-blue-700 dark:text-blue-300":"text-gray-900 dark:text-gray-100"}`,children:((i=r==null?void 0:r.toLocaleString)==null?void 0:i.call(r))||"â€”"}),!l&&t.jsxs("span",{className:`
                        flex items-center text-xs font-bold px-1.5 py-0.5 rounded-full
                        ${n?"bg-emerald-100 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-400":"bg-rose-100 dark:bg-rose-900/30 text-rose-600 dark:text-rose-400"}
                    `,children:[n?t.jsx(Mr,{className:"w-3 h-3 mr-0.5"}):t.jsx(Or,{className:"w-3 h-3 mr-0.5"}),Math.abs(s).toFixed(2),"%"]})]})]})});Pt.displayName="Metric";const ur=o.memo(({spotData:e,futuresData:r,pcr:s,maxPain:a})=>t.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto pb-1 no-scrollbar",children:[t.jsx(Pt,{label:"Spot",value:e==null?void 0:e.ltp,change:e==null?void 0:e.change_percent,highlight:!0}),r&&t.jsx(Pt,{label:"Fut",value:r.ltp,change:r.change_percent}),t.jsx(Pt,{label:"PCR",value:s==null?void 0:s.toFixed(2)}),a&&t.jsx(Pt,{label:"Max Pain",value:a})]}));ur.displayName="SpotBar";ur.propTypes={spotData:ie.object,futuresData:ie.object,pcr:ie.number,maxPain:ie.number};const Fs=e=>e==null?"â€”":e.toLocaleString("en-IN",{maximumFractionDigits:2}),ua=o.memo(({spotData:e,futuresData:r,strikes:s,rowHeight:a=44,headerHeight:n=32})=>{const l=e==null?void 0:e.ltp,i=e==null?void 0:e.change,c=e==null?void 0:e.change_percent,d=r==null?void 0:r.ltp,g=r==null?void 0:r.change,u=d&&l?d-l:null,h=u>0,m=o.useMemo(()=>{if(!l||!s||s.length<2)return null;for(let x=0;x<s.length-1;x++){const b=s[x],v=s[x+1],y=Math.min(b,v),k=Math.max(b,v);if(l>y&&l<k)return x}return null},[l,s]);if(!l||m===null)return null;const p=n+(m+1)*a;return t.jsx("div",{className:"absolute left-0 right-0 z-20 pointer-events-none",style:{top:`${p}px`,transform:"translateY(-50%)"},children:t.jsx("div",{className:"flex items-center justify-center",children:t.jsxs("div",{className:"flex items-center gap-2 bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600 px-3 py-0.5 rounded-full shadow-lg border border-white/30 pointer-events-auto",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"text-[9px] font-medium text-white/70",children:"SPOT"}),t.jsx("span",{className:"text-xs font-bold text-white",children:Fs(l)}),i!==void 0&&t.jsxs("span",{className:`flex items-center text-[10px] font-semibold ${i>=0?"text-green-300":"text-red-300"}`,children:[i>=0?t.jsx(Mr,{className:"w-2.5 h-2.5"}):t.jsx(Or,{className:"w-2.5 h-2.5"}),i>=0?"+":"",i==null?void 0:i.toFixed(1),"(",c==null?void 0:c.toFixed(1),"%)"]})]}),t.jsx("div",{className:"w-px h-3 bg-white/40"}),d&&t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"text-[9px] font-medium text-white/70",children:"FUT"}),t.jsx("span",{className:"text-xs font-bold text-white",children:Fs(d)}),g!==void 0&&t.jsxs("span",{className:`flex items-center text-[10px] font-semibold ${g>=0?"text-green-300":"text-red-300"}`,children:[g>=0?t.jsx(Mr,{className:"w-2.5 h-2.5"}):t.jsx(Or,{className:"w-2.5 h-2.5"}),g>=0?"+":"",g==null?void 0:g.toFixed(1)]})]}),u!==null&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"w-px h-3 bg-white/40"}),t.jsxs("span",{className:`text-[9px] font-bold ${h?"text-amber-300":"text-cyan-300"}`,children:[h?"+":"",u.toFixed(0)]})]})]})})})});ua.displayName="SpotIndicatorRow";const ml=({symbols:e,currentSymbol:r,onSelect:s,theme:a})=>{const[n,l]=o.useState(!1),[i,c]=o.useState(""),[d,g]=o.useState({top:0,left:0}),u=o.useRef(null),h=o.useRef(null),m=o.useRef(null),p=["NIFTY","BANKNIFTY","FINNIFTY","MIDCPNIFTY","SENSEX","BANKEX","NIFTYNXT50"],x=e.filter(C=>C.symbol.toLowerCase().includes(i.toLowerCase())||(C.name||"").toLowerCase().includes(i.toLowerCase())),b=x.filter(C=>p.includes(C.symbol)),v=x.filter(C=>!p.includes(C.symbol)),y=()=>{if(h.current){const C=h.current.getBoundingClientRect();g({top:C.bottom+8,left:C.left})}l(!0)};o.useEffect(()=>{n&&m.current&&m.current.focus()},[n]);const k=C=>{s(C.symbol),l(!1),c("")},N=a==="dark",_=p.includes(r);return t.jsxs("div",{ref:u,className:"relative",children:[t.jsxs("button",{ref:h,onClick:()=>n?l(!1):y(),className:`
                    flex items-center gap-2 px-4 py-2 rounded-xl border shadow-md
                    font-bold text-sm transition-all duration-200 min-w-[140px]
                    ${N?"bg-gradient-to-r from-slate-800 to-slate-900 border-slate-600 text-white hover:border-slate-500":"bg-gradient-to-r from-white to-gray-50 border-gray-200 text-gray-900 hover:border-gray-300"}
                    ${n?"ring-2 ring-emerald-500/50 shadow-lg":""}
                `,children:[t.jsx("span",{className:"text-lg",children:_?"ðŸ“ˆ":"ðŸ¢"}),t.jsx("span",{className:"tracking-wide",children:r||"Select"}),t.jsx("svg",{className:`w-4 h-4 ml-auto transition-transform ${n?"rotate-180":""} ${N?"text-gray-400":"text-gray-500"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),n&&Bt.createPortal(t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"fixed inset-0 z-[2147483646]",onClick:()=>l(!1)}),t.jsxs("div",{className:`fixed w-80 max-h-[70vh] rounded-xl border shadow-2xl z-[2147483647] overflow-hidden ${N?"bg-slate-900 border-slate-700":"bg-white border-gray-200"}`,style:{top:d.top,left:d.left},children:[t.jsx("div",{className:`p-3 border-b ${N?"border-slate-700":"border-gray-100"}`,children:t.jsxs("div",{className:"relative",children:[t.jsx("svg",{className:`absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 ${N?"text-gray-500":"text-gray-400"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),t.jsx("input",{ref:m,type:"text",placeholder:"Search symbols...",value:i,onChange:C=>c(C.target.value),className:`w-full pl-10 pr-4 py-2.5 rounded-lg text-sm focus:outline-none focus:ring-2 ${N?"bg-slate-800 text-white placeholder-gray-500 focus:ring-emerald-500/50":"bg-gray-100 text-gray-900 placeholder-gray-400 focus:ring-emerald-400/50"}`})]})}),t.jsxs("div",{className:"overflow-y-auto max-h-80 p-2",children:[b.length>0&&t.jsxs("div",{className:"mb-3",children:[t.jsx("div",{className:`px-3 py-1.5 text-xs font-bold uppercase tracking-wider ${N?"text-blue-400":"text-blue-600"}`,children:"ðŸ“Š Indices"}),b.map(C=>t.jsxs("button",{onClick:()=>k(C),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-left transition-all ${r===C.symbol?N?"bg-emerald-600/20 text-emerald-400 font-bold":"bg-emerald-50 text-emerald-700 font-bold":N?"hover:bg-slate-700/50 text-gray-200":"hover:bg-gray-100 text-gray-800"}`,children:[t.jsx("span",{className:"text-lg",children:"ðŸ“ˆ"}),t.jsx("span",{className:"font-semibold",children:C.symbol}),r===C.symbol&&t.jsx("svg",{className:"w-4 h-4 ml-auto text-emerald-500",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},C.symbol))]}),v.length>0&&t.jsxs("div",{children:[t.jsx("div",{className:`px-3 py-1.5 text-xs font-bold uppercase tracking-wider ${N?"text-emerald-400":"text-emerald-600"}`,children:"ðŸ¢ Equities"}),v.map(C=>t.jsxs("button",{onClick:()=>k(C),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-left transition-all ${r===C.symbol?N?"bg-emerald-600/20 text-emerald-400 font-bold":"bg-emerald-50 text-emerald-700 font-bold":N?"hover:bg-slate-700/50 text-gray-200":"hover:bg-gray-100 text-gray-800"}`,children:[t.jsx("span",{className:"text-lg",children:"ðŸ¢"}),t.jsx("span",{className:"font-semibold",children:C.symbol}),r===C.symbol&&t.jsx("svg",{className:"w-4 h-4 ml-auto text-emerald-500",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},C.symbol))]}),x.length===0&&t.jsx("div",{className:`text-center py-8 text-sm ${N?"text-gray-500":"text-gray-400"}`,children:"No symbols found"})]})]})]}),document.getElementById("dropdown-root")||document.body)]})},ts=o.memo(({showChart:e,onToggleChart:r})=>{const s=Jr(),a=le(_n),n=le(or),l=le(Js),i=le(m=>m.theme.theme),c=le(m=>m.chart.symbols),d=a||"NIFTY";o.useEffect(()=>{c.length===0&&(async()=>{try{const x=await(await fetch("http://localhost:8000/api/v1/charts/symbols")).json();x.success&&x.data&&s(Lr(x.data))}catch(p){console.error("Failed to fetch symbols:",p)}})()},[c.length,s]);const g=m=>{s(En({newSid:m}))},u=m=>{s(Fn(Number(m.target.value)))},h=m=>new Date(Number(m)*1e3).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"2-digit"});return t.jsxs("div",{className:"flex items-center gap-3 p-1",children:[t.jsx(ml,{symbols:c.length>0?c:[{symbol:"NIFTY"},{symbol:"BANKNIFTY"},{symbol:"FINNIFTY"}],currentSymbol:d,onSelect:g,theme:i}),!e&&t.jsxs("div",{className:"relative group",children:[t.jsx("select",{value:n||"",onChange:u,className:`
                            appearance-none pl-4 pr-8 py-1.5 text-sm font-medium rounded-full 
                            border transition-all duration-200 cursor-pointer shadow-sm
                            ${i==="dark"?"bg-gray-800 border-gray-700 text-gray-200 hover:border-gray-600 focus:ring-2 focus:ring-emerald-500/50":"bg-white border-gray-200 text-gray-700 hover:border-gray-300 focus:ring-2 focus:ring-emerald-500/50"}
                        `,children:l==null?void 0:l.map(m=>t.jsx("option",{value:m,children:h(m)},m))}),t.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-gray-400",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),r&&t.jsx("button",{onClick:r,className:`
                        flex items-center gap-2 px-4 py-1.5 rounded-full text-sm font-semibold shadow-sm
                        transition-all duration-200 border
                        ${e?i==="dark"?"bg-emerald-600 text-white border-emerald-500 hover:bg-emerald-500 hover:shadow-emerald-500/20":"bg-emerald-500 text-white border-emerald-400 hover:bg-emerald-600 hover:shadow-emerald-500/20":i==="dark"?"bg-gray-800 text-gray-300 border-gray-700 hover:bg-gray-700 hover:text-white":"bg-white text-gray-600 border-gray-200 hover:bg-gray-50 hover:text-gray-900"}
                    `,title:e?"View Option Chain Table":"View Chart",children:e?t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Table View"]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"})}),"Chart View"]})})]})});ts.displayName="OptionControls";const ga=typeof document<"u"?V.useLayoutEffect:()=>{};var _r;const xl=(_r=V.useInsertionEffect)!==null&&_r!==void 0?_r:ga;function pl(e){const r=o.useRef(null);return xl(()=>{r.current=e},[e]),o.useCallback((...s)=>{const a=r.current;return a==null?void 0:a(...s)},[])}const rt=e=>{var r;return(r=e==null?void 0:e.ownerDocument)!==null&&r!==void 0?r:document},ct=e=>e&&"window"in e&&e.window===e?e:rt(e).defaultView||window;function hl(e){return e!==null&&typeof e=="object"&&"nodeType"in e&&typeof e.nodeType=="number"}function fl(e){return hl(e)&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&"host"in e}let bl=!1;function rs(){return bl}function ma(e,r){if(!rs())return r&&e?e.contains(r):!1;if(!e||!r)return!1;let s=r;for(;s!==null;){if(s===e)return!0;s.tagName==="SLOT"&&s.assignedSlot?s=s.assignedSlot.parentNode:fl(s)?s=s.host:s=s.parentNode}return!1}const Ar=(e=document)=>{var r;if(!rs())return e.activeElement;let s=e.activeElement;for(;s&&"shadowRoot"in s&&(!((r=s.shadowRoot)===null||r===void 0)&&r.activeElement);)s=s.shadowRoot.activeElement;return s};function xa(e){return rs()&&e.target.shadowRoot&&e.composedPath?e.composedPath()[0]:e.target}function vl(e){var r;if(typeof window>"u"||window.navigator==null)return!1;let s=(r=window.navigator.userAgentData)===null||r===void 0?void 0:r.brands;return Array.isArray(s)&&s.some(a=>e.test(a.brand))||e.test(window.navigator.userAgent)}function yl(e){var r;return typeof window<"u"&&window.navigator!=null?e.test(((r=window.navigator.userAgentData)===null||r===void 0?void 0:r.platform)||window.navigator.platform):!1}function pa(e){let r=null;return()=>(r==null&&(r=e()),r)}const kl=pa(function(){return yl(/^Mac/i)}),jl=pa(function(){return vl(/Android/i)});function ha(){let e=o.useRef(new Map),r=o.useCallback((n,l,i,c)=>{let d=c!=null&&c.once?(...g)=>{e.current.delete(i),i(...g)}:i;e.current.set(i,{type:l,eventTarget:n,fn:d,options:c}),n.addEventListener(l,d,c)},[]),s=o.useCallback((n,l,i,c)=>{var d;let g=((d=e.current.get(i))===null||d===void 0?void 0:d.fn)||i;n.removeEventListener(l,g,c),e.current.delete(i)},[]),a=o.useCallback(()=>{e.current.forEach((n,l)=>{s(n.eventTarget,n.type,l,n.options)})},[s]);return o.useEffect(()=>a,[a]),{addGlobalListener:r,removeGlobalListener:s,removeAllGlobalListeners:a}}function wl(e){return e.pointerType===""&&e.isTrusted?!0:jl()&&e.pointerType?e.type==="click"&&e.buttons===1:e.detail===0&&!e.pointerType}function fa(e){let r=e;return r.nativeEvent=e,r.isDefaultPrevented=()=>r.defaultPrevented,r.isPropagationStopped=()=>r.cancelBubble,r.persist=()=>{},r}function Nl(e,r){Object.defineProperty(e,"target",{value:r}),Object.defineProperty(e,"currentTarget",{value:r})}function ba(e){let r=o.useRef({isFocused:!1,observer:null});ga(()=>{const a=r.current;return()=>{a.observer&&(a.observer.disconnect(),a.observer=null)}},[]);let s=pl(a=>{e==null||e(a)});return o.useCallback(a=>{if(a.target instanceof HTMLButtonElement||a.target instanceof HTMLInputElement||a.target instanceof HTMLTextAreaElement||a.target instanceof HTMLSelectElement){r.current.isFocused=!0;let n=a.target,l=i=>{if(r.current.isFocused=!1,n.disabled){let c=fa(i);s(c)}r.current.observer&&(r.current.observer.disconnect(),r.current.observer=null)};n.addEventListener("focusout",l,{once:!0}),r.current.observer=new MutationObserver(()=>{if(r.current.isFocused&&n.disabled){var i;(i=r.current.observer)===null||i===void 0||i.disconnect();let c=n===document.activeElement?null:document.activeElement;n.dispatchEvent(new FocusEvent("blur",{relatedTarget:c})),n.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:c}))}}),r.current.observer.observe(n,{attributes:!0,attributeFilter:["disabled"]})}},[s])}let Cl=!1,Dt=null,Br=new Set,Rt=new Map,gt=!1,Dr=!1;const Sl={Tab:!0,Escape:!0};function ss(e,r){for(let s of Br)s(e,r)}function $l(e){return!(e.metaKey||!kl()&&e.altKey||e.ctrlKey||e.key==="Control"||e.key==="Shift"||e.key==="Meta")}function nr(e){gt=!0,$l(e)&&(Dt="keyboard",ss("keyboard",e))}function yt(e){Dt="pointer",(e.type==="mousedown"||e.type==="pointerdown")&&(gt=!0,ss("pointer",e))}function va(e){wl(e)&&(gt=!0,Dt="virtual")}function ya(e){e.target===window||e.target===document||Cl||!e.isTrusted||(!gt&&!Dr&&(Dt="virtual",ss("virtual",e)),gt=!1,Dr=!1)}function ka(){gt=!1,Dr=!0}function Gr(e){if(typeof window>"u"||typeof document>"u"||Rt.get(ct(e)))return;const r=ct(e),s=rt(e);let a=r.HTMLElement.prototype.focus;r.HTMLElement.prototype.focus=function(){gt=!0,a.apply(this,arguments)},s.addEventListener("keydown",nr,!0),s.addEventListener("keyup",nr,!0),s.addEventListener("click",va,!0),r.addEventListener("focus",ya,!0),r.addEventListener("blur",ka,!1),typeof PointerEvent<"u"&&(s.addEventListener("pointerdown",yt,!0),s.addEventListener("pointermove",yt,!0),s.addEventListener("pointerup",yt,!0)),r.addEventListener("beforeunload",()=>{ja(e)},{once:!0}),Rt.set(r,{focus:a})}const ja=(e,r)=>{const s=ct(e),a=rt(e);r&&a.removeEventListener("DOMContentLoaded",r),Rt.has(s)&&(s.HTMLElement.prototype.focus=Rt.get(s).focus,a.removeEventListener("keydown",nr,!0),a.removeEventListener("keyup",nr,!0),a.removeEventListener("click",va,!0),s.removeEventListener("focus",ya,!0),s.removeEventListener("blur",ka,!1),typeof PointerEvent<"u"&&(a.removeEventListener("pointerdown",yt,!0),a.removeEventListener("pointermove",yt,!0),a.removeEventListener("pointerup",yt,!0)),Rt.delete(s))};function _l(e){const r=rt(e);let s;return r.readyState!=="loading"?Gr(e):(s=()=>{Gr(e)},r.addEventListener("DOMContentLoaded",s)),()=>ja(e,s)}typeof document<"u"&&_l();function wa(){return Dt!=="pointer"}const El=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function Fl(e,r,s){let a=rt(s==null?void 0:s.target);const n=typeof window<"u"?ct(s==null?void 0:s.target).HTMLInputElement:HTMLInputElement,l=typeof window<"u"?ct(s==null?void 0:s.target).HTMLTextAreaElement:HTMLTextAreaElement,i=typeof window<"u"?ct(s==null?void 0:s.target).HTMLElement:HTMLElement,c=typeof window<"u"?ct(s==null?void 0:s.target).KeyboardEvent:KeyboardEvent;return e=e||a.activeElement instanceof n&&!El.has(a.activeElement.type)||a.activeElement instanceof l||a.activeElement instanceof i&&a.activeElement.isContentEditable,!(e&&r==="keyboard"&&s instanceof c&&!Sl[s.key])}function Tl(e,r,s){Gr(),o.useEffect(()=>{let a=(n,l)=>{Fl(!!(s!=null&&s.isTextInput),n,l)&&e(wa())};return Br.add(a),()=>{Br.delete(a)}},r)}function Pl(e){let{isDisabled:r,onFocus:s,onBlur:a,onFocusChange:n}=e;const l=o.useCallback(d=>{if(d.target===d.currentTarget)return a&&a(d),n&&n(!1),!0},[a,n]),i=ba(l),c=o.useCallback(d=>{const g=rt(d.target),u=g?Ar(g):Ar();d.target===d.currentTarget&&u===xa(d.nativeEvent)&&(s&&s(d),n&&n(!0),i(d))},[n,s,i]);return{focusProps:{onFocus:!r&&(s||n||a)?c:void 0,onBlur:!r&&(a||n)?l:void 0}}}function Il(e){let{isDisabled:r,onBlurWithin:s,onFocusWithin:a,onFocusWithinChange:n}=e,l=o.useRef({isFocusWithin:!1}),{addGlobalListener:i,removeAllGlobalListeners:c}=ha(),d=o.useCallback(h=>{h.currentTarget.contains(h.target)&&l.current.isFocusWithin&&!h.currentTarget.contains(h.relatedTarget)&&(l.current.isFocusWithin=!1,c(),s&&s(h),n&&n(!1))},[s,n,l,c]),g=ba(d),u=o.useCallback(h=>{if(!h.currentTarget.contains(h.target))return;const m=rt(h.target),p=Ar(m);if(!l.current.isFocusWithin&&p===xa(h.nativeEvent)){a&&a(h),n&&n(!0),l.current.isFocusWithin=!0,g(h);let x=h.currentTarget;i(m,"focus",b=>{if(l.current.isFocusWithin&&!ma(x,b.target)){let v=new m.defaultView.FocusEvent("blur",{relatedTarget:b.target});Nl(v,x);let y=fa(v);d(y)}},{capture:!0})}},[a,n,g,i,d]);return r?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:u,onBlur:d}}}let Hr=!1,Qt=0;function Ll(){Hr=!0,setTimeout(()=>{Hr=!1},50)}function Ts(e){e.pointerType==="touch"&&Ll()}function Ml(){if(!(typeof document>"u"))return Qt===0&&typeof PointerEvent<"u"&&document.addEventListener("pointerup",Ts),Qt++,()=>{Qt--,!(Qt>0)&&typeof PointerEvent<"u"&&document.removeEventListener("pointerup",Ts)}}function Na(e){let{onHoverStart:r,onHoverChange:s,onHoverEnd:a,isDisabled:n}=e,[l,i]=o.useState(!1),c=o.useRef({isHovered:!1,ignoreEmulatedMouseEvents:!1,pointerType:"",target:null}).current;o.useEffect(Ml,[]);let{addGlobalListener:d,removeAllGlobalListeners:g}=ha(),{hoverProps:u,triggerHoverEnd:h}=o.useMemo(()=>{let m=(b,v)=>{if(c.pointerType=v,n||v==="touch"||c.isHovered||!b.currentTarget.contains(b.target))return;c.isHovered=!0;let y=b.currentTarget;c.target=y,d(rt(b.target),"pointerover",k=>{c.isHovered&&c.target&&!ma(c.target,k.target)&&p(k,k.pointerType)},{capture:!0}),r&&r({type:"hoverstart",target:y,pointerType:v}),s&&s(!0),i(!0)},p=(b,v)=>{let y=c.target;c.pointerType="",c.target=null,!(v==="touch"||!c.isHovered||!y)&&(c.isHovered=!1,g(),a&&a({type:"hoverend",target:y,pointerType:v}),s&&s(!1),i(!1))},x={};return typeof PointerEvent<"u"&&(x.onPointerEnter=b=>{Hr&&b.pointerType==="mouse"||m(b,b.pointerType)},x.onPointerLeave=b=>{!n&&b.currentTarget.contains(b.target)&&p(b,b.pointerType)}),{hoverProps:x,triggerHoverEnd:p}},[r,s,a,n,c,d,g]);return o.useEffect(()=>{n&&h({currentTarget:c.target},c.pointerType)},[n]),{hoverProps:u,isHovered:l}}function as(e={}){let{autoFocus:r=!1,isTextInput:s,within:a}=e,n=o.useRef({isFocused:!1,isFocusVisible:r||wa()}),[l,i]=o.useState(!1),[c,d]=o.useState(()=>n.current.isFocused&&n.current.isFocusVisible),g=o.useCallback(()=>d(n.current.isFocused&&n.current.isFocusVisible),[]),u=o.useCallback(p=>{n.current.isFocused=p,i(p),g()},[g]);Tl(p=>{n.current.isFocusVisible=p,g()},[],{isTextInput:s});let{focusProps:h}=Pl({isDisabled:a,onFocusChange:u}),{focusWithinProps:m}=Il({isDisabled:!a,onFocusWithinChange:u});return{isFocused:l,isFocusVisible:c,focusProps:a?m:h}}var Ol=Object.defineProperty,Rl=(e,r,s)=>r in e?Ol(e,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[r]=s,Er=(e,r,s)=>(Rl(e,typeof r!="symbol"?r+"":r,s),s);let Vl=class{constructor(){Er(this,"current",this.detect()),Er(this,"handoffState","pending"),Er(this,"currentId",0)}set(r){this.current!==r&&(this.handoffState="pending",this.currentId=0,this.current=r)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}handoff(){this.handoffState==="pending"&&(this.handoffState="complete")}get isHandoffComplete(){return this.handoffState==="complete"}},ze=new Vl;function Nt(e){var r;return ze.isServer?null:e==null?document:(r=e==null?void 0:e.ownerDocument)!=null?r:document}function Wr(e){var r,s;return ze.isServer?null:e==null?document:(s=(r=e==null?void 0:e.getRootNode)==null?void 0:r.call(e))!=null?s:document}function ns(e){var r,s;return(s=(r=Wr(e))==null?void 0:r.activeElement)!=null?s:null}function Al(e){return ns(e)===e}function Gt(e){typeof queueMicrotask=="function"?queueMicrotask(e):Promise.resolve().then(e).catch(r=>setTimeout(()=>{throw r}))}function Je(){let e=[],r={addEventListener(s,a,n,l){return s.addEventListener(a,n,l),r.add(()=>s.removeEventListener(a,n,l))},requestAnimationFrame(...s){let a=requestAnimationFrame(...s);return r.add(()=>cancelAnimationFrame(a))},nextFrame(...s){return r.requestAnimationFrame(()=>r.requestAnimationFrame(...s))},setTimeout(...s){let a=setTimeout(...s);return r.add(()=>clearTimeout(a))},microTask(...s){let a={current:!0};return Gt(()=>{a.current&&s[0]()}),r.add(()=>{a.current=!1})},style(s,a,n){let l=s.style.getPropertyValue(a);return Object.assign(s.style,{[a]:n}),this.add(()=>{Object.assign(s.style,{[a]:l})})},group(s){let a=Je();return s(a),this.add(()=>a.dispose())},add(s){return e.includes(s)||e.push(s),()=>{let a=e.indexOf(s);if(a>=0)for(let n of e.splice(a,1))n()}},dispose(){for(let s of e.splice(0))s()}};return r}function pt(){let[e]=o.useState(Je);return o.useEffect(()=>()=>e.dispose(),[e]),e}let ke=(e,r)=>{ze.isServer?o.useEffect(e,r):o.useLayoutEffect(e,r)};function Be(e){let r=o.useRef(e);return ke(()=>{r.current=e},[e]),r}let X=function(e){let r=Be(e);return V.useCallback((...s)=>r.current(...s),[r])};function Bl(e){let r=e.width/2,s=e.height/2;return{top:e.clientY-s,right:e.clientX+r,bottom:e.clientY+s,left:e.clientX-r}}function Dl(e,r){return!(!e||!r||e.right<r.left||e.left>r.right||e.bottom<r.top||e.top>r.bottom)}function Ca({disabled:e=!1}={}){let r=o.useRef(null),[s,a]=o.useState(!1),n=pt(),l=X(()=>{r.current=null,a(!1),n.dispose()}),i=X(c=>{if(n.dispose(),r.current===null){r.current=c.currentTarget,a(!0);{let d=Nt(c.currentTarget);n.addEventListener(d,"pointerup",l,!1),n.addEventListener(d,"pointermove",g=>{if(r.current){let u=Bl(g);a(Dl(u,r.current.getBoundingClientRect()))}},!1),n.addEventListener(d,"pointercancel",l,!1)}}});return{pressed:s,pressProps:e?{}:{onPointerDown:i,onPointerUp:l,onClick:l}}}function Ie(e){return o.useMemo(()=>e,Object.values(e))}let Gl=o.createContext(void 0);function ls(){return o.useContext(Gl)}function Ur(...e){return Array.from(new Set(e.flatMap(r=>typeof r=="string"?r.split(" "):[]))).filter(Boolean).join(" ")}function $e(e,r,...s){if(e in r){let n=r[e];return typeof n=="function"?n(...s):n}let a=new Error(`Tried to handle "${e}" but there is no handler defined. Only defined handlers are: ${Object.keys(r).map(n=>`"${n}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(a,$e),a}var kt=(e=>(e[e.None=0]="None",e[e.RenderStrategy=1]="RenderStrategy",e[e.Static=2]="Static",e))(kt||{}),et=(e=>(e[e.Unmount=0]="Unmount",e[e.Hidden=1]="Hidden",e))(et||{});function ve(){let e=Wl();return o.useCallback(r=>Hl({mergeRefs:e,...r}),[e])}function Hl({ourProps:e,theirProps:r,slot:s,defaultTag:a,features:n,visible:l=!0,name:i,mergeRefs:c}){c=c??Ul;let d=Sa(r,e);if(l)return er(d,s,a,i,c);let g=n??0;if(g&2){let{static:u=!1,...h}=d;if(u)return er(h,s,a,i,c)}if(g&1){let{unmount:u=!0,...h}=d;return $e(u?0:1,{0(){return null},1(){return er({...h,hidden:!0,style:{display:"none"}},s,a,i,c)}})}return er(d,s,a,i,c)}function er(e,r={},s,a,n){let{as:l=s,children:i,refName:c="ref",...d}=Fr(e,["unmount","static"]),g=e.ref!==void 0?{[c]:e.ref}:{},u=typeof i=="function"?i(r):i;"className"in d&&d.className&&typeof d.className=="function"&&(d.className=d.className(r)),d["aria-labelledby"]&&d["aria-labelledby"]===d.id&&(d["aria-labelledby"]=void 0);let h={};if(r){let m=!1,p=[];for(let[x,b]of Object.entries(r))typeof b=="boolean"&&(m=!0),b===!0&&p.push(x.replace(/([A-Z])/g,v=>`-${v.toLowerCase()}`));if(m){h["data-headlessui-state"]=p.join(" ");for(let x of p)h[`data-${x}`]=""}}if(Vt(l)&&(Object.keys(Ze(d)).length>0||Object.keys(Ze(h)).length>0))if(!o.isValidElement(u)||Array.isArray(u)&&u.length>1||Kl(u)){if(Object.keys(Ze(d)).length>0)throw new Error(['Passing props on "Fragment"!',"",`The current component <${a} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(Ze(d)).concat(Object.keys(Ze(h))).map(m=>`  - ${m}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(m=>`  - ${m}`).join(`
`)].join(`
`))}else{let m=u.props,p=m==null?void 0:m.className,x=typeof p=="function"?(...y)=>Ur(p(...y),d.className):Ur(p,d.className),b=x?{className:x}:{},v=Sa(u.props,Ze(Fr(d,["ref"])));for(let y in h)y in v&&delete h[y];return o.cloneElement(u,Object.assign({},v,h,g,{ref:n(zl(u),g.ref)},b))}return o.createElement(l,Object.assign({},Fr(d,["ref"]),!Vt(l)&&g,!Vt(l)&&h),u)}function Wl(){let e=o.useRef([]),r=o.useCallback(s=>{for(let a of e.current)a!=null&&(typeof a=="function"?a(s):a.current=s)},[]);return(...s)=>{if(!s.every(a=>a==null))return e.current=s,r}}function Ul(...e){return e.every(r=>r==null)?void 0:r=>{for(let s of e)s!=null&&(typeof s=="function"?s(r):s.current=r)}}function Sa(...e){if(e.length===0)return{};if(e.length===1)return e[0];let r={},s={};for(let a of e)for(let n in a)n.startsWith("on")&&typeof a[n]=="function"?(s[n]!=null||(s[n]=[]),s[n].push(a[n])):r[n]=a[n];if(r.disabled||r["aria-disabled"])for(let a in s)/^(on(?:Click|Pointer|Mouse|Key)(?:Down|Up|Press)?)$/.test(a)&&(s[a]=[n=>{var l;return(l=n==null?void 0:n.preventDefault)==null?void 0:l.call(n)}]);for(let a in s)Object.assign(r,{[a](n,...l){let i=s[a];for(let c of i){if((n instanceof Event||(n==null?void 0:n.nativeEvent)instanceof Event)&&n.defaultPrevented)return;c(n,...l)}}});return r}function is(...e){if(e.length===0)return{};if(e.length===1)return e[0];let r={},s={};for(let a of e)for(let n in a)n.startsWith("on")&&typeof a[n]=="function"?(s[n]!=null||(s[n]=[]),s[n].push(a[n])):r[n]=a[n];for(let a in s)Object.assign(r,{[a](...n){let l=s[a];for(let i of l)i==null||i(...n)}});return r}function fe(e){var r;return Object.assign(o.forwardRef(e),{displayName:(r=e.displayName)!=null?r:e.name})}function Ze(e){let r=Object.assign({},e);for(let s in r)r[s]===void 0&&delete r[s];return r}function Fr(e,r=[]){let s=Object.assign({},e);for(let a of r)a in s&&delete s[a];return s}function zl(e){return V.version.split(".")[0]>="19"?e.props.ref:e.ref}function Vt(e){return e===o.Fragment||e===Symbol.for("react.fragment")}function Kl(e){return Vt(e.type)}function ql(e,r,s){let[a,n]=o.useState(s),l=e!==void 0,i=o.useRef(l),c=o.useRef(!1),d=o.useRef(!1);return l&&!i.current&&!c.current?(c.current=!0,i.current=l,console.error("A component is changing from uncontrolled to controlled. This may be caused by the value changing from undefined to a defined value, which should not happen.")):!l&&i.current&&!d.current&&(d.current=!0,i.current=l,console.error("A component is changing from controlled to uncontrolled. This may be caused by the value changing from a defined value to undefined, which should not happen.")),[l?e:a,X(g=>(l||Bt.flushSync(()=>n(g)),r==null?void 0:r(g)))]}function Yl(e){let[r]=o.useState(e);return r}function $a(e={},r=null,s=[]){for(let[a,n]of Object.entries(e))Ea(s,_a(r,a),n);return s}function _a(e,r){return e?e+"["+r+"]":r}function Ea(e,r,s){if(Array.isArray(s))for(let[a,n]of s.entries())Ea(e,_a(r,a.toString()),n);else s instanceof Date?e.push([r,s.toISOString()]):typeof s=="boolean"?e.push([r,s?"1":"0"]):typeof s=="string"?e.push([r,s]):typeof s=="number"?e.push([r,`${s}`]):s==null?e.push([r,""]):Jl(s)&&!o.isValidElement(s)&&$a(s,r,e)}function Xl(e){var r,s;let a=(r=e==null?void 0:e.form)!=null?r:e.closest("form");if(a){for(let n of a.elements)if(n!==e&&(n.tagName==="INPUT"&&n.type==="submit"||n.tagName==="BUTTON"&&n.type==="submit"||n.nodeName==="INPUT"&&n.type==="image")){n.click();return}(s=a.requestSubmit)==null||s.call(a)}}function Jl(e){if(Object.prototype.toString.call(e)!=="[object Object]")return!1;let r=Object.getPrototypeOf(e);return r===null||Object.getPrototypeOf(r)===null}let Zl="span";var mt=(e=>(e[e.None=1]="None",e[e.Focusable=2]="Focusable",e[e.Hidden=4]="Hidden",e))(mt||{});function Ql(e,r){var s;let{features:a=1,...n}=e,l={ref:r,"aria-hidden":(a&2)===2?!0:(s=n["aria-hidden"])!=null?s:void 0,hidden:(a&4)===4?!0:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(a&4)===4&&(a&2)!==2&&{display:"none"}}};return ve()({ourProps:l,theirProps:n,slot:{},defaultTag:Zl,name:"Hidden"})}let xt=fe(Ql),ei=o.createContext(null);function ti({children:e}){let r=o.useContext(ei);if(!r)return V.createElement(V.Fragment,null,e);let{target:s}=r;return s?Bt.createPortal(V.createElement(V.Fragment,null,e),s):null}function ri({data:e,form:r,disabled:s,onReset:a,overrides:n}){let[l,i]=o.useState(null),c=pt();return o.useEffect(()=>{if(a&&l)return c.addEventListener(l,"reset",a)},[l,r,a]),V.createElement(ti,null,V.createElement(si,{setForm:i,formId:r}),$a(e).map(([d,g])=>V.createElement(xt,{features:mt.Hidden,...Ze({key:d,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:r,disabled:s,name:d,value:g,...n})})))}function si({setForm:e,formId:r}){return o.useEffect(()=>{if(r){let s=document.getElementById(r);s&&e(s)}},[e,r]),r?null:V.createElement(xt,{features:mt.Hidden,as:"input",type:"hidden",hidden:!0,readOnly:!0,ref:s=>{if(!s)return;let a=s.closest("form");a&&e(a)}})}let ai=o.createContext(void 0);function Fa(){return o.useContext(ai)}function ni(e){return typeof e!="object"||e===null?!1:"nodeType"in e}function Ye(e){return ni(e)&&"tagName"in e}function Ke(e){return Ye(e)&&"accessKey"in e}function tt(e){return Ye(e)&&"tabIndex"in e}function li(e){return Ye(e)&&"style"in e}function ii(e){return Ke(e)&&e.nodeName==="IFRAME"}function Ta(e){return Ke(e)&&e.nodeName==="INPUT"}function zr(e){return Ke(e)&&e.nodeName==="LABEL"}function oi(e){return Ke(e)&&e.nodeName==="FIELDSET"}function Pa(e){return Ke(e)&&e.nodeName==="LEGEND"}function ci(e){return Ye(e)?e.matches('a[href],audio[controls],button,details,embed,iframe,img[usemap],input:not([type="hidden"]),label,select,textarea,video[controls]'):!1}function di(e){let r=e.parentElement,s=null;for(;r&&!oi(r);)Pa(r)&&(s=r),r=r.parentElement;let a=(r==null?void 0:r.getAttribute("disabled"))==="";return a&&ui(s)?!1:a}function ui(e){if(!e)return!1;let r=e.previousElementSibling;for(;r!==null;){if(Pa(r))return!1;r=r.previousElementSibling}return!0}let Ia=Symbol();function gi(e,r=!0){return Object.assign(e,{[Ia]:r})}function Ne(...e){let r=o.useRef(e);o.useEffect(()=>{r.current=e},[e]);let s=X(a=>{for(let n of r.current)n!=null&&(typeof n=="function"?n(a):n.current=a)});return e.every(a=>a==null||(a==null?void 0:a[Ia]))?void 0:s}let gr=o.createContext(null);gr.displayName="DescriptionContext";function La(){let e=o.useContext(gr);if(e===null){let r=new Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(r,La),r}return e}function mi(){var e,r;return(r=(e=o.useContext(gr))==null?void 0:e.value)!=null?r:void 0}function Ma(){let[e,r]=o.useState([]);return[e.length>0?e.join(" "):void 0,o.useMemo(()=>function(s){let a=X(l=>(r(i=>[...i,l]),()=>r(i=>{let c=i.slice(),d=c.indexOf(l);return d!==-1&&c.splice(d,1),c}))),n=o.useMemo(()=>({register:a,slot:s.slot,name:s.name,props:s.props,value:s.value}),[a,s.slot,s.name,s.props,s.value]);return V.createElement(gr.Provider,{value:n},s.children)},[r])]}let xi="p";function pi(e,r){let s=o.useId(),a=ls(),{id:n=`headlessui-description-${s}`,...l}=e,i=La(),c=Ne(r);ke(()=>i.register(n),[n,i.register]);let d=Ie({...i.slot,disabled:a||!1}),g={ref:c,...i.props,id:n};return ve()({ourProps:g,theirProps:l,slot:d,defaultTag:xi,name:i.name||"Description"})}let hi=fe(pi),Oa=Object.assign(hi,{});var Se=(e=>(e.Space=" ",e.Enter="Enter",e.Escape="Escape",e.Backspace="Backspace",e.Delete="Delete",e.ArrowLeft="ArrowLeft",e.ArrowUp="ArrowUp",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e.Home="Home",e.End="End",e.PageUp="PageUp",e.PageDown="PageDown",e.Tab="Tab",e))(Se||{});let mr=o.createContext(null);mr.displayName="LabelContext";function Ra(){let e=o.useContext(mr);if(e===null){let r=new Error("You used a <Label /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(r,Ra),r}return e}function Va(e){var r,s,a;let n=(s=(r=o.useContext(mr))==null?void 0:r.value)!=null?s:void 0;return((a=void 0)!=null?a:0)>0?[n,...e].filter(Boolean).join(" "):n}function fi({inherit:e=!1}={}){let r=Va(),[s,a]=o.useState([]),n=e?[r,...s].filter(Boolean):s;return[n.length>0?n.join(" "):void 0,o.useMemo(()=>function(l){let i=X(d=>(a(g=>[...g,d]),()=>a(g=>{let u=g.slice(),h=u.indexOf(d);return h!==-1&&u.splice(h,1),u}))),c=o.useMemo(()=>({register:i,slot:l.slot,name:l.name,props:l.props,value:l.value}),[i,l.slot,l.name,l.props,l.value]);return V.createElement(mr.Provider,{value:c},l.children)},[a])]}let bi="label";function vi(e,r){var s;let a=o.useId(),n=Ra(),l=Fa(),i=ls(),{id:c=`headlessui-label-${a}`,htmlFor:d=l??((s=n.props)==null?void 0:s.htmlFor),passive:g=!1,...u}=e,h=Ne(r);ke(()=>n.register(c),[c,n.register]);let m=X(b=>{let v=b.currentTarget;if(!(b.target!==b.currentTarget&&ci(b.target))&&(zr(v)&&b.preventDefault(),n.props&&"onClick"in n.props&&typeof n.props.onClick=="function"&&n.props.onClick(b),zr(v))){let y=document.getElementById(v.htmlFor);if(y){let k=y.getAttribute("disabled");if(k==="true"||k==="")return;let N=y.getAttribute("aria-disabled");if(N==="true"||N==="")return;(Ta(y)&&(y.type==="file"||y.type==="radio"||y.type==="checkbox")||y.role==="radio"||y.role==="checkbox"||y.role==="switch")&&y.click(),y.focus({preventScroll:!0})}}}),p=Ie({...n.slot,disabled:i||!1}),x={ref:h,...n.props,id:c,htmlFor:d,onClick:m};return g&&("onClick"in x&&(delete x.htmlFor,delete x.onClick),"onClick"in u&&delete u.onClick),ve()({ourProps:x,theirProps:u,slot:p,defaultTag:d?bi:"div",name:n.name||"Label"})}let yi=fe(vi),ki=Object.assign(yi,{}),ji=o.createContext(()=>{});function wi({value:e,children:r}){return V.createElement(ji.Provider,{value:e},r)}let Aa=class extends Map{constructor(r){super(),this.factory=r}get(r){let s=super.get(r);return s===void 0&&(s=this.factory(r),this.set(r,s)),s}};var Ni=Object.defineProperty,Ci=(e,r,s)=>r in e?Ni(e,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[r]=s,Si=(e,r,s)=>(Ci(e,r+"",s),s),Ba=(e,r,s)=>{if(!r.has(e))throw TypeError("Cannot "+s)},Te=(e,r,s)=>(Ba(e,r,"read from private field"),s?s.call(e):r.get(e)),Tr=(e,r,s)=>{if(r.has(e))throw TypeError("Cannot add the same private member more than once");r instanceof WeakSet?r.add(e):r.set(e,s)},Ps=(e,r,s,a)=>(Ba(e,r,"write to private field"),r.set(e,s),s),We,It,Lt;let $i=class{constructor(r){Tr(this,We,{}),Tr(this,It,new Aa(()=>new Set)),Tr(this,Lt,new Set),Si(this,"disposables",Je()),Ps(this,We,r),ze.isServer&&this.disposables.microTask(()=>{this.dispose()})}dispose(){this.disposables.dispose()}get state(){return Te(this,We)}subscribe(r,s){if(ze.isServer)return()=>{};let a={selector:r,callback:s,current:r(Te(this,We))};return Te(this,Lt).add(a),this.disposables.add(()=>{Te(this,Lt).delete(a)})}on(r,s){return ze.isServer?()=>{}:(Te(this,It).get(r).add(s),this.disposables.add(()=>{Te(this,It).get(r).delete(s)}))}send(r){let s=this.reduce(Te(this,We),r);if(s!==Te(this,We)){Ps(this,We,s);for(let a of Te(this,Lt)){let n=a.selector(Te(this,We));Da(a.current,n)||(a.current=n,a.callback(n))}for(let a of Te(this,It).get(r.type))a(Te(this,We),r)}}};We=new WeakMap,It=new WeakMap,Lt=new WeakMap;function Da(e,r){return Object.is(e,r)?!0:typeof e!="object"||e===null||typeof r!="object"||r===null?!1:Array.isArray(e)&&Array.isArray(r)?e.length!==r.length?!1:Pr(e[Symbol.iterator](),r[Symbol.iterator]()):e instanceof Map&&r instanceof Map||e instanceof Set&&r instanceof Set?e.size!==r.size?!1:Pr(e.entries(),r.entries()):Is(e)&&Is(r)?Pr(Object.entries(e)[Symbol.iterator](),Object.entries(r)[Symbol.iterator]()):!1}function Pr(e,r){do{let s=e.next(),a=r.next();if(s.done&&a.done)return!0;if(s.done||a.done||!Object.is(s.value,a.value))return!1}while(!0)}function Is(e){if(Object.prototype.toString.call(e)!=="[object Object]")return!1;let r=Object.getPrototypeOf(e);return r===null||Object.getPrototypeOf(r)===null}var _i=Object.defineProperty,Ei=(e,r,s)=>r in e?_i(e,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[r]=s,Ls=(e,r,s)=>(Ei(e,typeof r!="symbol"?r+"":r,s),s),Fi=(e=>(e[e.Push=0]="Push",e[e.Pop=1]="Pop",e))(Fi||{});let Ti={0(e,r){let s=r.id,a=e.stack,n=e.stack.indexOf(s);if(n!==-1){let l=e.stack.slice();return l.splice(n,1),l.push(s),a=l,{...e,stack:a}}return{...e,stack:[...e.stack,s]}},1(e,r){let s=r.id,a=e.stack.indexOf(s);if(a===-1)return e;let n=e.stack.slice();return n.splice(a,1),{...e,stack:n}}},Pi=class Ga extends $i{constructor(){super(...arguments),Ls(this,"actions",{push:r=>this.send({type:0,id:r}),pop:r=>this.send({type:1,id:r})}),Ls(this,"selectors",{isTop:(r,s)=>r.stack[r.stack.length-1]===s,inStack:(r,s)=>r.stack.includes(s)})}static new(){return new Ga({stack:[]})}reduce(r,s){return $e(s.type,Ti,r,s)}};const Ha=new Aa(()=>Pi.new());function Wa(e,r,s=Da){return yn.useSyncExternalStoreWithSelector(X(a=>e.subscribe(Ii,a)),X(()=>e.state),X(()=>e.state),X(r),s)}function Ii(e){return e}function Ht(e,r){let s=o.useId(),a=Ha.get(r),[n,l]=Wa(a,o.useCallback(i=>[a.selectors.isTop(i,s),a.selectors.inStack(i,s)],[a,s]));return ke(()=>{if(e)return a.actions.push(s),()=>a.actions.pop(s)},[a,e,s]),e?l?n:!0:!1}let Kr=new Map,At=new Map;function Ms(e){var r;let s=(r=At.get(e))!=null?r:0;return At.set(e,s+1),s!==0?()=>Os(e):(Kr.set(e,{"aria-hidden":e.getAttribute("aria-hidden"),inert:e.inert}),e.setAttribute("aria-hidden","true"),e.inert=!0,()=>Os(e))}function Os(e){var r;let s=(r=At.get(e))!=null?r:1;if(s===1?At.delete(e):At.set(e,s-1),s!==1)return;let a=Kr.get(e);a&&(a["aria-hidden"]===null?e.removeAttribute("aria-hidden"):e.setAttribute("aria-hidden",a["aria-hidden"]),e.inert=a.inert,Kr.delete(e))}function Li(e,{allowed:r,disallowed:s}={}){let a=Ht(e,"inert-others");ke(()=>{var n,l;if(!a)return;let i=Je();for(let d of(n=s==null?void 0:s())!=null?n:[])d&&i.add(Ms(d));let c=(l=r==null?void 0:r())!=null?l:[];for(let d of c){if(!d)continue;let g=Nt(d);if(!g)continue;let u=d.parentElement;for(;u&&u!==g.body;){for(let h of u.children)c.some(m=>h.contains(m))||i.add(Ms(h));u=u.parentElement}}return i.dispose},[a,r,s])}function Mi(e,r,s){let a=Be(n=>{let l=n.getBoundingClientRect();l.x===0&&l.y===0&&l.width===0&&l.height===0&&s()});o.useEffect(()=>{if(!e)return;let n=r===null?null:Ke(r)?r:r.current;if(!n)return;let l=Je();if(typeof ResizeObserver<"u"){let i=new ResizeObserver(()=>a.current(n));i.observe(n),l.add(()=>i.disconnect())}if(typeof IntersectionObserver<"u"){let i=new IntersectionObserver(()=>a.current(n));i.observe(n),l.add(()=>i.disconnect())}return()=>l.dispose()},[r,a,e])}let lr=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","details>summary","textarea:not([disabled])"].map(e=>`${e}:not([tabindex='-1'])`).join(","),Oi=["[data-autofocus]"].map(e=>`${e}:not([tabindex='-1'])`).join(",");var ye=(e=>(e[e.First=1]="First",e[e.Previous=2]="Previous",e[e.Next=4]="Next",e[e.Last=8]="Last",e[e.WrapAround=16]="WrapAround",e[e.NoScroll=32]="NoScroll",e[e.AutoFocus=64]="AutoFocus",e))(ye||{}),dt=(e=>(e[e.Error=0]="Error",e[e.Overflow=1]="Overflow",e[e.Success=2]="Success",e[e.Underflow=3]="Underflow",e))(dt||{}),Ri=(e=>(e[e.Previous=-1]="Previous",e[e.Next=1]="Next",e))(Ri||{});function Vi(e=document.body){return e==null?[]:Array.from(e.querySelectorAll(lr)).sort((r,s)=>Math.sign((r.tabIndex||Number.MAX_SAFE_INTEGER)-(s.tabIndex||Number.MAX_SAFE_INTEGER)))}function Ai(e=document.body){return e==null?[]:Array.from(e.querySelectorAll(Oi)).sort((r,s)=>Math.sign((r.tabIndex||Number.MAX_SAFE_INTEGER)-(s.tabIndex||Number.MAX_SAFE_INTEGER)))}var Ua=(e=>(e[e.Strict=0]="Strict",e[e.Loose=1]="Loose",e))(Ua||{});function Bi(e,r=0){var s;return e===((s=Nt(e))==null?void 0:s.body)?!1:$e(r,{0(){return e.matches(lr)},1(){let a=e;for(;a!==null;){if(a.matches(lr))return!0;a=a.parentElement}return!1}})}var Di=(e=>(e[e.Keyboard=0]="Keyboard",e[e.Mouse=1]="Mouse",e))(Di||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",e=>{e.metaKey||e.altKey||e.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",e=>{e.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:e.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function Xe(e){e==null||e.focus({preventScroll:!0})}let Gi=["textarea","input"].join(",");function Hi(e){var r,s;return(s=(r=e==null?void 0:e.matches)==null?void 0:r.call(e,Gi))!=null?s:!1}function vt(e,r=s=>s){return e.slice().sort((s,a)=>{let n=r(s),l=r(a);if(n===null||l===null)return 0;let i=n.compareDocumentPosition(l);return i&Node.DOCUMENT_POSITION_FOLLOWING?-1:i&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function Ae(e,r,{sorted:s=!0,relativeTo:a=null,skipElements:n=[]}={}){let l=Array.isArray(e)?e.length>0?Wr(e[0]):document:Wr(e),i=Array.isArray(e)?s?vt(e):e:r&64?Ai(e):Vi(e);n.length>0&&i.length>1&&(i=i.filter(p=>!n.some(x=>x!=null&&"current"in x?(x==null?void 0:x.current)===p:x===p))),a=a??(l==null?void 0:l.activeElement);let c=(()=>{if(r&5)return 1;if(r&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),d=(()=>{if(r&1)return 0;if(r&2)return Math.max(0,i.indexOf(a))-1;if(r&4)return Math.max(0,i.indexOf(a))+1;if(r&8)return i.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),g=r&32?{preventScroll:!0}:{},u=0,h=i.length,m;do{if(u>=h||u+h<=0)return 0;let p=d+u;if(r&16)p=(p+h)%h;else{if(p<0)return 3;if(p>=h)return 1}m=i[p],m==null||m.focus(g),u+=c}while(m!==ns(m));return r&6&&Hi(m)&&m.select(),2}function za(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function Wi(){return/Android/gi.test(window.navigator.userAgent)}function Rs(){return za()||Wi()}function tr(e,r,s,a){let n=Be(s);o.useEffect(()=>{if(!e)return;function l(i){n.current(i)}return document.addEventListener(r,l,a),()=>document.removeEventListener(r,l,a)},[e,r,a])}function Ka(e,r,s,a){let n=Be(s);o.useEffect(()=>{if(!e)return;function l(i){n.current(i)}return window.addEventListener(r,l,a),()=>window.removeEventListener(r,l,a)},[e,r,a])}const Vs=30;function Ui(e,r,s){let a=Be(s),n=o.useCallback(function(c,d){if(c.defaultPrevented)return;let g=d(c);if(g===null||!g.getRootNode().contains(g)||!g.isConnected)return;let u=(function h(m){return typeof m=="function"?h(m()):Array.isArray(m)||m instanceof Set?m:[m]})(r);for(let h of u)if(h!==null&&(h.contains(g)||c.composed&&c.composedPath().includes(h)))return;return!Bi(g,Ua.Loose)&&g.tabIndex!==-1&&c.preventDefault(),a.current(c,g)},[a,r]),l=o.useRef(null);tr(e,"pointerdown",c=>{var d,g;Rs()||(l.current=((g=(d=c.composedPath)==null?void 0:d.call(c))==null?void 0:g[0])||c.target)},!0),tr(e,"pointerup",c=>{if(Rs()||!l.current)return;let d=l.current;return l.current=null,n(c,()=>d)},!0);let i=o.useRef({x:0,y:0});tr(e,"touchstart",c=>{i.current.x=c.touches[0].clientX,i.current.y=c.touches[0].clientY},!0),tr(e,"touchend",c=>{let d={x:c.changedTouches[0].clientX,y:c.changedTouches[0].clientY};if(!(Math.abs(d.x-i.current.x)>=Vs||Math.abs(d.y-i.current.y)>=Vs))return n(c,()=>tt(c.target)?c.target:null)},!0),Ka(e,"blur",c=>n(c,()=>ii(window.document.activeElement)?window.document.activeElement:null),!0)}function os(...e){return o.useMemo(()=>Nt(...e),[...e])}function qa(e,r,s,a){let n=Be(s);o.useEffect(()=>{e=e??window;function l(i){n.current(i)}return e.addEventListener(r,l,a),()=>e.removeEventListener(r,l,a)},[e,r,a])}function Ya(e,r){return o.useMemo(()=>{var s;if(e.type)return e.type;let a=(s=e.as)!=null?s:"button";if(typeof a=="string"&&a.toLowerCase()==="button"||(r==null?void 0:r.tagName)==="BUTTON"&&!r.hasAttribute("type"))return"button"},[e.type,e.as,r])}function zi(e){return o.useSyncExternalStore(e.subscribe,e.getSnapshot,e.getSnapshot)}function Ki(e,r){let s=e(),a=new Set;return{getSnapshot(){return s},subscribe(n){return a.add(n),()=>a.delete(n)},dispatch(n,...l){let i=r[n].call(s,...l);i&&(s=i,a.forEach(c=>c()))}}}function qi(){let e;return{before({doc:r}){var s;let a=r.documentElement,n=(s=r.defaultView)!=null?s:window;e=Math.max(0,n.innerWidth-a.clientWidth)},after({doc:r,d:s}){let a=r.documentElement,n=Math.max(0,a.clientWidth-a.offsetWidth),l=Math.max(0,e-n);s.style(a,"paddingRight",`${l}px`)}}}function Yi(){return za()?{before({doc:e,d:r,meta:s}){function a(n){for(let l of s().containers)for(let i of l())if(i.contains(n))return!0;return!1}r.microTask(()=>{var n;if(window.getComputedStyle(e.documentElement).scrollBehavior!=="auto"){let c=Je();c.style(e.documentElement,"scrollBehavior","auto"),r.add(()=>r.microTask(()=>c.dispose()))}let l=(n=window.scrollY)!=null?n:window.pageYOffset,i=null;r.addEventListener(e,"click",c=>{if(tt(c.target))try{let d=c.target.closest("a");if(!d)return;let{hash:g}=new URL(d.href),u=e.querySelector(g);tt(u)&&!a(u)&&(i=u)}catch{}},!0),r.group(c=>{r.addEventListener(e,"touchstart",d=>{if(c.dispose(),tt(d.target)&&li(d.target))if(a(d.target)){let g=d.target;for(;g.parentElement&&a(g.parentElement);)g=g.parentElement;c.style(g,"overscrollBehavior","contain")}else c.style(d.target,"touchAction","none")})}),r.addEventListener(e,"touchmove",c=>{if(tt(c.target)){if(Ta(c.target))return;if(a(c.target)){let d=c.target;for(;d.parentElement&&d.dataset.headlessuiPortal!==""&&!(d.scrollHeight>d.clientHeight||d.scrollWidth>d.clientWidth);)d=d.parentElement;d.dataset.headlessuiPortal===""&&c.preventDefault()}else c.preventDefault()}},{passive:!1}),r.add(()=>{var c;let d=(c=window.scrollY)!=null?c:window.pageYOffset;l!==d&&window.scrollTo(0,l),i&&i.isConnected&&(i.scrollIntoView({block:"nearest"}),i=null)})})}}:{}}function Xi(){return{before({doc:e,d:r}){r.style(e.documentElement,"overflow","hidden")}}}function As(e){let r={};for(let s of e)Object.assign(r,s(r));return r}let ut=Ki(()=>new Map,{PUSH(e,r){var s;let a=(s=this.get(e))!=null?s:{doc:e,count:0,d:Je(),meta:new Set,computedMeta:{}};return a.count++,a.meta.add(r),a.computedMeta=As(a.meta),this.set(e,a),this},POP(e,r){let s=this.get(e);return s&&(s.count--,s.meta.delete(r),s.computedMeta=As(s.meta)),this},SCROLL_PREVENT(e){let r={doc:e.doc,d:e.d,meta(){return e.computedMeta}},s=[Yi(),qi(),Xi()];s.forEach(({before:a})=>a==null?void 0:a(r)),s.forEach(({after:a})=>a==null?void 0:a(r))},SCROLL_ALLOW({d:e}){e.dispose()},TEARDOWN({doc:e}){this.delete(e)}});ut.subscribe(()=>{let e=ut.getSnapshot(),r=new Map;for(let[s]of e)r.set(s,s.documentElement.style.overflow);for(let s of e.values()){let a=r.get(s.doc)==="hidden",n=s.count!==0;(n&&!a||!n&&a)&&ut.dispatch(s.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",s),s.count===0&&ut.dispatch("TEARDOWN",s)}});function Ji(e,r,s=()=>({containers:[]})){let a=zi(ut),n=r?a.get(r):void 0,l=n?n.count>0:!1;return ke(()=>{if(!(!r||!e))return ut.dispatch("PUSH",r,s),()=>ut.dispatch("POP",r,s)},[e,r]),l}function Zi(e,r,s=()=>[document.body]){let a=Ht(e,"scroll-lock");Ji(a,r,n=>{var l;return{containers:[...(l=n.containers)!=null?l:[],s]}})}function Qi(e=0){let[r,s]=o.useState(e),a=o.useCallback(d=>s(d),[]),n=o.useCallback(d=>s(g=>g|d),[]),l=o.useCallback(d=>(r&d)===d,[r]),i=o.useCallback(d=>s(g=>g&~d),[]),c=o.useCallback(d=>s(g=>g^d),[]);return{flags:r,setFlag:a,addFlag:n,hasFlag:l,removeFlag:i,toggleFlag:c}}var eo={},Bs,Ds;typeof process<"u"&&typeof globalThis<"u"&&typeof Element<"u"&&((Bs=process==null?void 0:eo)==null?void 0:Bs.NODE_ENV)==="test"&&typeof((Ds=Element==null?void 0:Element.prototype)==null?void 0:Ds.getAnimations)>"u"&&(Element.prototype.getAnimations=function(){return console.warn(["Headless UI has polyfilled `Element.prototype.getAnimations` for your tests.","Please install a proper polyfill e.g. `jsdom-testing-mocks`, to silence these warnings.","","Example usage:","```js","import { mockAnimationsApi } from 'jsdom-testing-mocks'","mockAnimationsApi()","```"].join(`
`)),[]});var to=(e=>(e[e.None=0]="None",e[e.Closed=1]="Closed",e[e.Enter=2]="Enter",e[e.Leave=4]="Leave",e))(to||{});function ro(e){let r={};for(let s in e)e[s]===!0&&(r[`data-${s}`]="");return r}function so(e,r,s,a){let[n,l]=o.useState(s),{hasFlag:i,addFlag:c,removeFlag:d}=Qi(e&&n?3:0),g=o.useRef(!1),u=o.useRef(!1),h=pt();return ke(()=>{var m;if(e){if(s&&l(!0),!r){s&&c(3);return}return(m=a==null?void 0:a.start)==null||m.call(a,s),ao(r,{inFlight:g,prepare(){u.current?u.current=!1:u.current=g.current,g.current=!0,!u.current&&(s?(c(3),d(4)):(c(4),d(2)))},run(){u.current?s?(d(3),c(4)):(d(4),c(3)):s?d(1):c(1)},done(){var p;u.current&&io(r)||(g.current=!1,d(7),s||l(!1),(p=a==null?void 0:a.end)==null||p.call(a,s))}})}},[e,s,r,h]),e?[n,{closed:i(1),enter:i(2),leave:i(4),transition:i(2)||i(4)}]:[s,{closed:void 0,enter:void 0,leave:void 0,transition:void 0}]}function ao(e,{prepare:r,run:s,done:a,inFlight:n}){let l=Je();return lo(e,{prepare:r,inFlight:n}),l.nextFrame(()=>{s(),l.requestAnimationFrame(()=>{l.add(no(e,a))})}),l.dispose}function no(e,r){var s,a;let n=Je();if(!e)return n.dispose;let l=!1;n.add(()=>{l=!0});let i=(a=(s=e.getAnimations)==null?void 0:s.call(e).filter(c=>c instanceof CSSTransition))!=null?a:[];return i.length===0?(r(),n.dispose):(Promise.allSettled(i.map(c=>c.finished)).then(()=>{l||r()}),n.dispose)}function lo(e,{inFlight:r,prepare:s}){if(r!=null&&r.current){s();return}let a=e.style.transition;e.style.transition="none",s(),e.offsetHeight,e.style.transition=a}function io(e){var r,s;return((s=(r=e.getAnimations)==null?void 0:r.call(e))!=null?s:[]).some(a=>a instanceof CSSTransition&&a.playState!=="finished")}function cs(e,r){let s=o.useRef([]),a=X(e);o.useEffect(()=>{let n=[...s.current];for(let[l,i]of r.entries())if(s.current[l]!==i){let c=a(r,n);return s.current=r,c}},[a,...r])}let xr=o.createContext(null);xr.displayName="OpenClosedContext";var De=(e=>(e[e.Open=1]="Open",e[e.Closed=2]="Closed",e[e.Closing=4]="Closing",e[e.Opening=8]="Opening",e))(De||{});function pr(){return o.useContext(xr)}function oo({value:e,children:r}){return V.createElement(xr.Provider,{value:e},r)}function co({children:e}){return V.createElement(xr.Provider,{value:null},e)}function uo(e){function r(){document.readyState!=="loading"&&(e(),document.removeEventListener("DOMContentLoaded",r))}typeof window<"u"&&typeof document<"u"&&(document.addEventListener("DOMContentLoaded",r),r())}let Qe=[];uo(()=>{function e(r){if(!tt(r.target)||r.target===document.body||Qe[0]===r.target)return;let s=r.target;s=s.closest(lr),Qe.unshift(s??r.target),Qe=Qe.filter(a=>a!=null&&a.isConnected),Qe.splice(10)}window.addEventListener("click",e,{capture:!0}),window.addEventListener("mousedown",e,{capture:!0}),window.addEventListener("focus",e,{capture:!0}),document.body.addEventListener("click",e,{capture:!0}),document.body.addEventListener("mousedown",e,{capture:!0}),document.body.addEventListener("focus",e,{capture:!0})});function Xa(e){let r=X(e),s=o.useRef(!1);o.useEffect(()=>(s.current=!1,()=>{s.current=!0,Gt(()=>{s.current&&r()})}),[r])}let Ja=o.createContext(!1);function go(){return o.useContext(Ja)}function Gs(e){return V.createElement(Ja.Provider,{value:e.force},e.children)}function mo(e){let r=go(),s=o.useContext(Qa),[a,n]=o.useState(()=>{var l;if(!r&&s!==null)return(l=s.current)!=null?l:null;if(ze.isServer)return null;let i=e==null?void 0:e.getElementById("headlessui-portal-root");if(i)return i;if(e===null)return null;let c=e.createElement("div");return c.setAttribute("id","headlessui-portal-root"),e.body.appendChild(c)});return o.useEffect(()=>{a!==null&&(e!=null&&e.body.contains(a)||e==null||e.body.appendChild(a))},[a,e]),o.useEffect(()=>{r||s!==null&&n(s.current)},[s,n,r]),a}let Za=o.Fragment,xo=fe(function(e,r){let{ownerDocument:s=null,...a}=e,n=o.useRef(null),l=Ne(gi(m=>{n.current=m}),r),i=os(n.current),c=s??i,d=mo(c),g=o.useContext(qr),u=pt(),h=ve();return Xa(()=>{var m;d&&d.childNodes.length<=0&&((m=d.parentElement)==null||m.removeChild(d))}),d?Bt.createPortal(V.createElement("div",{"data-headlessui-portal":"",ref:m=>{u.dispose(),g&&m&&u.add(g.register(m))}},h({ourProps:{ref:l},theirProps:a,slot:{},defaultTag:Za,name:"Portal"})),d):null});function po(e,r){let s=Ne(r),{enabled:a=!0,ownerDocument:n,...l}=e,i=ve();return a?V.createElement(xo,{...l,ownerDocument:n,ref:s}):i({ourProps:{ref:s},theirProps:l,slot:{},defaultTag:Za,name:"Portal"})}let ho=o.Fragment,Qa=o.createContext(null);function fo(e,r){let{target:s,...a}=e,n={ref:Ne(r)},l=ve();return V.createElement(Qa.Provider,{value:s},l({ourProps:n,theirProps:a,defaultTag:ho,name:"Popover.Group"}))}let qr=o.createContext(null);function bo(){let e=o.useContext(qr),r=o.useRef([]),s=X(l=>(r.current.push(l),e&&e.register(l),()=>a(l))),a=X(l=>{let i=r.current.indexOf(l);i!==-1&&r.current.splice(i,1),e&&e.unregister(l)}),n=o.useMemo(()=>({register:s,unregister:a,portals:r}),[s,a,r]);return[r,o.useMemo(()=>function({children:l}){return V.createElement(qr.Provider,{value:n},l)},[n])]}let vo=fe(po),en=fe(fo),yo=Object.assign(vo,{Group:en});function ko(e,r=typeof document<"u"?document.defaultView:null,s){let a=Ht(e,"escape");qa(r,"keydown",n=>{a&&(n.defaultPrevented||n.key===Se.Escape&&s(n))})}function jo(){var e;let[r]=o.useState(()=>typeof window<"u"&&typeof window.matchMedia=="function"?window.matchMedia("(pointer: coarse)"):null),[s,a]=o.useState((e=r==null?void 0:r.matches)!=null?e:!1);return ke(()=>{if(!r)return;function n(l){a(l.matches)}return r.addEventListener("change",n),()=>r.removeEventListener("change",n)},[r]),s}function wo({defaultContainers:e=[],portals:r,mainTreeNode:s}={}){let a=X(()=>{var n,l;let i=Nt(s),c=[];for(let d of e)d!==null&&(Ye(d)?c.push(d):"current"in d&&Ye(d.current)&&c.push(d.current));if(r!=null&&r.current)for(let d of r.current)c.push(d);for(let d of(n=i==null?void 0:i.querySelectorAll("html > *, body > *"))!=null?n:[])d!==document.body&&d!==document.head&&Ye(d)&&d.id!=="headlessui-portal-root"&&(s&&(d.contains(s)||d.contains((l=s==null?void 0:s.getRootNode())==null?void 0:l.host))||c.some(g=>d.contains(g))||c.push(d));return c});return{resolveContainers:a,contains:X(n=>a().some(l=>l.contains(n)))}}let tn=o.createContext(null);function Hs({children:e,node:r}){let[s,a]=o.useState(null),n=rn(r??s);return V.createElement(tn.Provider,{value:n},e,n===null&&V.createElement(xt,{features:mt.Hidden,ref:l=>{var i,c;if(l){for(let d of(c=(i=Nt(l))==null?void 0:i.querySelectorAll("html > *, body > *"))!=null?c:[])if(d!==document.body&&d!==document.head&&Ye(d)&&d!=null&&d.contains(l)){a(d);break}}}}))}function rn(e=null){var r;return(r=o.useContext(tn))!=null?r:e}function No(){let e=typeof document>"u";return"useSyncExternalStore"in ws?(r=>r.useSyncExternalStore)(ws)(()=>()=>{},()=>!1,()=>!e):!1}function hr(){let e=No(),[r,s]=o.useState(ze.isHandoffComplete);return r&&ze.isHandoffComplete===!1&&s(!1),o.useEffect(()=>{r!==!0&&s(!0)},[r]),o.useEffect(()=>ze.handoff(),[]),e?!1:r}function fr(){let e=o.useRef(!1);return ke(()=>(e.current=!0,()=>{e.current=!1}),[]),e}var Mt=(e=>(e[e.Forwards=0]="Forwards",e[e.Backwards=1]="Backwards",e))(Mt||{});function Co(){let e=o.useRef(0);return Ka(!0,"keydown",r=>{r.key==="Tab"&&(e.current=r.shiftKey?1:0)},!0),e}function sn(e){if(!e)return new Set;if(typeof e=="function")return new Set(e());let r=new Set;for(let s of e.current)Ye(s.current)&&r.add(s.current);return r}let So="div";var ot=(e=>(e[e.None=0]="None",e[e.InitialFocus=1]="InitialFocus",e[e.TabLock=2]="TabLock",e[e.FocusLock=4]="FocusLock",e[e.RestoreFocus=8]="RestoreFocus",e[e.AutoFocus=16]="AutoFocus",e))(ot||{});function $o(e,r){let s=o.useRef(null),a=Ne(s,r),{initialFocus:n,initialFocusFallback:l,containers:i,features:c=15,...d}=e;hr()||(c=0);let g=os(s.current);To(c,{ownerDocument:g});let u=Po(c,{ownerDocument:g,container:s,initialFocus:n,initialFocusFallback:l});Io(c,{ownerDocument:g,container:s,containers:i,previousActiveElement:u});let h=Co(),m=X(k=>{if(!Ke(s.current))return;let N=s.current;(_=>_())(()=>{$e(h.current,{[Mt.Forwards]:()=>{Ae(N,ye.First,{skipElements:[k.relatedTarget,l]})},[Mt.Backwards]:()=>{Ae(N,ye.Last,{skipElements:[k.relatedTarget,l]})}})})}),p=Ht(!!(c&2),"focus-trap#tab-lock"),x=pt(),b=o.useRef(!1),v={ref:a,onKeyDown(k){k.key=="Tab"&&(b.current=!0,x.requestAnimationFrame(()=>{b.current=!1}))},onBlur(k){if(!(c&4))return;let N=sn(i);Ke(s.current)&&N.add(s.current);let _=k.relatedTarget;tt(_)&&_.dataset.headlessuiFocusGuard!=="true"&&(an(N,_)||(b.current?Ae(s.current,$e(h.current,{[Mt.Forwards]:()=>ye.Next,[Mt.Backwards]:()=>ye.Previous})|ye.WrapAround,{relativeTo:k.target}):tt(k.target)&&Xe(k.target)))}},y=ve();return V.createElement(V.Fragment,null,p&&V.createElement(xt,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:m,features:mt.Focusable}),y({ourProps:v,theirProps:d,defaultTag:So,name:"FocusTrap"}),p&&V.createElement(xt,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:m,features:mt.Focusable}))}let _o=fe($o),Eo=Object.assign(_o,{features:ot});function Fo(e=!0){let r=o.useRef(Qe.slice());return cs(([s],[a])=>{a===!0&&s===!1&&Gt(()=>{r.current.splice(0)}),a===!1&&s===!0&&(r.current=Qe.slice())},[e,Qe,r]),X(()=>{var s;return(s=r.current.find(a=>a!=null&&a.isConnected))!=null?s:null})}function To(e,{ownerDocument:r}){let s=!!(e&8),a=Fo(s);cs(()=>{s||Al(r==null?void 0:r.body)&&Xe(a())},[s]),Xa(()=>{s&&Xe(a())})}function Po(e,{ownerDocument:r,container:s,initialFocus:a,initialFocusFallback:n}){let l=o.useRef(null),i=Ht(!!(e&1),"focus-trap#initial-focus"),c=fr();return cs(()=>{if(e===0)return;if(!i){n!=null&&n.current&&Xe(n.current);return}let d=s.current;d&&Gt(()=>{if(!c.current)return;let g=r==null?void 0:r.activeElement;if(a!=null&&a.current){if((a==null?void 0:a.current)===g){l.current=g;return}}else if(d.contains(g)){l.current=g;return}if(a!=null&&a.current)Xe(a.current);else{if(e&16){if(Ae(d,ye.First|ye.AutoFocus)!==dt.Error)return}else if(Ae(d,ye.First)!==dt.Error)return;if(n!=null&&n.current&&(Xe(n.current),(r==null?void 0:r.activeElement)===n.current))return;console.warn("There are no focusable elements inside the <FocusTrap />")}l.current=r==null?void 0:r.activeElement})},[n,i,e]),l}function Io(e,{ownerDocument:r,container:s,containers:a,previousActiveElement:n}){let l=fr(),i=!!(e&4);qa(r==null?void 0:r.defaultView,"focus",c=>{if(!i||!l.current)return;let d=sn(a);Ke(s.current)&&d.add(s.current);let g=n.current;if(!g)return;let u=c.target;Ke(u)?an(d,u)?(n.current=u,Xe(u)):(c.preventDefault(),c.stopPropagation(),Xe(g)):Xe(n.current)},!0)}function an(e,r){for(let s of e)if(s.contains(r))return!0;return!1}function nn(e){var r;return!!(e.enter||e.enterFrom||e.enterTo||e.leave||e.leaveFrom||e.leaveTo)||!Vt((r=e.as)!=null?r:on)||V.Children.count(e.children)===1}let br=o.createContext(null);br.displayName="TransitionContext";var Lo=(e=>(e.Visible="visible",e.Hidden="hidden",e))(Lo||{});function Mo(){let e=o.useContext(br);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}function Oo(){let e=o.useContext(vr);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}let vr=o.createContext(null);vr.displayName="NestingContext";function yr(e){return"children"in e?yr(e.children):e.current.filter(({el:r})=>r.current!==null).filter(({state:r})=>r==="visible").length>0}function ln(e,r){let s=Be(e),a=o.useRef([]),n=fr(),l=pt(),i=X((p,x=et.Hidden)=>{let b=a.current.findIndex(({el:v})=>v===p);b!==-1&&($e(x,{[et.Unmount](){a.current.splice(b,1)},[et.Hidden](){a.current[b].state="hidden"}}),l.microTask(()=>{var v;!yr(a)&&n.current&&((v=s.current)==null||v.call(s))}))}),c=X(p=>{let x=a.current.find(({el:b})=>b===p);return x?x.state!=="visible"&&(x.state="visible"):a.current.push({el:p,state:"visible"}),()=>i(p,et.Unmount)}),d=o.useRef([]),g=o.useRef(Promise.resolve()),u=o.useRef({enter:[],leave:[]}),h=X((p,x,b)=>{d.current.splice(0),r&&(r.chains.current[x]=r.chains.current[x].filter(([v])=>v!==p)),r==null||r.chains.current[x].push([p,new Promise(v=>{d.current.push(v)})]),r==null||r.chains.current[x].push([p,new Promise(v=>{Promise.all(u.current[x].map(([y,k])=>k)).then(()=>v())})]),x==="enter"?g.current=g.current.then(()=>r==null?void 0:r.wait.current).then(()=>b(x)):b(x)}),m=X((p,x,b)=>{Promise.all(u.current[x].splice(0).map(([v,y])=>y)).then(()=>{var v;(v=d.current.shift())==null||v()}).then(()=>b(x))});return o.useMemo(()=>({children:a,register:c,unregister:i,onStart:h,onStop:m,wait:g,chains:u}),[c,i,a,h,m,u,g])}let on=o.Fragment,cn=kt.RenderStrategy;function Ro(e,r){var s,a;let{transition:n=!0,beforeEnter:l,afterEnter:i,beforeLeave:c,afterLeave:d,enter:g,enterFrom:u,enterTo:h,entered:m,leave:p,leaveFrom:x,leaveTo:b,...v}=e,[y,k]=o.useState(null),N=o.useRef(null),_=nn(e),C=Ne(..._?[N,r,k]:r===null?[]:[r]),w=(s=v.unmount)==null||s?et.Unmount:et.Hidden,{show:f,appear:E,initial:P}=Mo(),[L,O]=o.useState(f?"visible":"hidden"),I=Oo(),{register:q,unregister:se}=I;ke(()=>q(N),[q,N]),ke(()=>{if(w===et.Hidden&&N.current){if(f&&L!=="visible"){O("visible");return}return $e(L,{hidden:()=>se(N),visible:()=>q(N)})}},[L,N,q,se,f,w]);let te=hr();ke(()=>{if(_&&te&&L==="visible"&&N.current===null)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[N,L,te,_]);let S=P&&!E,D=E&&f&&P,H=o.useRef(!1),W=ln(()=>{H.current||(O("hidden"),se(N))},I),M=X(pe=>{H.current=!0;let Me=pe?"enter":"leave";W.onStart(N,Me,Oe=>{Oe==="enter"?l==null||l():Oe==="leave"&&(c==null||c())})}),$=X(pe=>{let Me=pe?"enter":"leave";H.current=!1,W.onStop(N,Me,Oe=>{Oe==="enter"?i==null||i():Oe==="leave"&&(d==null||d())}),Me==="leave"&&!yr(W)&&(O("hidden"),se(N))});o.useEffect(()=>{_&&n||(M(f),$(f))},[f,_,n]);let Q=!(!n||!_||!te||S),[,G]=so(Q,y,f,{start:M,end:$}),me=Ze({ref:C,className:((a=Ur(v.className,D&&g,D&&u,G.enter&&g,G.enter&&G.closed&&u,G.enter&&!G.closed&&h,G.leave&&p,G.leave&&!G.closed&&x,G.leave&&G.closed&&b,!G.transition&&f&&m))==null?void 0:a.trim())||void 0,...ro(G)}),be=0;L==="visible"&&(be|=De.Open),L==="hidden"&&(be|=De.Closed),f&&L==="hidden"&&(be|=De.Opening),!f&&L==="visible"&&(be|=De.Closing);let Le=ve();return V.createElement(vr.Provider,{value:W},V.createElement(oo,{value:be},Le({ourProps:me,theirProps:v,defaultTag:on,features:cn,visible:L==="visible",name:"Transition.Child"})))}function Vo(e,r){let{show:s,appear:a=!1,unmount:n=!0,...l}=e,i=o.useRef(null),c=nn(e),d=Ne(...c?[i,r]:r===null?[]:[r]);hr();let g=pr();if(s===void 0&&g!==null&&(s=(g&De.Open)===De.Open),s===void 0)throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[u,h]=o.useState(s?"visible":"hidden"),m=ln(()=>{s||h("hidden")}),[p,x]=o.useState(!0),b=o.useRef([s]);ke(()=>{p!==!1&&b.current[b.current.length-1]!==s&&(b.current.push(s),x(!1))},[b,s]);let v=o.useMemo(()=>({show:s,appear:a,initial:p}),[s,a,p]);ke(()=>{s?h("visible"):!yr(m)&&i.current!==null&&h("hidden")},[s,m]);let y={unmount:n},k=X(()=>{var C;p&&x(!1),(C=e.beforeEnter)==null||C.call(e)}),N=X(()=>{var C;p&&x(!1),(C=e.beforeLeave)==null||C.call(e)}),_=ve();return V.createElement(vr.Provider,{value:m},V.createElement(br.Provider,{value:v},_({ourProps:{...y,as:o.Fragment,children:V.createElement(dn,{ref:d,...y,...l,beforeEnter:k,beforeLeave:N})},theirProps:{},defaultTag:o.Fragment,features:cn,visible:u==="visible",name:"Transition"})))}function Ao(e,r){let s=o.useContext(br)!==null,a=pr()!==null;return V.createElement(V.Fragment,null,!s&&a?V.createElement(Yr,{ref:r,...e}):V.createElement(dn,{ref:r,...e}))}let Yr=fe(Vo),dn=fe(Ro),ds=fe(Ao),rr=Object.assign(Yr,{Child:ds,Root:Yr});var Bo=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Bo||{}),Do=(e=>(e[e.SetTitleId=0]="SetTitleId",e))(Do||{});let Go={0(e,r){return e.titleId===r.id?e:{...e,titleId:r.id}}},us=o.createContext(null);us.displayName="DialogContext";function kr(e){let r=o.useContext(us);if(r===null){let s=new Error(`<${e} /> is missing a parent <Dialog /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,kr),s}return r}function Ho(e,r){return $e(r.type,Go,e,r)}let Ws=fe(function(e,r){let s=o.useId(),{id:a=`headlessui-dialog-${s}`,open:n,onClose:l,initialFocus:i,role:c="dialog",autoFocus:d=!0,__demoMode:g=!1,unmount:u=!1,...h}=e,m=o.useRef(!1);c=(function(){return c==="dialog"||c==="alertdialog"?c:(m.current||(m.current=!0,console.warn(`Invalid role [${c}] passed to <Dialog />. Only \`dialog\` and and \`alertdialog\` are supported. Using \`dialog\` instead.`)),"dialog")})();let p=pr();n===void 0&&p!==null&&(n=(p&De.Open)===De.Open);let x=o.useRef(null),b=Ne(x,r),v=os(x.current),y=n?0:1,[k,N]=o.useReducer(Ho,{titleId:null,descriptionId:null,panelRef:o.createRef()}),_=X(()=>l(!1)),C=X(G=>N({type:0,id:G})),w=hr()?y===0:!1,[f,E]=bo(),P={get current(){var G;return(G=k.panelRef.current)!=null?G:x.current}},L=rn(),{resolveContainers:O}=wo({mainTreeNode:L,portals:f,defaultContainers:[P]}),I=p!==null?(p&De.Closing)===De.Closing:!1;Li(g||I?!1:w,{allowed:X(()=>{var G,me;return[(me=(G=x.current)==null?void 0:G.closest("[data-headlessui-portal]"))!=null?me:null]}),disallowed:X(()=>{var G;return[(G=L==null?void 0:L.closest("body > *:not(#headlessui-portal-root)"))!=null?G:null]})});let q=Ha.get(null);ke(()=>{if(w)return q.actions.push(a),()=>q.actions.pop(a)},[q,a,w]);let se=Wa(q,o.useCallback(G=>q.selectors.isTop(G,a),[q,a]));Ui(se,O,G=>{G.preventDefault(),_()}),ko(se,v==null?void 0:v.defaultView,G=>{G.preventDefault(),G.stopPropagation(),document.activeElement&&"blur"in document.activeElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur(),_()}),Zi(g||I?!1:w,v,O),Mi(w,x,_);let[te,S]=Ma(),D=o.useMemo(()=>[{dialogState:y,close:_,setTitleId:C,unmount:u},k],[y,_,C,u,k]),H=Ie({open:y===0}),W={ref:b,id:a,role:c,tabIndex:-1,"aria-modal":g?void 0:y===0?!0:void 0,"aria-labelledby":k.titleId,"aria-describedby":te,unmount:u},M=!jo(),$=ot.None;w&&!g&&($|=ot.RestoreFocus,$|=ot.TabLock,d&&($|=ot.AutoFocus),M&&($|=ot.InitialFocus));let Q=ve();return V.createElement(co,null,V.createElement(Gs,{force:!0},V.createElement(yo,null,V.createElement(us.Provider,{value:D},V.createElement(en,{target:x},V.createElement(Gs,{force:!1},V.createElement(S,{slot:H},V.createElement(E,null,V.createElement(Eo,{initialFocus:i,initialFocusFallback:x,containers:O,features:$},V.createElement(wi,{value:_},Q({ourProps:W,theirProps:h,slot:H,defaultTag:Wo,features:Uo,visible:y===0,name:"Dialog"})))))))))))}),Wo="div",Uo=kt.RenderStrategy|kt.Static;function zo(e,r){let{transition:s=!1,open:a,...n}=e,l=pr(),i=e.hasOwnProperty("open")||l!==null,c=e.hasOwnProperty("onClose");if(!i&&!c)throw new Error("You have to provide an `open` and an `onClose` prop to the `Dialog` component.");if(!i)throw new Error("You provided an `onClose` prop to the `Dialog`, but forgot an `open` prop.");if(!c)throw new Error("You provided an `open` prop to the `Dialog`, but forgot an `onClose` prop.");if(!l&&typeof e.open!="boolean")throw new Error(`You provided an \`open\` prop to the \`Dialog\`, but the value is not a boolean. Received: ${e.open}`);if(typeof e.onClose!="function")throw new Error(`You provided an \`onClose\` prop to the \`Dialog\`, but the value is not a function. Received: ${e.onClose}`);return(a!==void 0||s)&&!n.static?V.createElement(Hs,null,V.createElement(rr,{show:a,transition:s,unmount:n.unmount},V.createElement(Ws,{ref:r,...n}))):V.createElement(Hs,null,V.createElement(Ws,{ref:r,open:a,...n}))}let Ko="div";function qo(e,r){let s=o.useId(),{id:a=`headlessui-dialog-panel-${s}`,transition:n=!1,...l}=e,[{dialogState:i,unmount:c},d]=kr("Dialog.Panel"),g=Ne(r,d.panelRef),u=Ie({open:i===0}),h=X(v=>{v.stopPropagation()}),m={ref:g,id:a,onClick:h},p=n?ds:o.Fragment,x=n?{unmount:c}:{},b=ve();return V.createElement(p,{...x},b({ourProps:m,theirProps:l,slot:u,defaultTag:Ko,name:"Dialog.Panel"}))}let Yo="div";function Xo(e,r){let{transition:s=!1,...a}=e,[{dialogState:n,unmount:l}]=kr("Dialog.Backdrop"),i=Ie({open:n===0}),c={ref:r,"aria-hidden":!0},d=s?ds:o.Fragment,g=s?{unmount:l}:{},u=ve();return V.createElement(d,{...g},u({ourProps:c,theirProps:a,slot:i,defaultTag:Yo,name:"Dialog.Backdrop"}))}let Jo="h2";function Zo(e,r){let s=o.useId(),{id:a=`headlessui-dialog-title-${s}`,...n}=e,[{dialogState:l,setTitleId:i}]=kr("Dialog.Title"),c=Ne(r);o.useEffect(()=>(i(a),()=>i(null)),[a,i]);let d=Ie({open:l===0}),g={ref:c,id:a};return ve()({ourProps:g,theirProps:n,slot:d,defaultTag:Jo,name:"Dialog.Title"})}let Qo=fe(zo),ec=fe(qo);fe(Xo);let tc=fe(Zo),Ir=Object.assign(Qo,{Panel:ec,Title:tc,Description:Oa}),gs=o.createContext(null);gs.displayName="GroupContext";let rc=o.Fragment;function sc(e){var r;let[s,a]=o.useState(null),[n,l]=fi(),[i,c]=Ma(),d=o.useMemo(()=>({switch:s,setSwitch:a}),[s,a]),g={},u=e,h=ve();return V.createElement(c,{name:"Switch.Description",value:i},V.createElement(l,{name:"Switch.Label",value:n,props:{htmlFor:(r=d.switch)==null?void 0:r.id,onClick(m){s&&(zr(m.currentTarget)&&m.preventDefault(),s.click(),s.focus({preventScroll:!0}))}}},V.createElement(gs.Provider,{value:d},h({ourProps:g,theirProps:u,slot:{},defaultTag:rc,name:"Switch.Group"}))))}let ac="button";function nc(e,r){var s;let a=o.useId(),n=Fa(),l=ls(),{id:i=n||`headlessui-switch-${a}`,disabled:c=l||!1,checked:d,defaultChecked:g,onChange:u,name:h,value:m,form:p,autoFocus:x=!1,...b}=e,v=o.useContext(gs),[y,k]=o.useState(null),N=o.useRef(null),_=Ne(N,r,v===null?null:v.setSwitch,k),C=Yl(g),[w,f]=ql(d,u,C??!1),E=pt(),[P,L]=o.useState(!1),O=X(()=>{L(!0),f==null||f(!w),E.nextFrame(()=>{L(!1)})}),I=X(pe=>{if(di(pe.currentTarget))return pe.preventDefault();pe.preventDefault(),O()}),q=X(pe=>{pe.key===Se.Space?(pe.preventDefault(),O()):pe.key===Se.Enter&&Xl(pe.currentTarget)}),se=X(pe=>pe.preventDefault()),te=Va(),S=mi(),{isFocusVisible:D,focusProps:H}=as({autoFocus:x}),{isHovered:W,hoverProps:M}=Na({isDisabled:c}),{pressed:$,pressProps:Q}=Ca({disabled:c}),G=Ie({checked:w,disabled:c,hover:W,focus:D,active:$,autofocus:x,changing:P}),me=is({id:i,ref:_,role:"switch",type:Ya(e,y),tabIndex:e.tabIndex===-1?0:(s=e.tabIndex)!=null?s:0,"aria-checked":w,"aria-labelledby":te,"aria-describedby":S,disabled:c||void 0,autoFocus:x,onClick:I,onKeyUp:q,onKeyPress:se},H,M,Q),be=o.useCallback(()=>{if(C!==void 0)return f==null?void 0:f(C)},[f,C]),Le=ve();return V.createElement(V.Fragment,null,h!=null&&V.createElement(ri,{disabled:c,data:{[h]:m||"on"},overrides:{type:"checkbox",checked:w},form:p,onReset:be}),Le({ourProps:me,theirProps:b,slot:G,defaultTag:ac,name:"Switch"}))}let lc=fe(nc),ic=sc,oc=ki,cc=Oa,dc=Object.assign(lc,{Group:ic,Label:oc,Description:cc});function uc({onFocus:e}){let[r,s]=o.useState(!0),a=fr();return r?V.createElement(xt,{as:"button",type:"button",features:mt.Focusable,onFocus:n=>{n.preventDefault();let l,i=50;function c(){if(i--<=0){l&&cancelAnimationFrame(l);return}if(e()){if(cancelAnimationFrame(l),!a.current)return;s(!1);return}l=requestAnimationFrame(c)}l=requestAnimationFrame(c)}}):null}const un=o.createContext(null);function gc(){return{groups:new Map,get(e,r){var s;let a=this.groups.get(e);a||(a=new Map,this.groups.set(e,a));let n=(s=a.get(r))!=null?s:0;a.set(r,n+1);let l=Array.from(a.keys()).indexOf(r);function i(){let c=a.get(r);c>1?a.set(r,c-1):a.delete(r)}return[l,i]}}}function mc({children:e}){let r=o.useRef(gc());return o.createElement(un.Provider,{value:r},e)}function gn(e){let r=o.useContext(un);if(!r)throw new Error("You must wrap your component in a <StableCollection>");let s=o.useId(),[a,n]=r.current.get(e,s);return o.useEffect(()=>n,[]),a}var xc=(e=>(e[e.Forwards=0]="Forwards",e[e.Backwards=1]="Backwards",e))(xc||{}),pc=(e=>(e[e.Less=-1]="Less",e[e.Equal=0]="Equal",e[e.Greater=1]="Greater",e))(pc||{}),hc=(e=>(e[e.SetSelectedIndex=0]="SetSelectedIndex",e[e.RegisterTab=1]="RegisterTab",e[e.UnregisterTab=2]="UnregisterTab",e[e.RegisterPanel=3]="RegisterPanel",e[e.UnregisterPanel=4]="UnregisterPanel",e))(hc||{});let fc={0(e,r){var s;let a=vt(e.tabs,u=>u.current),n=vt(e.panels,u=>u.current),l=a.filter(u=>{var h;return!((h=u.current)!=null&&h.hasAttribute("disabled"))}),i={...e,tabs:a,panels:n};if(r.index<0||r.index>a.length-1){let u=$e(Math.sign(r.index-e.selectedIndex),{[-1]:()=>1,0:()=>$e(Math.sign(r.index),{[-1]:()=>0,0:()=>0,1:()=>1}),1:()=>0});if(l.length===0)return i;let h=$e(u,{0:()=>a.indexOf(l[0]),1:()=>a.indexOf(l[l.length-1])});return{...i,selectedIndex:h===-1?e.selectedIndex:h}}let c=a.slice(0,r.index),d=[...a.slice(r.index),...c].find(u=>l.includes(u));if(!d)return i;let g=(s=a.indexOf(d))!=null?s:e.selectedIndex;return g===-1&&(g=e.selectedIndex),{...i,selectedIndex:g}},1(e,r){if(e.tabs.includes(r.tab))return e;let s=e.tabs[e.selectedIndex],a=vt([...e.tabs,r.tab],l=>l.current),n=e.selectedIndex;return e.info.current.isControlled||(n=a.indexOf(s),n===-1&&(n=e.selectedIndex)),{...e,tabs:a,selectedIndex:n}},2(e,r){return{...e,tabs:e.tabs.filter(s=>s!==r.tab)}},3(e,r){return e.panels.includes(r.panel)?e:{...e,panels:vt([...e.panels,r.panel],s=>s.current)}},4(e,r){return{...e,panels:e.panels.filter(s=>s!==r.panel)}}},ms=o.createContext(null);ms.displayName="TabsDataContext";function jt(e){let r=o.useContext(ms);if(r===null){let s=new Error(`<${e} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,jt),s}return r}let xs=o.createContext(null);xs.displayName="TabsActionsContext";function ps(e){let r=o.useContext(xs);if(r===null){let s=new Error(`<${e} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,ps),s}return r}function bc(e,r){return $e(r.type,fc,e,r)}let vc="div";function yc(e,r){let{defaultIndex:s=0,vertical:a=!1,manual:n=!1,onChange:l,selectedIndex:i=null,...c}=e;const d=a?"vertical":"horizontal",g=n?"manual":"auto";let u=i!==null,h=Be({isControlled:u}),m=Ne(r),[p,x]=o.useReducer(bc,{info:h,selectedIndex:i??s,tabs:[],panels:[]}),b=Ie({selectedIndex:p.selectedIndex}),v=Be(l||(()=>{})),y=Be(p.tabs),k=o.useMemo(()=>({orientation:d,activation:g,...p}),[d,g,p]),N=X(L=>(x({type:1,tab:L}),()=>x({type:2,tab:L}))),_=X(L=>(x({type:3,panel:L}),()=>x({type:4,panel:L}))),C=X(L=>{w.current!==L&&v.current(L),u||x({type:0,index:L})}),w=Be(u?e.selectedIndex:p.selectedIndex),f=o.useMemo(()=>({registerTab:N,registerPanel:_,change:C}),[]);ke(()=>{x({type:0,index:i??s})},[i]),ke(()=>{if(w.current===void 0||p.tabs.length<=0)return;let L=vt(p.tabs,O=>O.current);L.some((O,I)=>p.tabs[I]!==O)&&C(L.indexOf(p.tabs[w.current]))});let E={ref:m},P=ve();return V.createElement(mc,null,V.createElement(xs.Provider,{value:f},V.createElement(ms.Provider,{value:k},k.tabs.length<=0&&V.createElement(uc,{onFocus:()=>{var L,O;for(let I of y.current)if(((L=I.current)==null?void 0:L.tabIndex)===0)return(O=I.current)==null||O.focus(),!0;return!1}}),P({ourProps:E,theirProps:c,slot:b,defaultTag:vc,name:"Tabs"}))))}let kc="div";function jc(e,r){let{orientation:s,selectedIndex:a}=jt("Tab.List"),n=Ne(r),l=Ie({selectedIndex:a}),i=e,c={ref:n,role:"tablist","aria-orientation":s};return ve()({ourProps:c,theirProps:i,slot:l,defaultTag:kc,name:"Tabs.List"})}let wc="button";function Nc(e,r){var s,a;let n=o.useId(),{id:l=`headlessui-tabs-tab-${n}`,disabled:i=!1,autoFocus:c=!1,...d}=e,{orientation:g,activation:u,selectedIndex:h,tabs:m,panels:p}=jt("Tab"),x=ps("Tab"),b=jt("Tab"),[v,y]=o.useState(null),k=o.useRef(null),N=Ne(k,r,y);ke(()=>x.registerTab(k),[x,k]);let _=gn("tabs"),C=m.indexOf(k);C===-1&&(C=_);let w=C===h,f=X(M=>{let $=M();if($===dt.Success&&u==="auto"){let Q=ns(k.current),G=b.tabs.findIndex(me=>me.current===Q);G!==-1&&x.change(G)}return $}),E=X(M=>{let $=m.map(Q=>Q.current).filter(Boolean);if(M.key===Se.Space||M.key===Se.Enter){M.preventDefault(),M.stopPropagation(),x.change(C);return}switch(M.key){case Se.Home:case Se.PageUp:return M.preventDefault(),M.stopPropagation(),f(()=>Ae($,ye.First));case Se.End:case Se.PageDown:return M.preventDefault(),M.stopPropagation(),f(()=>Ae($,ye.Last))}if(f(()=>$e(g,{vertical(){return M.key===Se.ArrowUp?Ae($,ye.Previous|ye.WrapAround):M.key===Se.ArrowDown?Ae($,ye.Next|ye.WrapAround):dt.Error},horizontal(){return M.key===Se.ArrowLeft?Ae($,ye.Previous|ye.WrapAround):M.key===Se.ArrowRight?Ae($,ye.Next|ye.WrapAround):dt.Error}}))===dt.Success)return M.preventDefault()}),P=o.useRef(!1),L=X(()=>{var M;P.current||(P.current=!0,(M=k.current)==null||M.focus({preventScroll:!0}),x.change(C),Gt(()=>{P.current=!1}))}),O=X(M=>{M.preventDefault()}),{isFocusVisible:I,focusProps:q}=as({autoFocus:c}),{isHovered:se,hoverProps:te}=Na({isDisabled:i}),{pressed:S,pressProps:D}=Ca({disabled:i}),H=Ie({selected:w,hover:se,active:S,focus:I,autofocus:c,disabled:i}),W=is({ref:N,onKeyDown:E,onMouseDown:O,onClick:L,id:l,role:"tab",type:Ya(e,v),"aria-controls":(a=(s=p[C])==null?void 0:s.current)==null?void 0:a.id,"aria-selected":w,tabIndex:w?0:-1,disabled:i||void 0,autoFocus:c},q,te,D);return ve()({ourProps:W,theirProps:d,slot:H,defaultTag:wc,name:"Tabs.Tab"})}let Cc="div";function Sc(e,r){let{selectedIndex:s}=jt("Tab.Panels"),a=Ne(r),n=Ie({selectedIndex:s}),l=e,i={ref:a};return ve()({ourProps:i,theirProps:l,slot:n,defaultTag:Cc,name:"Tabs.Panels"})}let $c="div",_c=kt.RenderStrategy|kt.Static;function Ec(e,r){var s,a,n,l;let i=o.useId(),{id:c=`headlessui-tabs-panel-${i}`,tabIndex:d=0,...g}=e,{selectedIndex:u,tabs:h,panels:m}=jt("Tab.Panel"),p=ps("Tab.Panel"),x=o.useRef(null),b=Ne(x,r);ke(()=>p.registerPanel(x),[p,x]);let v=gn("panels"),y=m.indexOf(x);y===-1&&(y=v);let k=y===u,{isFocusVisible:N,focusProps:_}=as(),C=Ie({selected:k,focus:N}),w=is({ref:b,id:c,role:"tabpanel","aria-labelledby":(a=(s=h[y])==null?void 0:s.current)==null?void 0:a.id,tabIndex:k?d:-1},_),f=ve();return!k&&((n=g.unmount)==null||n)&&!((l=g.static)!=null&&l)?V.createElement(xt,{"aria-hidden":"true",...w}):f({ourProps:w,theirProps:g,slot:C,defaultTag:$c,features:_c,visible:k,name:"Tabs.Panel"})}let Fc=fe(Nc),Tc=fe(yc),Pc=fe(jc),Ic=fe(Sc),Lc=fe(Ec),it=Object.assign(Fc,{Group:Tc,List:Pc,Panels:Ic,Panel:Lc});const Mc={price:{label:"Price Data",columns:["ltp","chng","bid","ask"]},oi:{label:"Open Interest",columns:["oi","oichng","buildup"]},greeks:{label:"Greeks",columns:["iv","delta","gamma","theta","vega"]},volume:{label:"Volume",columns:["volume"]}},Oc={ltp:"LTP",chng:"Change",bid:"Bid",ask:"Ask",oi:"OI",oichng:"OI Chg",buildup:"Buildup",iv:"IV",delta:"Delta",gamma:"Gamma",theta:"Theta",vega:"Vega",volume:"Volume"},Rc={default:{name:"Default",icon:"âš–ï¸",desc:"Balanced view"},buyer:{name:"Buyer",icon:"ðŸ“ˆ",desc:"Premium & Greeks"},seller:{name:"Seller",icon:"ðŸ“‰",desc:"OI & Theta"},scalper:{name:"Scalper",icon:"âš¡",desc:"Quick trades"},greeks:{name:"Greeks",icon:"ðŸ”¬",desc:"All Greeks"}},sr=o.memo(({label:e,description:r,enabled:s,onChange:a,icon:n})=>t.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-100 dark:border-gray-800 last:border-0",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[n&&t.jsx(n,{className:"w-5 h-5 text-gray-400"}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e}),r&&t.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:r})]})]}),t.jsx(dc,{checked:s,onChange:a,className:`${s?"bg-blue-600":"bg-gray-200 dark:bg-gray-700"}
        relative inline-flex h-6 w-11 items-center rounded-full transition-colors`,children:t.jsx("span",{className:`${s?"translate-x-6":"translate-x-1"}
          inline-block h-4 w-4 transform rounded-full bg-white transition-transform`})})]}));sr.displayName="SettingToggle";const mn=o.memo(({label:e,value:r,onChange:s,min:a,max:n,step:l=1})=>t.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-100 dark:border-gray-800 last:border-0",children:[t.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:()=>s(Math.max(a,r-l)),className:"w-8 h-8 flex items-center justify-center rounded-lg bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600",children:"-"}),t.jsx("span",{className:"w-12 text-center font-medium",children:r}),t.jsx("button",{onClick:()=>s(Math.min(n,r+l)),className:"w-8 h-8 flex items-center justify-center rounded-lg bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600",children:"+"})]})]}));mn.displayName="NumberSetting";const xn=o.memo(({isOpen:e,onClose:r})=>{const{settings:s,toggleSortOrder:a,toggleITMHighlight:n,toggleCompactMode:l,setStrikesPerPage:i}=dr(),{visibleColumns:c,toggleColumn:d,applyPreset:g,isColumnVisible:u}=Qr(),[h,m]=o.useState(0),p=[{name:"Display",icon:Vn},{name:"Columns",icon:Cs},{name:"Presets",icon:ra}];return t.jsx(rr,{appear:!0,show:e,as:o.Fragment,children:t.jsxs(Ir,{as:"div",className:"relative z-50",onClose:r,children:[t.jsx(rr.Child,{as:o.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:t.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),t.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:t.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:t.jsx(rr.Child,{as:o.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:t.jsxs(Ir.Panel,{className:"w-full max-w-lg transform overflow-hidden rounded-2xl bg-white dark:bg-gray-900 shadow-2xl transition-all",children:[t.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:[t.jsxs(Ir.Title,{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[t.jsx(ta,{className:"w-5 h-5"}),"Table Settings"]}),t.jsx("button",{onClick:r,className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:t.jsx(wt,{className:"w-5 h-5"})})]}),t.jsxs(it.Group,{selectedIndex:h,onChange:m,children:[t.jsx(it.List,{className:"flex border-b border-gray-200 dark:border-gray-700",children:p.map(x=>t.jsxs(it,{className:({selected:b})=>`flex-1 flex items-center justify-center gap-2 py-3 text-sm font-medium transition-colors outline-none
                          ${b?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50 dark:bg-blue-900/20":"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,children:[t.jsx(x.icon,{className:"w-4 h-4"}),x.name]},x.name))}),t.jsxs(it.Panels,{className:"p-4",children:[t.jsx(it.Panel,{children:t.jsxs("div",{className:"space-y-1",children:[t.jsx(sr,{label:"Compact Mode",description:"Reduce row height for more data",enabled:s.compactMode,onChange:l,icon:Cs}),t.jsx(sr,{label:"ITM Highlight",description:"Highlight in-the-money strikes",enabled:s.highlightITM,onChange:n,icon:An}),t.jsx(sr,{label:"Descending Order",description:"Show higher strikes first",enabled:s.sortOrder==="desc",onChange:a,icon:Bn}),t.jsx(mn,{label:"Visible Strikes",value:s.strikesPerPage,onChange:i,min:11,max:51,step:2})]})}),t.jsx(it.Panel,{children:t.jsx("div",{className:"space-y-4 max-h-80 overflow-y-auto",children:Object.entries(Mc).map(([x,b])=>t.jsxs("div",{children:[t.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase mb-2",children:b.label}),t.jsx("div",{className:"grid grid-cols-2 gap-2",children:b.columns.map(v=>{const y=`ce_${v}`,k=`pe_${v}`,N=u(y),_=u(k),C=N&&_;return t.jsxs("button",{onClick:()=>{d(y),d(k)},className:`flex items-center justify-between px-3 py-2 rounded-lg border transition-colors ${C?"bg-blue-50 border-blue-300 text-blue-700 dark:bg-blue-900/30 dark:border-blue-700 dark:text-blue-300":"bg-gray-50 border-gray-200 text-gray-600 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400"}`,children:[t.jsx("span",{className:"text-sm",children:Oc[v]}),C&&t.jsx(Dn,{className:"w-4 h-4"})]},v)})})]},x))})}),t.jsx(it.Panel,{children:t.jsx("div",{className:"grid grid-cols-2 gap-3",children:Object.entries(Rc).map(([x,b])=>t.jsxs("button",{onClick:()=>{g(x),r()},className:"flex flex-col items-center p-4 rounded-xl border border-gray-200 dark:border-gray-700 hover:bg-blue-50 dark:hover:bg-blue-900/20 hover:border-blue-300 dark:hover:border-blue-700 transition-colors group",children:[t.jsx("span",{className:"text-2xl mb-2",children:b.icon}),t.jsx("span",{className:"font-medium text-gray-900 dark:text-white group-hover:text-blue-600",children:b.name}),t.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:b.desc})]},x))})})]})]})]})})})})]})})});xn.displayName="TableSettingsModal";const hs=o.memo(()=>{const[e,r]=o.useState(!1);return t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>r(!0),className:"flex items-center gap-1.5 px-2 py-1.5 rounded-lg text-xs font-medium transition-all duration-200 border bg-white text-gray-600 border-gray-200 hover:bg-gray-50 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-700 dark:hover:bg-gray-700",title:"Table Settings",children:t.jsx(ta,{className:"w-4 h-4"})}),t.jsx(xn,{isOpen:e,onClose:()=>r(!1)})]})});hs.displayName="SettingsButton";const fs=o.memo(({strikeData:e,onClose:r})=>{var f,E,P,L,O,I,q,se;if(!e)return null;const{strike:s,reversal:a,wkly_reversal:n,fut_reversal:l,rs:i,rr:c,ss:d,sr_diff:g,ce_tv:u,pe_tv:h,pcr:m,price_range:p,trading_signals:x,market_regimes:b,recommended_strategy:v,alert:y,time_decay:k,ce:N,pe:_}=e,C={low:"text-green-500 bg-green-100 dark:bg-green-900/30",medium:"text-yellow-500 bg-yellow-100 dark:bg-yellow-900/30",high:"text-red-500 bg-red-100 dark:bg-red-900/30",bullish:"text-green-500 bg-green-100 dark:bg-green-900/30",bearish:"text-red-500 bg-red-100 dark:bg-red-900/30",sideways:"text-gray-500 bg-gray-100 dark:bg-gray-900/30"},w={low:"border-gray-300 bg-gray-50 dark:border-gray-700 dark:bg-gray-800",medium:"border-yellow-300 bg-yellow-50 dark:border-yellow-700 dark:bg-yellow-900/20",high:"border-red-300 bg-red-50 dark:border-red-700 dark:bg-red-900/20"};return t.jsxs("div",{className:"bg-white dark:bg-gray-900 border-t border-gray-200 dark:border-gray-700 shadow-lg",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"text-lg font-bold text-gray-900 dark:text-white",children:["Strike ",s]}),v&&t.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300",children:v}),y&&t.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full border ${w[y.level]}`,children:y.message})]}),t.jsx("button",{onClick:r,className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:t.jsx(wt,{className:"w-5 h-5 text-gray-500"})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 p-4",children:[t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx(Ot,{className:"w-5 h-5 text-blue-500"}),t.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white",children:"Reversal Levels"})]}),t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-500",children:"Daily"}),t.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:(a==null?void 0:a.toFixed(2))||"â€”"})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-500",children:"Weekly"}),t.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:(n==null?void 0:n.toFixed(2))||"â€”"})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-500",children:"Futures"}),t.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:(l==null?void 0:l.toFixed(2))||"â€”"})]})]})]}),t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx(sa,{className:"w-5 h-5 text-yellow-500"}),t.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white",children:"Trading Signals"})]}),t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-500",children:"Entry"}),t.jsx("span",{className:"font-medium text-green-600",children:((f=x==null?void 0:x.entry)==null?void 0:f.toFixed(2))||"â€”"})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-500",children:"Stop Loss"}),t.jsx("span",{className:"font-medium text-red-600",children:((E=x==null?void 0:x.stop_loss)==null?void 0:E.toFixed(2))||"â€”"})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-500",children:"Take Profit"}),t.jsx("span",{className:"font-medium text-green-600",children:((P=x==null?void 0:x.take_profit)==null?void 0:P.toFixed(2))||"â€”"})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-500",children:"Risk:Reward"}),t.jsxs("span",{className:"font-medium text-blue-600",children:["1:",(x==null?void 0:x.risk_reward)||"â€”"]})]})]})]}),t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx(qe,{className:"w-5 h-5 text-purple-500"}),t.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white",children:"S/R Levels"})]}),t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-500",children:"Resistance"}),t.jsx("span",{className:"font-medium text-red-600",children:(i==null?void 0:i.toFixed(2))||"â€”"})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-500",children:"Support"}),t.jsx("span",{className:"font-medium text-green-600",children:(d==null?void 0:d.toFixed(2))||"â€”"})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-500",children:"Range"}),t.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:(g==null?void 0:g.toFixed(2))||"â€”"})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-500",children:"PCR"}),t.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:(m==null?void 0:m.toFixed(3))||"0.00"})]})]})]}),t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx(aa,{className:"w-5 h-5 text-cyan-500"}),t.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white",children:"Market Regime"})]}),t.jsxs("div",{className:"space-y-2",children:[b&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Volatility"}),t.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded ${C[b.volatility]}`,children:(L=b.volatility)==null?void 0:L.toUpperCase()})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Trend"}),t.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded ${C[b.trend]}`,children:(O=b.trend)==null?void 0:O.toUpperCase()})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Liquidity"}),t.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded ${C[b.liquidity]}`,children:(I=b.liquidity)==null?void 0:I.toUpperCase()})]})]}),t.jsxs("div",{className:"flex justify-between items-center pt-1 border-t border-gray-200 dark:border-gray-700",children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Time Decay"}),t.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:(k==null?void 0:k.toFixed(4))||"â€”"})]})]})]})]}),t.jsx("div",{className:"px-4 pb-4",children:t.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-red-50 dark:from-green-900/20 dark:to-red-900/20 rounded-xl p-4 flex items-center justify-between",children:[t.jsxs("div",{className:"text-center flex-1",children:[t.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"CE Time Value"}),t.jsx("div",{className:"text-lg font-bold text-green-600",children:(u==null?void 0:u.toFixed(2))||"0.00"})]}),t.jsx("div",{className:"w-px h-12 bg-gray-300 dark:bg-gray-600"}),t.jsxs("div",{className:"text-center flex-1",children:[t.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Price Range"}),t.jsxs("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[(q=p==null?void 0:p.low)==null?void 0:q.toFixed(0)," - ",(se=p==null?void 0:p.high)==null?void 0:se.toFixed(0),t.jsxs("span",{className:"text-xs text-gray-500 ml-1",children:["(",((p==null?void 0:p.confidence)*100).toFixed(0),"%)"]})]})]}),t.jsx("div",{className:"w-px h-12 bg-gray-300 dark:bg-gray-600"}),t.jsxs("div",{className:"text-center flex-1",children:[t.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"PE Time Value"}),t.jsx("div",{className:"text-lg font-bold text-red-600",children:h>.01?h==null?void 0:h.toFixed(2):"~0.00"})]})]})})]})});fs.displayName="StrikeDetailPanel";fs.propTypes={strikeData:ie.object,onClose:ie.func.isRequired};const bs=o.memo(({isOpen:e,onClose:r,strikeData:s,symbol:a})=>{const[n,l]=o.useState("overview");if(!e||!s)return null;const{strike:i,ce:c={},pe:d={}}=s,g=c.optgeeks||{},u=d.optgeeks||{},h=[{id:"overview",label:"Overview",icon:qe},{id:"greeks",label:"Greeks",icon:aa},{id:"signals",label:"Signals",icon:sa},{id:"reversals",label:"Reversals",icon:Ot},{id:"strategies",label:"Strategies",icon:Gn}],m=(c.ltp||0)+(d.ltp||0),p=c.oi&&c.oi>0?(d.oi/c.oi).toFixed(2):"â€”",x=()=>{var b,v,y,k,N,_,C;switch(n){case"overview":return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 rounded-xl p-4 border border-green-200 dark:border-green-800",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("span",{className:"text-xs font-bold text-green-700 dark:text-green-400 uppercase tracking-wider",children:["Call (",i,"CE)"]}),t.jsxs("span",{className:`px-2 py-0.5 rounded text-xs font-bold ${(c.change||c.p_chng||0)>=0?"bg-green-100 text-green-700 dark:bg-green-900/50 dark:text-green-400":"bg-red-100 text-red-700 dark:bg-red-900/50 dark:text-red-400"}`,children:[(c.change||c.p_chng||0)>=0?"+":"",(c.change||c.p_chng||0).toFixed(2)]})]}),t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"LTP"}),t.jsxs("span",{className:"font-bold text-green-700 dark:text-green-400",children:["â‚¹",((b=c.ltp)==null?void 0:b.toFixed(2))||"â€”"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"OI"}),t.jsxs("span",{className:"font-semibold",children:[((c.oi||c.OI||0)/1e5).toFixed(2),"L"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"OI Chg"}),t.jsxs("span",{className:`font-semibold ${(c.oi_chng||c.oichng||0)>=0?"text-green-600":"text-red-600"}`,children:[(c.oi_chng||c.oichng||0)>=0?"+":"",((c.oi_chng||c.oichng||0)/1e5).toFixed(2),"L"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Volume"}),t.jsxs("span",{className:"font-semibold",children:[((c.volume||c.vol||0)/1e5).toFixed(2),"L"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"IV"}),t.jsxs("span",{className:"font-semibold",children:[((v=c.iv)==null?void 0:v.toFixed(1))||"â€”","%"]})]})]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-rose-50 dark:from-red-900/20 dark:to-rose-900/20 rounded-xl p-4 border border-red-200 dark:border-red-800",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("span",{className:"text-xs font-bold text-red-700 dark:text-red-400 uppercase tracking-wider",children:["Put (",i,"PE)"]}),t.jsxs("span",{className:`px-2 py-0.5 rounded text-xs font-bold ${(d.change||d.p_chng||0)>=0?"bg-green-100 text-green-700 dark:bg-green-900/50 dark:text-green-400":"bg-red-100 text-red-700 dark:bg-red-900/50 dark:text-red-400"}`,children:[(d.change||d.p_chng||0)>=0?"+":"",(d.change||d.p_chng||0).toFixed(2)]})]}),t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"LTP"}),t.jsxs("span",{className:"font-bold text-red-700 dark:text-red-400",children:["â‚¹",((y=d.ltp)==null?void 0:y.toFixed(2))||"â€”"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"OI"}),t.jsxs("span",{className:"font-semibold",children:[((d.oi||d.OI||0)/1e5).toFixed(2),"L"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"OI Chg"}),t.jsxs("span",{className:`font-semibold ${(d.oi_chng||d.oichng||0)>=0?"text-green-600":"text-red-600"}`,children:[(d.oi_chng||d.oichng||0)>=0?"+":"",((d.oi_chng||d.oichng||0)/1e5).toFixed(2),"L"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Volume"}),t.jsxs("span",{className:"font-semibold",children:[((d.volume||d.vol||0)/1e5).toFixed(2),"L"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"IV"}),t.jsxs("span",{className:"font-semibold",children:[((k=d.iv)==null?void 0:k.toFixed(1))||"â€”","%"]})]})]})]})]}),t.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-3 text-center",children:[t.jsx("div",{className:"text-xs text-gray-500 uppercase",children:"Straddle"}),t.jsxs("div",{className:"text-lg font-bold text-purple-600",children:["â‚¹",m.toFixed(2)]})]}),t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-3 text-center",children:[t.jsx("div",{className:"text-xs text-gray-500 uppercase",children:"PCR"}),t.jsx("div",{className:`text-lg font-bold ${parseFloat(p)>1?"text-green-600":"text-red-600"}`,children:p})]}),t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-3 text-center",children:[t.jsx("div",{className:"text-xs text-gray-500 uppercase",children:"IV Skew"}),t.jsxs("div",{className:"text-lg font-bold",children:[((c.iv||0)-(d.iv||0)).toFixed(1),"%"]})]}),t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-3 text-center",children:[t.jsx("div",{className:"text-xs text-gray-500 uppercase",children:"OI Ratio"}),t.jsx("div",{className:"text-lg font-bold",children:c.oi&&d.oi?(c.oi/d.oi).toFixed(2):"â€”"})]})]})]});case"greeks":{const w=[{key:"delta",label:"Î” Delta",desc:"Price sensitivity",format:f=>(f==null?void 0:f.toFixed(4))||"â€”"},{key:"gamma",label:"Î“ Gamma",desc:"Delta sensitivity",format:f=>(f==null?void 0:f.toFixed(6))||"â€”"},{key:"theta",label:"Î˜ Theta",desc:"Time decay",format:f=>(f==null?void 0:f.toFixed(4))||"â€”"},{key:"vega",label:"Î½ Vega",desc:"Volatility sensitivity",format:f=>(f==null?void 0:f.toFixed(4))||"â€”"},{key:"rho",label:"Ï Rho",desc:"Interest rate sensitivity",format:f=>(f==null?void 0:f.toFixed(4))||"â€”"},{key:"vanna",label:"Vanna",desc:"Delta-volatility",format:f=>(f==null?void 0:f.toFixed(6))||"â€”"},{key:"charm",label:"Charm",desc:"Delta decay",format:f=>(f==null?void 0:f.toFixed(6))||"â€”"},{key:"vomma",label:"Vomma",desc:"Vega convexity",format:f=>(f==null?void 0:f.toFixed(6))||"â€”"}];return t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b border-gray-200 dark:border-gray-700",children:[t.jsx("th",{className:"text-left py-2 px-3 text-xs font-semibold text-gray-500 uppercase",children:"Greek"}),t.jsx("th",{className:"text-right py-2 px-3 text-xs font-semibold text-green-600 uppercase",children:"Call"}),t.jsx("th",{className:"text-right py-2 px-3 text-xs font-semibold text-red-600 uppercase",children:"Put"}),t.jsx("th",{className:"text-left py-2 px-3 text-xs font-semibold text-gray-500 uppercase",children:"Description"})]})}),t.jsx("tbody",{children:w.map((f,E)=>t.jsxs("tr",{className:`border-b border-gray-100 dark:border-gray-800 ${E%2===0?"bg-gray-50/50 dark:bg-gray-800/50":""}`,children:[t.jsx("td",{className:"py-2.5 px-3 font-semibold",children:f.label}),t.jsx("td",{className:"py-2.5 px-3 text-right font-mono text-green-600",children:f.format(g[f.key])}),t.jsx("td",{className:"py-2.5 px-3 text-right font-mono text-red-600",children:f.format(u[f.key])}),t.jsx("td",{className:"py-2.5 px-3 text-gray-500 text-xs",children:f.desc})]},f.key))})]})})}case"signals":{const w=Us(c),f=Us(d);return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:`rounded-xl p-4 border-2 ${w.sentiment==="bullish"?"bg-green-50 border-green-300 dark:bg-green-900/20 dark:border-green-700":w.sentiment==="bearish"?"bg-red-50 border-red-300 dark:bg-red-900/20 dark:border-red-700":"bg-gray-50 border-gray-300 dark:bg-gray-800 dark:border-gray-700"}`,children:[t.jsx("div",{className:"text-xs font-bold uppercase tracking-wider mb-2 text-green-700 dark:text-green-400",children:"Call Signal"}),t.jsx("div",{className:"text-lg font-bold mb-1",children:w.buildUp}),t.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:w.description})]}),t.jsxs("div",{className:`rounded-xl p-4 border-2 ${f.sentiment==="bullish"?"bg-green-50 border-green-300 dark:bg-green-900/20 dark:border-green-700":f.sentiment==="bearish"?"bg-red-50 border-red-300 dark:bg-red-900/20 dark:border-red-700":"bg-gray-50 border-gray-300 dark:bg-gray-800 dark:border-gray-700"}`,children:[t.jsx("div",{className:"text-xs font-bold uppercase tracking-wider mb-2 text-red-700 dark:text-red-400",children:"Put Signal"}),t.jsx("div",{className:"text-lg font-bold mb-1",children:f.buildUp}),t.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:f.description})]})]}),t.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-xl p-4 border border-blue-200 dark:border-blue-800",children:[t.jsx("div",{className:"text-xs font-bold uppercase tracking-wider mb-2 text-blue-700 dark:text-blue-400",children:"Combined Analysis"}),t.jsx("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:Vc(w,f,p)})]})]})}case"reversals":{const w=c.ltp||0,f=d.ltp||0,E=s.spot_price||s.spot||0,P=s.futures_price||s.fut_ltp||0,L=w+f,O=E+w,I=E-f,q=P>0?P:E,se=q+w,te=q-f,S=i+w,D=i-f,H=i+L,W=i-L;return s._reversalTab,t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"text-center py-2 bg-gradient-to-r from-indigo-50 via-purple-50 to-pink-50 dark:from-indigo-900/20 dark:via-purple-900/20 dark:to-pink-900/20 rounded-lg",children:[t.jsxs("h4",{className:"text-lg font-bold text-gray-900 dark:text-white",children:["Reversal For : ",i]}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Strike-Based Formula"})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[t.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-xl p-3 border border-blue-200 dark:border-blue-700",children:[t.jsx("div",{className:"text-xs font-bold text-blue-700 dark:text-blue-400 uppercase tracking-wider mb-2 flex items-center gap-1",children:"ðŸ“ SPOT"}),t.jsxs("div",{className:"space-y-1.5 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-red-600 dark:text-red-400",children:"R:"}),t.jsx("span",{className:"font-bold text-red-600",children:O.toFixed(2)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-green-600 dark:text-green-400",children:"S:"}),t.jsx("span",{className:"font-bold text-green-600",children:I.toFixed(2)})]})]})]}),t.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 rounded-xl p-3 border border-purple-200 dark:border-purple-700",children:[t.jsx("div",{className:"text-xs font-bold text-purple-700 dark:text-purple-400 uppercase tracking-wider mb-2 flex items-center gap-1",children:"ðŸ“ˆ FUTURE"}),t.jsxs("div",{className:"space-y-1.5 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-red-600 dark:text-red-400",children:"R:"}),t.jsx("span",{className:"font-bold text-red-600",children:se.toFixed(2)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-green-600 dark:text-green-400",children:"S:"}),t.jsx("span",{className:"font-bold text-green-600",children:te.toFixed(2)})]})]})]}),t.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/20 rounded-xl p-3 border border-amber-200 dark:border-amber-700",children:[t.jsx("div",{className:"text-xs font-bold text-amber-700 dark:text-amber-400 uppercase tracking-wider mb-2 flex items-center gap-1",children:"ðŸ’¹ LTP Calc"}),t.jsxs("div",{className:"space-y-1.5 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-red-600 dark:text-red-400",children:"R:"}),t.jsx("span",{className:"font-bold text-red-600",children:S.toFixed(2)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-green-600 dark:text-green-400",children:"S:"}),t.jsx("span",{className:"font-bold text-green-600",children:D.toFixed(2)})]})]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-rose-50 dark:from-red-900/20 dark:to-rose-900/20 rounded-xl p-4 border border-red-200 dark:border-red-800",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500 animate-pulse"}),t.jsx("span",{className:"text-sm font-bold text-red-700 dark:text-red-400 uppercase tracking-wider",children:"Resistance"})]}),t.jsx("div",{className:"text-3xl font-bold text-red-600 mb-2",children:O.toFixed(2)}),t.jsx("div",{className:"text-xs text-gray-500",children:"Spot + CE Premium"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 rounded-xl p-4 border border-green-200 dark:border-green-800",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),t.jsx("span",{className:"text-sm font-bold text-green-700 dark:text-green-400 uppercase tracking-wider",children:"Support"})]}),t.jsx("div",{className:"text-3xl font-bold text-green-600 mb-2",children:I.toFixed(2)}),t.jsx("div",{className:"text-xs text-gray-500",children:"Spot - PE Premium"})]})]}),t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-4",children:[t.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3",children:"Calculation Formula"}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Base (Spot)"}),t.jsx("span",{className:"font-bold",children:E.toFixed(2)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"CE Premium"}),t.jsxs("span",{className:"font-bold text-red-600",children:["â‚¹",w.toFixed(2)]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"PE Premium"}),t.jsxs("span",{className:"font-bold text-green-600",children:["â‚¹",f.toFixed(2)]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Straddle"}),t.jsxs("span",{className:"font-bold text-purple-600",children:["â‚¹",L.toFixed(2)]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Range Up"}),t.jsx("span",{className:"font-bold text-red-600",children:H.toFixed(2)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Range Down"}),t.jsx("span",{className:"font-bold text-green-600",children:W.toFixed(2)})]})]})]})]}),t.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-xl p-4 border border-blue-200 dark:border-blue-700",children:[t.jsx("div",{className:"text-xs font-semibold text-blue-600 uppercase tracking-wider mb-2",children:"Why 99% Accuracy?"}),t.jsxs("ul",{className:"text-xs text-gray-600 dark:text-gray-400 space-y-1",children:[t.jsx("li",{children:"â€¢ Option writers defend ATM straddle levels"}),t.jsx("li",{children:"â€¢ High OI creates walls of support/resistance"}),t.jsx("li",{children:"â€¢ Delta hedging by market makers reinforces levels"})]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[t.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-xl p-3 text-center",children:[t.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400 uppercase font-medium",children:"Daily Reversal"}),t.jsx("div",{className:"text-lg font-bold text-blue-700",children:((N=s.reversal)==null?void 0:N.toFixed(2))||"â€”"})]}),t.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 rounded-xl p-3 text-center",children:[t.jsx("div",{className:"text-xs text-purple-600 dark:text-purple-400 uppercase font-medium",children:"Weekly Reversal"}),t.jsx("div",{className:"text-lg font-bold text-purple-700",children:((_=s.wkly_reversal)==null?void 0:_.toFixed(2))||"â€”"})]}),t.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/20 rounded-xl p-3 text-center",children:[t.jsx("div",{className:"text-xs text-amber-600 dark:text-amber-400 uppercase font-medium",children:"Futures Reversal"}),t.jsx("div",{className:"text-lg font-bold text-amber-700",children:((C=s.fut_reversal)==null?void 0:C.toFixed(2))||"â€”"})]})]})]})}case"strategies":return t.jsx("div",{className:"space-y-4",children:t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Ac(s,m,p).map((w,f)=>t.jsxs("div",{className:`rounded-xl p-4 border-2 ${w.type==="bullish"?"bg-green-50 border-green-300 dark:bg-green-900/20 dark:border-green-700":w.type==="bearish"?"bg-red-50 border-red-300 dark:bg-red-900/20 dark:border-red-700":"bg-gray-50 border-gray-300 dark:bg-gray-800 dark:border-gray-700"}`,children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx(Hn,{className:"w-5 h-5"}),t.jsx("span",{className:"font-bold",children:w.name})]}),t.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:w.description}),t.jsxs("div",{className:"flex gap-2 flex-wrap",children:[t.jsxs("span",{className:`px-2 py-0.5 rounded text-xs ${w.risk==="Low"?"bg-green-100 text-green-700":w.risk==="Medium"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:["Risk: ",w.risk]}),t.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-blue-100 text-blue-700",children:w.maxProfit})]})]},f))})});default:return null}};return t.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto","aria-modal":"true",children:[t.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm",onClick:r}),t.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:t.jsxs("div",{className:"relative w-full max-w-4xl bg-white dark:bg-gray-900 rounded-2xl shadow-2xl overflow-hidden",children:[t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-indigo-600/20 via-purple-500/15 to-pink-500/20"}),t.jsxs("div",{className:"relative flex items-center justify-between p-4 border-b border-gray-200/50 dark:border-gray-700/50",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"p-2.5 rounded-xl bg-gradient-to-br from-indigo-500 to-purple-600 text-white shadow-lg",children:t.jsx(qe,{className:"w-6 h-6"})}),t.jsxs("div",{children:[t.jsxs("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:["Strike Analysis â€” ",a," ",i]}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:"Comprehensive analysis with Greeks, Signals & Strategies"})]})]}),t.jsx("button",{onClick:r,className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:t.jsx(wt,{className:"w-6 h-6 text-gray-500"})})]})]}),t.jsx("div",{className:"flex border-b border-gray-200 dark:border-gray-700 px-4 overflow-x-auto",children:h.map(b=>{const v=b.icon;return t.jsxs("button",{onClick:()=>l(b.id),className:`px-4 py-3 text-sm font-medium border-b-2 transition-all flex items-center gap-2 whitespace-nowrap ${n===b.id?"border-indigo-500 text-indigo-600 bg-indigo-50/50 dark:bg-indigo-900/20":"border-transparent text-gray-500 hover:text-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800"}`,children:[t.jsx(v,{className:"w-4 h-4"}),b.label]},b.id)})}),t.jsx("div",{className:"p-5 max-h-[60vh] overflow-y-auto",children:x()}),t.jsx("div",{className:"px-5 py-3 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50",children:t.jsxs("div",{className:"flex justify-between items-center text-xs text-gray-500",children:[t.jsx("span",{children:"Last updated: Just now"}),t.jsx("button",{onClick:r,className:"px-4 py-2 bg-gray-200 dark:bg-gray-700 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors font-medium",children:"Close"})]})})]})})]})});function Us(e){const r=e.oi_chng||e.oichng||0,s=e.change||e.p_chng||0;return r>0&&s>0?{buildUp:"Long Buildup",sentiment:"bullish",description:"Fresh buying with price up"}:r>0&&s<0?{buildUp:"Short Buildup",sentiment:"bearish",description:"Fresh selling with price down"}:r<0&&s>0?{buildUp:"Short Covering",sentiment:"bullish",description:"Shorts exiting, price rising"}:r<0&&s<0?{buildUp:"Long Unwinding",sentiment:"bearish",description:"Longs exiting, price falling"}:{buildUp:"Neutral",sentiment:"neutral",description:"No clear signal"}}function Vc(e,r,s){const a=parseFloat(s);let n="";return a>1.2?n="High Put writing indicates strong support at this level. ":a<.8?n="High Call writing indicates strong resistance at this level. ":n="Balanced PCR suggests consolidation zone. ",e.sentiment==="bullish"&&r.sentiment==="bullish"?n+="Both Call and Put sides show bullish signals - Strong upside expected.":e.sentiment==="bearish"&&r.sentiment==="bearish"?n+="Both sides show bearish signals - Downside risk elevated.":n+="Mixed signals - Wait for clarity before taking directional bets.",n}function Ac(e,r,s){const a=[],n=parseFloat(s)||1;return a.push({name:"Long Straddle",description:`Buy ${e.strike}CE + ${e.strike}PE for â‚¹${r.toFixed(2)}`,type:"neutral",risk:"Limited",maxProfit:"Unlimited"}),n>1.2&&a.push({name:"Bull Put Spread",description:"Sell higher strike Put, buy lower strike Put",type:"bullish",risk:"Limited",maxProfit:"Limited"}),n<.8&&a.push({name:"Bear Call Spread",description:"Sell lower strike Call, buy higher strike Call",type:"bearish",risk:"Limited",maxProfit:"Limited"}),a.push({name:"Iron Condor",description:"Sell OTM Call & Put, buy further OTM for protection",type:"neutral",risk:"Limited",maxProfit:"Limited (Premium)"}),a}bs.displayName="StrikeAnalysisModal";bs.propTypes={isOpen:ie.bool.isRequired,onClose:ie.func.isRequired,strikeData:ie.object,symbol:ie.string};const pn=o.memo(({data:e,width:r=620,height:s=220,field:a="Value"})=>{var f,E;if(!e||e.length===0)return null;const n=e.map(P=>P.value),l=Math.min(...n),i=Math.max(...n),c=i-l||1,d={top:20,right:20,bottom:35,left:55},g=r-d.left-d.right,u=s-d.top-d.bottom,h=e.map((P,L)=>{const O=d.left+L/(e.length-1)*g,I=d.top+(i-P.value)/c*u;return{x:O,y:I,data:P}}),m=h.map((P,L)=>`${L===0?"M":"L"}${P.x},${P.y}`).join(" "),p=`M${d.left},${s-d.bottom} ${h.map(P=>`L${P.x},${P.y}`).join(" ")} L${r-d.right},${s-d.bottom} Z`,x=n[0],b=n[n.length-1],v=x!==0?((b-x)/x*100).toFixed(2):0,y=b>=x,k=y?"#10B981":"#EF4444",N=`chartGrad-${Math.random().toString(36).substr(2,9)}`,_=P=>P?new Date(P).toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"}):"",C=5,w=c/(C-1);return t.jsxs("div",{className:"relative",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2 px-2",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a}),t.jsx("span",{className:`text-lg font-bold ${y?"text-emerald-500":"text-red-500"}`,children:b==null?void 0:b.toLocaleString(void 0,{maximumFractionDigits:2})})]}),t.jsxs("div",{className:`flex items-center gap-1 px-2 py-1 rounded-full text-xs font-semibold ${y?"bg-emerald-500/10 text-emerald-500":"bg-red-500/10 text-red-500"}`,children:[y?"â–²":"â–¼"," ",Math.abs(v),"%"]})]}),t.jsxs("svg",{width:r,height:s,className:"mx-auto",children:[t.jsxs("defs",{children:[t.jsxs("linearGradient",{id:N,x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[t.jsx("stop",{offset:"0%",stopColor:k,stopOpacity:"0.25"}),t.jsx("stop",{offset:"100%",stopColor:k,stopOpacity:"0.02"})]}),t.jsxs("filter",{id:"glow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[t.jsx("feGaussianBlur",{stdDeviation:"2",result:"coloredBlur"}),t.jsxs("feMerge",{children:[t.jsx("feMergeNode",{in:"coloredBlur"}),t.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),[...Array(C)].map((P,L)=>{const O=d.top+L/(C-1)*u,I=i-L*w;return t.jsxs("g",{children:[t.jsx("line",{x1:d.left,y1:O,x2:r-d.right,y2:O,stroke:"currentColor",strokeOpacity:"0.1",strokeDasharray:"4,2"}),t.jsx("text",{x:d.left-8,y:O+4,textAnchor:"end",className:"fill-gray-400 text-[10px]",children:I>=1e5?`${(I/1e5).toFixed(1)}L`:I.toFixed(0)})]},L)}),t.jsx("path",{d:p,fill:`url(#${N})`}),t.jsx("path",{d:m,fill:"none",stroke:k,strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",filter:"url(#glow)"}),h.filter((P,L)=>L%10===0||L===h.length-1).map((P,L)=>t.jsx("circle",{cx:P.x,cy:P.y,r:"3",fill:k,opacity:"0.7"},L)),t.jsx("circle",{cx:h[h.length-1].x,cy:h[h.length-1].y,r:"5",fill:k,className:"animate-pulse"}),((f=e[0])==null?void 0:f.timestamp)&&t.jsxs(t.Fragment,{children:[t.jsx("text",{x:d.left,y:s-8,textAnchor:"start",className:"fill-gray-400 text-[10px]",children:_(e[0].timestamp)}),t.jsx("text",{x:r/2,y:s-8,textAnchor:"middle",className:"fill-gray-400 text-[10px]",children:_((E=e[Math.floor(e.length/2)])==null?void 0:E.timestamp)}),t.jsx("text",{x:r-d.right,y:s-8,textAnchor:"end",className:"fill-gray-400 text-[10px]",children:_(e[e.length-1].timestamp)})]})]})]})});pn.displayName="MiniLineChart";const Bc=o.memo(({ceData:e,peData:r,dataField:s="value",width:a=600,height:n=300})=>{var k;if(!e||!r||e.length===0)return null;const l={top:20,right:30,bottom:30,left:40},i=a-l.left-l.right,c=n-l.top-l.bottom,d=N=>N[s]||0,g=[...e.map(d),...r.map(d)],u=Math.min(...g),h=Math.max(...g),m=h-u||1,p=N=>l.left+N/(e.length-1)*i,x=N=>l.top+c-(N-u)/m*c,b=N=>N.map((_,C)=>`${C===0?"M":"L"} ${p(C)} ${x(d(_))}`).join(" "),v=b(e),y=b(r);return t.jsxs("svg",{width:a,height:n,className:"overflow-visible",children:[[0,.25,.5,.75,1].map(N=>{const _=l.top+c*N;return t.jsxs("g",{children:[t.jsx("line",{x1:l.left,y1:_,x2:a-l.right,y2:_,stroke:"#334155",strokeOpacity:"0.2",strokeDasharray:"3 3"}),t.jsx("text",{x:l.left-8,y:_+4,textAnchor:"end",className:"fill-gray-400 text-[10px]",children:(h-(h-u)*N).toLocaleString(void 0,{maximumFractionDigits:0})})]},N)}),t.jsx("path",{d:v,fill:"none",stroke:"#22C55E",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),t.jsx("path",{d:y,fill:"none",stroke:"#EF4444",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),t.jsxs("g",{transform:`translate(${a-100}, 10)`,children:[t.jsx("rect",{width:"10",height:"10",fill:"#22C55E",rx:"2"}),t.jsx("text",{x:"15",y:"9",className:"text-[10px] fill-gray-500 font-medium",children:"CE"}),t.jsx("rect",{x:"40",width:"10",height:"10",fill:"#EF4444",rx:"2"}),t.jsx("text",{x:"55",y:"9",className:"text-[10px] fill-gray-500 font-medium",children:"PE"})]}),((k=e[0])==null?void 0:k.timestamp)&&t.jsxs(t.Fragment,{children:[t.jsx("text",{x:l.left,y:n-5,textAnchor:"start",className:"fill-gray-400 text-[10px]",children:new Date(e[0].timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),t.jsx("text",{x:a/2,y:n-5,textAnchor:"middle",className:"fill-gray-400 text-[10px]",children:new Date(e[Math.floor(e.length/2)].timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),t.jsx("text",{x:a-l.right,y:n-5,textAnchor:"end",className:"fill-gray-400 text-[10px]",children:new Date(e[e.length-1].timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})});Bc.displayName="ComparisonLineChart";const Xr=o.memo(({data:e,viewType:r,width:s=620,height:a=400})=>{if(!e||e.length===0)return null;const n=[...e].sort((p,x)=>p.strike-x.strike),l=n.findIndex(p=>p.is_atm),i=n.slice(Math.max(0,l-12),Math.min(n.length,l+13));if(i.length===0)return null;const c=Math.min(14,(a-50)/i.length),d=Math.max(...i.map(p=>Math.abs(p.ce_coi||p.ce_oi||0)),1),g=Math.max(...i.map(p=>Math.abs(p.pe_coi||p.pe_oi||0)),1),u=Math.max(d,g),h=s/2,m=(s-80)/2;return t.jsxs("svg",{width:s,height:a,className:"mx-auto",children:[t.jsxs("text",{x:h-m/2,y:18,textAnchor:"middle",className:"fill-green-500 text-xs font-bold",children:["CALL ",r==="coi"?"COI":"OI"]}),t.jsxs("text",{x:h+m/2,y:18,textAnchor:"middle",className:"fill-red-500 text-xs font-bold",children:["PUT ",r==="coi"?"COI":"OI"]}),i.map((p,x)=>{const b=30+x*(c+3),v=r==="coi"?p.ce_coi||0:p.ce_oi||0,y=r==="coi"?p.pe_coi||0:p.pe_oi||0,k=Math.abs(v/u)*m,N=Math.abs(y/u)*m;return t.jsxs("g",{children:[t.jsx("rect",{x:h-25-k,y:b,width:k,height:c,fill:v>0?"#22C55E":"#166534",rx:"2",opacity:"0.85"}),t.jsx("text",{x:h,y:b+c/2+4,textAnchor:"middle",className:`text-[10px] font-bold ${p.is_atm?"fill-yellow-400":"fill-gray-400"}`,children:p.strike}),t.jsx("rect",{x:h+25,y:b,width:N,height:c,fill:y>0?"#EF4444":"#991B1B",rx:"2",opacity:"0.85"}),p.is_atm&&t.jsx("rect",{x:h-20,y:b-2,width:40,height:c+4,fill:"none",stroke:"#FBBF24",strokeWidth:"1.5",rx:"4"})]},p.strike)})]})});Xr.displayName="AggregateBarChart";const hn=o.memo(({data:e,width:r=600,height:s=200})=>{if(!e||e.length===0)return null;const a=[...e].sort((x,b)=>x.strike-b.strike),n=a.findIndex(x=>x.is_atm),l=a.slice(Math.max(0,n-15),Math.min(a.length,n+16));if(l.length===0)return null;const i=l.map(x=>x.pcr_oi||0),c=Math.min(...i,.5),d=Math.max(...i,2),g=d-c||1,u={top:30,right:30,bottom:40,left:50},h=r-u.left-u.right,m=s-u.top-u.bottom,p=u.top+(d-1)/g*m;return t.jsxs("svg",{width:r,height:s,className:"mx-auto",children:[t.jsx("rect",{x:u.left,y:u.top,width:h,height:p-u.top,fill:"#22C55E",fillOpacity:"0.1"}),t.jsx("rect",{x:u.left,y:p,width:h,height:m-(p-u.top),fill:"#EF4444",fillOpacity:"0.1"}),t.jsx("line",{x1:u.left,y1:p,x2:r-u.right,y2:p,stroke:"#6B7280",strokeDasharray:"4 4"}),t.jsx("text",{x:u.left-5,y:p+4,textAnchor:"end",className:"fill-gray-400 text-[10px]",children:"1.0"}),l.map((x,b)=>{const v=u.left+b/(l.length-1)*h,y=u.top+(d-(x.pcr_oi||1))/g*m,k=(x.pcr_oi||1)>1;return t.jsxs("g",{children:[t.jsx("circle",{cx:v,cy:y,r:x.is_atm?6:4,fill:k?"#22C55E":"#EF4444"}),x.is_atm&&t.jsx("text",{x:v,y:s-10,textAnchor:"middle",className:"fill-yellow-500 text-[9px] font-bold",children:"ATM"})]},x.strike)}),t.jsxs("text",{x:r-u.right,y:u.top/2,textAnchor:"end",className:"fill-green-500 text-[10px]",children:[">"," 1.0 = Bullish"]}),t.jsxs("text",{x:r-u.right,y:u.top/2+12,textAnchor:"end",className:"fill-red-500 text-[10px]",children:["<"," 1.0 = Bearish"]})]})});hn.displayName="PCRChart";const zs=[{id:"strike",label:"Strike",icon:qe,description:"Time-series for selected strike"},{id:"coi",label:"COi",icon:Ot,description:"Change in OI across strikes"},{id:"oi",label:"Oi",icon:qe,description:"Total OI across strikes"},{id:"overall",label:"Overall",icon:qe,description:"Cumulative OI/COI view"},{id:"pcr",label:"PCR",icon:Ot,description:"Put-Call Ratio across strikes"},{id:"percentage",label:"%",icon:Ot,description:"Percentage changes"}],vs=o.memo(({isOpen:e,onClose:r,cellData:s})=>{var se,te,S;const[a,n]=o.useState("strike"),[l,i]=o.useState("oi"),[c,d]=o.useState(null),[g,u]=o.useState(null),[h,m]=o.useState(!1),[p,x]=o.useState(null),b=le(ir),v=le(or),{strike:y,side:k,field:N,value:_,fullData:C}=s||{},w=o.useCallback(async()=>{if(console.log("[CellDetailModal] fetchStrikeData called with:",{symbol:b,strike:y,side:k,selectedField:l}),!b||!y||!k){console.warn("[CellDetailModal] Missing required params:",{symbol:b,strike:y,side:k});return}m(!0),x(null);try{console.log("[CellDetailModal] Calling getStrikeTimeSeries...");const D=await Yn({symbol:b,strike:parseFloat(y),optionType:k.toUpperCase(),field:l,interval:"5m",limit:50});console.log("[CellDetailModal] API response:",D),d(D)}catch(D){console.error("[CellDetailModal] Failed to fetch time-series:",D),x(D.message||"Failed to load data"),m(!1)}},[b,y,k,l]),f=o.useCallback(async D=>{if(!(!b||!v)){m(!0),x(null);try{let H;switch(D){case"coi":case"overall":H=await Qn({symbol:b,expiry:v});break;case"oi":H=await Zn({symbol:b,expiry:v});break;case"pcr":H=await Jn({symbol:b,expiry:v});break;case"percentage":H=await Xn({symbol:b,expiry:v});break;default:return}u(Array.isArray(H)?{data:H,summary:{}}:H)}catch(H){console.error(`[CellDetailModal] Failed to fetch ${D} data:`,H),x(H.message||"Failed to load data")}finally{m(!1)}}},[b,v]);if(o.useEffect(()=>{e&&s&&(a==="strike"?(N&&["OI","oi","oichng","ltp","iv","volume"].includes(N)&&i(N==="OI"||N==="oichng"?"oi":N),w()):f(a))},[e,s,a,w,f,N]),!e||!s)return null;const E=k==="ce"?"Call":"Put",P={oi:"Open Interest",ltp:"Last Traded Price",iv:"Implied Volatility",volume:"Volume",delta:"Delta",theta:"Theta"},L=(C==null?void 0:C.ce)||{},O=(C==null?void 0:C.pe)||{},I=k==="ce"?L:O,q=()=>{var D,H,W;if(h)return t.jsx("div",{className:"h-64 flex items-center justify-center",children:t.jsx(Ss,{className:"w-8 h-8 animate-spin text-blue-500"})});if(p)return t.jsx("div",{className:"h-64 flex items-center justify-center text-red-500",children:t.jsxs("div",{className:"text-center",children:[t.jsx("p",{children:p}),t.jsx("button",{onClick:()=>a==="strike"?w():f(a),className:"mt-2 text-sm text-blue-500 hover:underline",children:"Retry"})]})});switch(a){case"strike":return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[Object.entries(P).map(([M,$])=>t.jsx("button",{onClick:()=>{i(M),w()},className:`px-3 py-1.5 rounded-lg text-xs font-medium transition-colors ${l===M?"bg-blue-100 text-blue-700 dark:bg-blue-900/50 dark:text-blue-300":"bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-400"}`,children:$},M)),t.jsx("button",{onClick:w,className:"p-1.5 rounded-lg bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700",title:"Refresh",children:t.jsx(Ss,{className:`w-4 h-4 text-gray-500 ${h?"animate-spin":""}`})})]}),t.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-4",children:(()=>{const M=Array.isArray(c)?c:(c==null?void 0:c.data)||[];return console.log("[CellDetailModal] chartData for rendering:",M==null?void 0:M.length,"items"),M&&M.length>0?t.jsx(pn,{data:M,width:600,height:200}):t.jsx("div",{className:"h-52 flex items-center justify-center text-gray-400",children:"No data available"})})()}),(c==null?void 0:c.summary)&&t.jsx("div",{className:"grid grid-cols-5 gap-2",children:["min","max","avg","current","change_from_start"].map(M=>{var $;return t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-2 text-center",children:[t.jsx("div",{className:"text-[10px] text-gray-500 uppercase",children:M==="change_from_start"?"Change":M}),t.jsxs("div",{className:`text-sm font-semibold ${M==="change_from_start"?c.summary[M]>=0?"text-green-600":"text-red-600":""}`,children:[M==="change_from_start"&&c.summary[M]>=0?"+":"",($=c.summary[M])==null?void 0:$.toLocaleString()]})]},M)})})]});case"coi":case"oi":{const M=(g==null?void 0:g.data)||[],$=(g==null?void 0:g.summary)||{};return t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-2",children:t.jsx(Xr,{data:M,viewType:a,width:620,height:400})}),t.jsxs("div",{className:"grid grid-cols-4 gap-2 text-center",children:[t.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-2",children:[t.jsx("div",{className:"text-[10px] text-green-600 uppercase",children:"Total CE"}),t.jsxs("div",{className:"text-sm font-semibold text-green-700 dark:text-green-400",children:[(($.total_ce_coi||$.total_ce_oi||0)/1e5).toFixed(2),"L"]})]}),t.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 rounded-lg p-2",children:[t.jsx("div",{className:"text-[10px] text-red-600 uppercase",children:"Total PE"}),t.jsxs("div",{className:"text-sm font-semibold text-red-700 dark:text-red-400",children:[(($.total_pe_coi||$.total_pe_oi||0)/1e5).toFixed(2),"L"]})]}),t.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-2",children:[t.jsx("div",{className:"text-[10px] text-blue-600 uppercase",children:"Net"}),t.jsxs("div",{className:"text-sm font-semibold text-blue-700 dark:text-blue-400",children:[(($.net_coi||$.net_oi||0)/1e5).toFixed(2),"L"]})]}),t.jsxs("div",{className:`rounded-lg p-2 ${$.signal==="BULLISH"?"bg-green-100 dark:bg-green-900/30":"bg-red-100 dark:bg-red-900/30"}`,children:[t.jsx("div",{className:"text-[10px] text-gray-600 uppercase",children:"Signal"}),t.jsx("div",{className:`text-sm font-bold ${$.signal==="BULLISH"?"text-green-700":"text-red-700"}`,children:$.signal||"NEUTRAL"})]})]})]})}case"overall":{const M=(g==null?void 0:g.data)||[];return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[t.jsx(Wn,{className:"w-4 h-4"}),"Showing cumulative OI changes from lowest to highest strike"]}),t.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-2",children:t.jsx(Xr,{data:M,viewType:"coi",width:620,height:400})})]})}case"pcr":{const M=(g==null?void 0:g.data)||[],$=(g==null?void 0:g.summary)||{};return t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-4",children:t.jsx(hn,{data:M,width:620,height:220})}),t.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-3 text-center",children:[t.jsx("div",{className:"text-xs text-gray-500",children:"Overall PCR (OI)"}),t.jsx("div",{className:`text-xl font-bold ${($.overall_pcr_oi||1)>1?"text-green-600":"text-red-600"}`,children:((D=$.overall_pcr_oi)==null?void 0:D.toFixed(3))||"N/A"})]}),t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-3 text-center",children:[t.jsx("div",{className:"text-xs text-gray-500",children:"Overall PCR (Vol)"}),t.jsx("div",{className:`text-xl font-bold ${($.overall_pcr_vol||1)>1?"text-green-600":"text-red-600"}`,children:((H=$.overall_pcr_vol)==null?void 0:H.toFixed(3))||"N/A"})]}),t.jsxs("div",{className:`rounded-lg p-3 text-center ${$.market_sentiment==="BULLISH"?"bg-green-100 dark:bg-green-900/30":"bg-red-100 dark:bg-red-900/30"}`,children:[t.jsx("div",{className:"text-xs text-gray-500",children:"Market Sentiment"}),t.jsx("div",{className:`text-lg font-bold ${$.market_sentiment==="BULLISH"?"text-green-700":"text-red-700"}`,children:$.market_sentiment||"NEUTRAL"})]})]})]})}case"percentage":{const M=((W=g==null?void 0:g.data)==null?void 0:W.slice(0,20))||[];return t.jsx("div",{className:"space-y-4",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-xs",children:[t.jsx("thead",{className:"bg-gray-100 dark:bg-gray-800",children:t.jsxs("tr",{children:[t.jsx("th",{className:"p-2 text-left",children:"Strike"}),t.jsx("th",{className:"p-2 text-right text-green-600",children:"CE OI %"}),t.jsx("th",{className:"p-2 text-right text-red-600",children:"PE OI %"}),t.jsx("th",{className:"p-2 text-right text-green-600",children:"CE LTP %"}),t.jsx("th",{className:"p-2 text-right text-red-600",children:"PE LTP %"})]})}),t.jsx("tbody",{children:M.map($=>t.jsxs("tr",{className:`border-b border-gray-100 dark:border-gray-800 ${$.is_atm?"bg-yellow-50 dark:bg-yellow-900/20":""}`,children:[t.jsx("td",{className:`p-2 font-medium ${$.is_atm?"text-yellow-600":""}`,children:$.strike}),t.jsxs("td",{className:`p-2 text-right ${($.ce_oi_pct||0)>=0?"text-green-600":"text-red-600"}`,children:[($.ce_oi_pct||0)>=0?"+":"",($.ce_oi_pct||0).toFixed(1),"%"]}),t.jsxs("td",{className:`p-2 text-right ${($.pe_oi_pct||0)>=0?"text-green-600":"text-red-600"}`,children:[($.pe_oi_pct||0)>=0?"+":"",($.pe_oi_pct||0).toFixed(1),"%"]}),t.jsxs("td",{className:`p-2 text-right ${($.ce_ltp_pct||0)>=0?"text-green-600":"text-red-600"}`,children:[($.ce_ltp_pct||0)>=0?"+":"",($.ce_ltp_pct||0).toFixed(1),"%"]}),t.jsxs("td",{className:`p-2 text-right ${($.pe_ltp_pct||0)>=0?"text-green-600":"text-red-600"}`,children:[($.pe_ltp_pct||0)>=0?"+":"",($.pe_ltp_pct||0).toFixed(1),"%"]})]},$.strike))})]})})})}default:return null}};return t.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto","aria-modal":"true",children:[t.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity",onClick:r}),t.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:t.jsxs("div",{className:"relative w-full max-w-3xl bg-white dark:bg-gray-900 rounded-2xl shadow-2xl transform transition-all overflow-hidden",children:[t.jsxs("div",{className:"relative overflow-hidden",children:[t.jsx("div",{className:`absolute inset-0 ${k==="ce"?"bg-gradient-to-r from-green-600/20 to-emerald-500/10":"bg-gradient-to-r from-red-600/20 to-rose-500/10"}`}),t.jsxs("div",{className:"relative flex items-center justify-between p-4 border-b border-gray-200/50 dark:border-gray-700/50",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("div",{className:`relative p-2.5 rounded-xl ${k==="ce"?"bg-green-500/20 text-green-500":"bg-red-500/20 text-red-500"}`,children:[t.jsx(qe,{className:"w-5 h-5"}),t.jsx("div",{className:`absolute inset-0 rounded-xl ${k==="ce"?"bg-green-400":"bg-red-400"} blur-md opacity-30`})]}),t.jsxs("div",{children:[t.jsxs("h3",{className:"text-lg font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[t.jsxs("span",{className:k==="ce"?"text-green-600":"text-red-600",children:[P[l]||"Data"," Pulse"]}),t.jsx("span",{className:"text-gray-400",children:"â€”"}),t.jsxs("span",{children:[b," ",y," ",E.toUpperCase()]})]}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:"5-minute time-series â€¢ Real-time updates"})]})]}),I.ltp&&t.jsxs("div",{className:"flex items-center gap-3 mr-8",children:[t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"text-xs text-gray-500",children:"LTP"}),t.jsxs("div",{className:`text-sm font-bold ${(I.change||0)>=0?"text-green-500":"text-red-500"}`,children:["â‚¹",(se=I.ltp)==null?void 0:se.toFixed(2)]})]}),t.jsxs("div",{className:`px-2 py-1 rounded text-xs font-bold ${(I.change||0)>=0?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400"}`,children:[(I.change||0)>=0?"+":"",((te=I.change)==null?void 0:te.toFixed(2))||"0.00"]})]}),t.jsx("button",{onClick:r,className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:t.jsx(wt,{className:"w-5 h-5 text-gray-500"})})]})]}),t.jsx("div",{className:"flex border-b border-gray-200 dark:border-gray-700 px-2 overflow-x-auto",children:zs.map(D=>{const H=D.icon;return t.jsxs("button",{onClick:()=>n(D.id),className:`px-3 py-2.5 text-xs font-medium border-b-2 transition-colors whitespace-nowrap flex items-center gap-1 ${a===D.id?"border-blue-500 text-blue-600 bg-blue-50 dark:bg-blue-900/20":"border-transparent text-gray-500 hover:text-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800"}`,title:D.description,children:[t.jsx(H,{className:"w-3.5 h-3.5"}),D.label]},D.id)})}),t.jsx("div",{className:"p-4",children:q()}),t.jsxs("div",{className:"px-4 py-3 border-t border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[t.jsx("span",{className:"text-xs text-gray-400",children:(S=zs.find(D=>D.id===a))==null?void 0:S.description}),t.jsx("button",{onClick:r,className:"px-4 py-2 bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors text-sm font-medium",children:"Close"})]})]})})]})});vs.displayName="CellDetailModal";vs.propTypes={isOpen:ie.bool.isRequired,onClose:ie.func.isRequired,cellData:ie.shape({strike:ie.number,side:ie.string,field:ie.string,value:ie.any,symbol:ie.string,sid:ie.number,fullData:ie.object})};const ys=o.memo(({isOpen:e,onClose:r,columnType:s,initialTab:a})=>{var C,w;const n=[{id:"coi",label:"Total COi",icon:"ðŸ“ˆ"},{id:"oi",label:"Total Oi",icon:"ðŸ“Š"},{id:"volume",label:"Total Vol",icon:"ðŸ“‰"},{id:"pcr",label:"PCR",icon:"âš–ï¸"},{id:"percent",label:"%",icon:"ðŸ“"}],l=()=>a||(s==="oi_chng"?"coi":s==="oi"?"oi":s==="volume"?"volume":"coi"),[i,c]=o.useState(l()),[d,g]=o.useState(new Date),u=o.useMemo(()=>Zs(30),[]),h=le(u),m=le(cr),p=le(Zr),x=le(ir);le(or),o.useEffect(()=>{e&&g(new Date)},[e,m]);const{chartData:b,totals:v,config:y}=o.useMemo(()=>{if(!h||!(m!=null&&m.oc))return{chartData:[],totals:{},config:{}};const f={coi:{label:"Change in OI",ceKey:"oichng",peKey:"oichng",format:I=>Math.abs(I)>=1e7?`${(I/1e7).toFixed(2)}Cr`:Math.abs(I)>=1e5?`${(I/1e5).toFixed(2)}L`:Math.abs(I)>=1e3?`${(I/1e3).toFixed(1)}K`:I.toLocaleString("en-IN"),color:{ce:"#F97316",pe:"#22C55E"},showSign:!0},oi:{label:"Open Interest",ceKey:"OI",peKey:"OI",format:I=>I>=1e7?`${(I/1e7).toFixed(2)}Cr`:I>=1e5?`${(I/1e5).toFixed(2)}L`:`${(I/1e3).toFixed(1)}K`,color:{ce:"#EF4444",pe:"#10B981"}},volume:{label:"Volume",ceKey:"volume",peKey:"volume",format:I=>I>=1e7?`${(I/1e7).toFixed(2)}Cr`:I>=1e5?`${(I/1e5).toFixed(2)}L`:`${(I/1e3).toFixed(1)}K`,color:{ce:"#EC4899",pe:"#14B8A6"}},pcr:{label:"Put-Call Ratio",ceKey:"OI",peKey:"OI",format:I=>(I==null?void 0:I.toFixed(3))||"â€”",color:{ce:"#6366F1",pe:"#8B5CF6"}},percent:{label:"OI Change %",ceKey:"oichng",peKey:"oichng",format:I=>`${I==null?void 0:I.toFixed(1)}%`,color:{ce:"#F59E0B",pe:"#84CC16"}}},E=f[i]||f.coi;let P=0,L=0;return{chartData:h.map(I=>{const q=I.toString(),se=m.oc[q]||m.oc[`${I}.000000`]||{},te=se.ce||{},S=se.pe||{};let D=te[E.ceKey]||te.oi||0,H=S[E.peKey]||S.oi||0;if(i==="percent"){const W=te.OI||te.oi||1,M=S.OI||S.oi||1,$=te.oichng||0,Q=S.oichng||0;D=$/(W-$)*100||0,H=Q/(M-Q)*100||0}return P+=Math.abs(D),L+=Math.abs(H),{strike:I,ceValue:D,peValue:H,ceOI:te.OI||te.oi||0,peOI:S.OI||S.oi||0,isATM:Math.abs(I-p)<.01}}).filter(I=>I.ceValue!==0||I.peValue!==0||i==="pcr"),totals:{ce:P,pe:L,net:L-P,pcr:P>0?L/P:0},config:E}},[h,m,p,i]),k=o.useMemo(()=>i==="pcr"?3:Math.max(...b.flatMap(f=>[Math.abs(f.ceValue),Math.abs(f.peValue)]),1),[b,i]);if(o.useEffect(()=>{c(l())},[s]),!e)return null;const _=i==="pcr"?v.pcr>1.2?{text:"BULLISH",color:"text-green-600 bg-green-100"}:v.pcr<.8?{text:"BEARISH",color:"text-red-600 bg-red-100"}:{text:"NEUTRAL",color:"text-gray-600 bg-gray-100"}:v.pe>v.ce?{text:"BULLISH",color:"text-green-600 bg-green-100"}:{text:"BEARISH",color:"text-red-600 bg-red-100"};return t.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto","aria-modal":"true",children:[t.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm",onClick:r}),t.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:t.jsxs("div",{className:"relative w-full max-w-5xl bg-white dark:bg-gray-900 rounded-2xl shadow-2xl overflow-hidden",children:[t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600/20 via-purple-500/15 to-indigo-500/20"}),t.jsxs("div",{className:"relative flex items-center justify-between p-4 border-b border-gray-200/50 dark:border-gray-700/50",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"p-2.5 rounded-xl bg-gradient-to-br from-blue-500 to-indigo-600 text-white shadow-lg",children:t.jsx(qe,{className:"w-6 h-6"})}),t.jsxs("div",{children:[t.jsxs("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:[y.label||"Aggregate Data"," â€” ",x]}),t.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:[t.jsx(Un,{className:"w-3 h-3"}),t.jsxs("span",{children:["Updated: ",d.toLocaleTimeString("en-IN")]})]})]})]}),t.jsx("div",{className:`px-3 py-1.5 rounded-full text-sm font-bold ${_.color}`,children:_.text}),t.jsx("button",{onClick:r,className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:t.jsx(wt,{className:"w-6 h-6 text-gray-500"})})]})]}),t.jsx("div",{className:"flex border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50",children:n.map(f=>t.jsxs("button",{onClick:()=>c(f.id),className:`flex-1 px-4 py-3 text-sm font-medium transition-all relative ${i===f.id?"text-blue-600 dark:text-blue-400 bg-white dark:bg-gray-900":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[t.jsx("span",{className:"mr-1.5",children:f.icon}),f.label,i===f.id&&t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600 dark:bg-blue-400"})]},f.id))}),t.jsxs("div",{className:"grid grid-cols-4 gap-4 p-4 bg-gray-50 dark:bg-gray-800/30",children:[t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsx("div",{className:"text-xs text-red-600 dark:text-red-400 font-medium mb-1",children:"Total CE"}),t.jsx("div",{className:"text-2xl font-bold text-red-600",children:y.format(v.ce)})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsx("div",{className:"text-xs text-green-600 dark:text-green-400 font-medium mb-1",children:"Total PE"}),t.jsx("div",{className:"text-2xl font-bold text-green-600",children:y.format(v.pe)})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsx("div",{className:"text-xs text-purple-600 dark:text-purple-400 font-medium mb-1",children:"Net"}),t.jsxs("div",{className:`text-2xl font-bold ${v.net>0?"text-green-600":"text-red-600"}`,children:[v.net>0?"+":"",y.format(v.net)]})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400 font-medium mb-1",children:"PCR"}),t.jsx("div",{className:`text-2xl font-bold ${v.pcr>1?"text-green-600":"text-red-600"}`,children:v.pcr.toFixed(3)})]})]}),t.jsxs("div",{className:"p-5 max-h-[50vh] overflow-y-auto",children:[i==="pcr"?t.jsx("div",{className:"space-y-1",children:b.map(f=>{const E=f.ceOI>0?f.peOI/f.ceOI:0,P=Math.min(E/3*100,100),L=E>1.2?"#22C55E":E<.8?"#EF4444":"#6B7280";return t.jsxs("div",{className:`flex items-center gap-3 py-1.5 px-2 rounded ${f.isATM?"bg-yellow-50 dark:bg-yellow-900/20 ring-1 ring-yellow-400":""}`,children:[t.jsx("div",{className:`w-20 text-sm font-bold ${f.isATM?"text-yellow-600":"text-gray-700 dark:text-gray-300"}`,children:f.strike}),t.jsx("div",{className:"flex-1 h-6 bg-gray-100 dark:bg-gray-800 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full rounded-full transition-all duration-300 flex items-center justify-end pr-2",style:{width:`${P}%`,backgroundColor:L},children:t.jsx("span",{className:"text-[10px] font-bold text-white",children:E.toFixed(2)})})}),t.jsx("div",{className:`w-16 text-xs font-medium text-right ${E>1.2?"text-green-600":E<.8?"text-red-600":"text-gray-500"}`,children:E>1.2?"Bullish":E<.8?"Bearish":"Neutral"})]},f.strike)})}):t.jsx("div",{className:"space-y-1",children:b.map(f=>{var E,P;return t.jsxs("div",{className:`flex items-center gap-2 py-1 rounded ${f.isATM?"bg-yellow-50 dark:bg-yellow-900/20 ring-1 ring-yellow-400":""}`,children:[t.jsx("div",{className:"flex-1 flex justify-end",children:t.jsxs("div",{className:"relative w-full flex items-center justify-end",children:[t.jsx("div",{className:"h-5 rounded-l transition-all duration-300",style:{width:`${Math.abs(f.ceValue)/k*100}%`,backgroundColor:((E=y.color)==null?void 0:E.ce)||"#EF4444",minWidth:f.ceValue!==0?"4px":"0"}}),Math.abs(f.ceValue)>k*.1&&t.jsxs("span",{className:"absolute right-2 text-[10px] font-bold text-white",children:[y.showSign&&f.ceValue>0?"+":"",y.format(f.ceValue)]})]})}),t.jsxs("div",{className:`w-20 text-center text-sm font-bold ${f.isATM?"text-yellow-600 dark:text-yellow-400":"text-gray-700 dark:text-gray-300"}`,children:[f.strike,f.isATM&&t.jsx("span",{className:"text-[8px] block",children:"ATM"})]}),t.jsx("div",{className:"flex-1 flex justify-start",children:t.jsxs("div",{className:"relative w-full flex items-center",children:[t.jsx("div",{className:"h-5 rounded-r transition-all duration-300",style:{width:`${Math.abs(f.peValue)/k*100}%`,backgroundColor:((P=y.color)==null?void 0:P.pe)||"#10B981",minWidth:f.peValue!==0?"4px":"0"}}),Math.abs(f.peValue)>k*.1&&t.jsxs("span",{className:"absolute left-2 text-[10px] font-bold text-white",children:[y.showSign&&f.peValue>0?"+":"",y.format(f.peValue)]})]})})]},f.strike)})}),i!=="pcr"&&t.jsxs("div",{className:"flex justify-center gap-8 mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 rounded",style:{backgroundColor:((C=y.color)==null?void 0:C.ce)||"#EF4444"}}),t.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"CALL"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 rounded",style:{backgroundColor:((w=y.color)==null?void 0:w.pe)||"#10B981"}}),t.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"PUT"})]})]})]}),t.jsx("div",{className:"px-5 py-3 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[b.length," strikes displayed"]}),t.jsx("button",{onClick:r,className:"px-4 py-2 bg-gray-200 dark:bg-gray-700 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors font-medium text-sm",children:"Close"})]})})]})})]})});ys.displayName="AggregateChartModal";ys.propTypes={isOpen:ie.bool.isRequired,onClose:ie.func.isRequired,columnType:ie.oneOf(["oi","oi_chng","volume","ltp"]),initialTab:ie.oneOf(["coi","oi","volume","pcr","percent"])};const fn=e=>{if(e==null)return"â€”";if(e===0)return"0";const r=Math.abs(e),s=e<0?"-":"";return r>=1e12?s+(r/1e12).toFixed(2)+"T":r>=1e9?s+(r/1e9).toFixed(2)+"B":r>=1e6?s+(r/1e6).toFixed(2)+"M":r>=1e3?s+(r/1e3).toFixed(1)+"K":s+r.toFixed(0)},Dc=e=>e==null?"â€”":"â‚¹"+fn(e),Ks=(e,r)=>{if(!(e!=null&&e.oc)||!r||r.length===0)return null;const s={ce:{oi:0,oiChg:0,volume:0,ltpSum:0,premiumSum:0,delta:0,gamma:0,theta:0,vega:0,iv:0,ivCount:0},pe:{oi:0,oiChg:0,volume:0,ltpSum:0,premiumSum:0,delta:0,gamma:0,theta:0,vega:0,iv:0,ivCount:0}};return r.forEach(a=>{const n=a.toString(),l=e.oc[n]||e.oc[`${a}.000000`]||{};if(l.ce){const i=l.ce;s.ce.oi+=i.OI||i.oi||0,s.ce.oiChg+=i.oichng||0,s.ce.volume+=i.volume||0,s.ce.ltpSum+=i.ltp||0,s.ce.premiumSum+=(i.ltp||0)*(i.OI||i.oi||0),i.optgeeks&&(s.ce.delta+=i.optgeeks.delta||0,s.ce.gamma+=i.optgeeks.gamma||0,s.ce.theta+=i.optgeeks.theta||0,s.ce.vega+=i.optgeeks.vega||0),i.iv>0&&(s.ce.iv+=i.iv,s.ce.ivCount++)}if(l.pe){const i=l.pe;s.pe.oi+=i.OI||i.oi||0,s.pe.oiChg+=i.oichng||0,s.pe.volume+=i.volume||0,s.pe.ltpSum+=i.ltp||0,s.pe.premiumSum+=(i.ltp||0)*(i.OI||i.oi||0),i.optgeeks&&(s.pe.delta+=i.optgeeks.delta||0,s.pe.gamma+=i.optgeeks.gamma||0,s.pe.theta+=i.optgeeks.theta||0,s.pe.vega+=i.optgeeks.vega||0),i.iv>0&&(s.pe.iv+=i.iv,s.pe.ivCount++)}}),s.ce.avgIv=s.ce.ivCount>0?s.ce.iv/s.ce.ivCount:0,s.pe.avgIv=s.pe.ivCount>0?s.pe.iv/s.pe.ivCount:0,s.pcr=s.ce.oi>0?s.pe.oi/s.ce.oi:0,s.pcrChg=s.ce.oiChg!==0?s.pe.oiChg/s.ce.oiChg:0,s.volPcr=s.ce.volume>0?s.pe.volume/s.ce.volume:0,s.netDelta=s.ce.delta+s.pe.delta,s.netGamma=s.ce.gamma+s.pe.gamma,s.netTheta=s.ce.theta+s.pe.theta,s.netVega=s.ce.vega+s.pe.vega,s},Pe=o.memo(({label:e,ceValue:r,peValue:s,netValue:a,format:n="number",highlight:l=!1})=>{const i=c=>n==="currency"?Dc(c):n==="decimal"?(c==null?void 0:c.toFixed(2))||"â€”":n==="greek"?(c==null?void 0:c.toFixed(4))||"â€”":fn(c);return t.jsxs("div",{className:`p-2 rounded-lg ${l?"bg-blue-50 dark:bg-blue-900/20":"bg-gray-50 dark:bg-gray-800/50"}`,children:[t.jsx("div",{className:"text-[10px] text-gray-500 uppercase font-medium mb-1",children:e}),t.jsxs("div",{className:"flex items-center justify-between gap-2 text-sm",children:[t.jsx("span",{className:"text-red-600 dark:text-red-400 font-medium",title:"CALLS",children:i(r)}),t.jsx("span",{className:"text-gray-400",children:"|"}),t.jsx("span",{className:"text-green-600 dark:text-green-400 font-medium",title:"PUTS",children:i(s)})]}),a!==void 0&&t.jsxs("div",{className:"text-xs text-center text-gray-600 dark:text-gray-400 mt-0.5",children:["Net: ",i(a)]})]})});Pe.displayName="MetricCard";const ar=o.memo(({value:e,label:r})=>{const s=a=>!a||a===0?"bg-gray-200 text-gray-600":a>1.2?"bg-green-200 text-green-800 dark:bg-green-900/50 dark:text-green-300":a>.8?"bg-yellow-200 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-300":"bg-red-200 text-red-800 dark:bg-red-900/50 dark:text-red-300";return t.jsxs("div",{className:"flex flex-col items-center p-2 rounded-lg bg-gray-50 dark:bg-gray-800/50",children:[t.jsx("div",{className:"text-[10px] text-gray-500 uppercase font-medium",children:r}),t.jsx("div",{className:`mt-1 px-2 py-0.5 rounded font-bold text-sm ${s(e)}`,children:e>0?e.toFixed(2):"â€”"})]})});ar.displayName="PCRBadge";const bn=o.memo(({visibleStrikes:e})=>{const[r,s]=o.useState(!1),[a,n]=o.useState("visible"),l=le(cr),i=le(Zr),c=o.useMemo(()=>l!=null&&l.oc?Object.keys(l.oc).map(m=>parseFloat(m)).filter(m=>!isNaN(m)).sort((m,p)=>m-p):[],[l]),d=o.useMemo(()=>Ks(l,e),[l,e]),g=o.useMemo(()=>Ks(l,c),[l,c]),u=a==="visible"?d:g,h=a==="visible"?(e==null?void 0:e.length)||0:c.length;return u?t.jsxs("div",{className:"mt-2 bg-white dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between px-4 py-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800/50",onClick:()=>s(!r),children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"ðŸ“Š Aggregate Summary"}),t.jsxs("span",{className:"text-xs text-gray-500",children:["(",h," strikes)"]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:"flex items-center bg-gray-100 dark:bg-gray-800 rounded-lg p-0.5",children:[t.jsxs("button",{onClick:m=>{m.stopPropagation(),n("visible")},className:`px-2 py-1 text-xs rounded-md flex items-center gap-1 transition-colors ${a==="visible"?"bg-white dark:bg-gray-700 text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:[t.jsx(ra,{className:"w-3 h-3"}),"Visible"]}),t.jsxs("button",{onClick:m=>{m.stopPropagation(),n("all")},className:`px-2 py-1 text-xs rounded-md flex items-center gap-1 transition-colors ${a==="all"?"bg-white dark:bg-gray-700 text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:[t.jsx(zn,{className:"w-3 h-3"}),"All"]})]}),r?t.jsx(Kn,{className:"w-4 h-4 text-gray-400"}):t.jsx(qn,{className:"w-4 h-4 text-gray-400"})]})]}),r&&t.jsxs("div",{className:"px-4 pb-3 border-t border-gray-100 dark:border-gray-800",children:[t.jsxs("div",{className:"grid grid-cols-3 gap-2 py-2",children:[t.jsx(ar,{value:u.pcr,label:"OI PCR"}),t.jsx(ar,{value:u.pcrChg,label:"OI Chg PCR"}),t.jsx(ar,{value:u.volPcr,label:"Vol PCR"})]}),t.jsxs("div",{className:"grid grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-2 mt-2",children:[t.jsx(Pe,{label:"Total OI",ceValue:u.ce.oi,peValue:u.pe.oi,highlight:!0}),t.jsx(Pe,{label:"OI Change",ceValue:u.ce.oiChg,peValue:u.pe.oiChg}),t.jsx(Pe,{label:"Volume",ceValue:u.ce.volume,peValue:u.pe.volume}),t.jsx(Pe,{label:"LTP Sum",ceValue:u.ce.ltpSum,peValue:u.pe.ltpSum,format:"currency"}),t.jsx(Pe,{label:"Avg IV",ceValue:u.ce.avgIv,peValue:u.pe.avgIv,format:"decimal"}),t.jsx(Pe,{label:"Net Delta",ceValue:u.ce.delta,peValue:u.pe.delta,netValue:u.netDelta,format:"greek"}),t.jsx(Pe,{label:"Net Theta",ceValue:u.ce.theta,peValue:u.pe.theta,netValue:u.netTheta,format:"greek"}),t.jsx(Pe,{label:"Net Gamma",ceValue:u.ce.gamma,peValue:u.pe.gamma,netValue:u.netGamma,format:"greek"})]}),t.jsxs("div",{className:"grid grid-cols-4 gap-2 mt-2",children:[t.jsx(Pe,{label:"Premium (CE)",ceValue:u.ce.premiumSum,peValue:null,format:"currency"}),t.jsx(Pe,{label:"Premium (PE)",ceValue:null,peValue:u.pe.premiumSum,format:"currency"}),t.jsx(Pe,{label:"Net Vega",ceValue:u.ce.vega,peValue:u.pe.vega,netValue:u.netVega,format:"greek"}),t.jsxs("div",{className:"p-2 rounded-lg bg-gray-50 dark:bg-gray-800/50",children:[t.jsx("div",{className:"text-[10px] text-gray-500 uppercase font-medium",children:"ATM Strike"}),t.jsx("div",{className:"text-sm font-bold text-blue-600 dark:text-blue-400",children:i||"â€”"})]})]})]})]}):null});bn.displayName="AggregatePanel";const Gc=({showControls:e=!0})=>{const{spotData:r,futuresData:s,data:a,isLoading:n,isInitialLoad:l,hasData:i}=la(),{settings:c,selectStrike:d}=dr(),[g,u]=o.useState(c.strikesPerPage||21),[h,m]=o.useState(null),[p,x]=o.useState(null),[b,v]=o.useState(null),[y,k]=o.useState(null),N=le(ir),_=o.useMemo(()=>Zs(g),[g]),C=le(_),w=le(Zr),f=le(cr),E=o.useMemo(()=>{if(!C||C.length===0)return[];const Q=[...C];return c.sortOrder==="asc"?Q.sort((G,me)=>G-me):Q.sort((G,me)=>me-G)},[C,c.sortOrder]),P=dl(E,f,w),L=()=>{u(Q=>Q+20)},O=o.useCallback(Q=>{m(Q)},[]),I=o.useCallback(()=>{m(null)},[]),q=o.useCallback(Q=>{x(Q),d(Q==null?void 0:Q.strike)},[d]),se=o.useCallback(()=>{x(null),d(null)},[d]),te=o.useCallback(Q=>{v(Q)},[]),S=o.useCallback(()=>{v(null)},[]),D=o.useCallback(Q=>{k(Q)},[]),H=o.useCallback(()=>{k(null)},[]),W=a==null?void 0:a.pcr,M=a==null?void 0:a.max_pain_strike,$=r==null?void 0:r.ltp;return l&&!i?t.jsx("div",{className:"flex h-96 items-center justify-center",children:t.jsx(el,{size:"xl",showLabel:!0,label:"Loading Option Chain..."})}):t.jsxs("div",{className:"w-full space-y-1",children:[e&&t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[t.jsx(ts,{}),t.jsx(ur,{spotData:r,futuresData:s,pcr:W,maxPain:M}),t.jsx("div",{className:"flex-1"}),t.jsx(hs,{})]}),t.jsxs(Qs,{className:"overflow-hidden",padding:"none",children:[t.jsxs("div",{className:"relative overflow-auto scrollbar-hide",style:{maxHeight:"calc(100vh - 100px)"},children:[t.jsx(ua,{spotData:r,futuresData:s,strikes:E,rowHeight:c.compactMode?51:80,headerHeight:28}),t.jsxs("table",{className:"w-full text-sm text-left border-collapse min-w-max",children:[t.jsx(oa,{onColumnClick:D}),t.jsxs("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-800 bg-white dark:bg-gray-900",children:[E.map(Q=>{var be,Le;const G=Q.toString(),me=((be=f==null?void 0:f.oc)==null?void 0:be[G])||((Le=f==null?void 0:f.oc)==null?void 0:Le[`${Q}.000000`])||{};return t.jsx(es,{strike:Q,data:me,atmStrike:w,spotPrice:$,onCellClick:O,onStrikeSelect:q,onStrikeClick:te,highlightData:P[Q]},Q)}),E.length===0&&!n&&t.jsx("tr",{children:t.jsx("td",{colSpan:"20",className:"p-8 text-center text-gray-500",children:"No data available for selected expiration"})})]})]})]}),t.jsxs("div",{className:"p-2 border-t border-gray-100 dark:border-gray-800 flex items-center justify-between bg-gray-50 dark:bg-gray-800/50",children:[t.jsx("span",{className:"text-xs text-gray-400",children:n&&t.jsx("span",{className:"animate-pulse text-blue-500",children:"â— Live"})}),t.jsx(ea,{variant:"ghost",onClick:L,size:"sm",children:"+ More Strikes"})]})]}),t.jsx(bn,{visibleStrikes:E}),p&&t.jsx(fs,{strikeData:p,onClose:se}),t.jsx(vs,{isOpen:!!h,onClose:I,cellData:h}),t.jsx(bs,{isOpen:!!b,onClose:S,strikeData:b,symbol:N}),t.jsx(ys,{isOpen:!!y,onClose:H,columnType:y})]})},qs=e=>new Date(e*1e3).toLocaleString("en-IN",{timeZone:"Asia/Kolkata",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}),Hc=(e,r,s)=>{var d,g,u,h,m,p,x,b,v,y,k,N,_,C,w,f,E,P,L,O,I,q,se,te;if(!e||typeof e!="object")return{support_1:null,support_2:null,support_1_1:null,support_1_2:null,support_2_1:null,support_2_2:null,resistance_1:null,resistance_2:null,resistance_1_1:null,resistance_1_2:null,resistance_2_1:null,resistance_2_2:null};const a=Object.keys(e).filter(S=>/^\d+$/.test(S)).map(Number).sort((S,D)=>S-D);if(a.length===0)return{support_1:null,support_2:null,support_1_1:null,support_1_2:null,support_2_1:null,support_2_2:null,resistance_1:null,resistance_2:null,resistance_1_1:null,resistance_1_2:null,resistance_2_1:null,resistance_2_2:null};const n=a.filter(S=>S<=r),l=a.filter(S=>S>r),i=(S,D)=>{if(!S.length)return null;const H=D(S);if(H<0||H>=S.length)return null;const W=S[H];return e[W]||null};return{support_1:(d=i(n,S=>S.length-1))==null?void 0:d.reversal,support_2:(g=i(n,S=>S.length-1))==null?void 0:g.wkly_reversal,support_1_1:(u=i(n,S=>S.length-2))==null?void 0:u.reversal,support_1_2:(h=i(n,S=>S.length-3))==null?void 0:h.reversal,support_2_1:(m=i(n,S=>S.length-2))==null?void 0:m.wkly_reversal,support_2_2:(p=i(n,S=>S.length-3))==null?void 0:p.wkly_reversal,resistance_1:(x=i(l,S=>0))==null?void 0:x.reversal,resistance_2:(b=i(l,S=>0))==null?void 0:b.wkly_reversal,resistance_1_1:(v=i(l,S=>1))==null?void 0:v.reversal,resistance_1_2:(y=i(l,S=>2))==null?void 0:y.reversal,resistance_2_1:(k=i(l,S=>1))==null?void 0:k.wkly_reversal,resistance_2_2:(N=i(l,S=>2))==null?void 0:N.wkly_reversal,support_avg:((((_=i(n,S=>S.length-1))==null?void 0:_.reversal)??0)+(((C=i(n,S=>S.length-1))==null?void 0:C.wkly_reversal)??0))/2,support_1_1_avg:((((w=i(n,S=>S.length-2))==null?void 0:w.reversal)??0)+(((f=i(n,S=>S.length-2))==null?void 0:f.wkly_reversal)??0))/2,support_1_2_avg:((((E=i(n,S=>S.length-3))==null?void 0:E.reversal)??0)+(((P=i(n,S=>S.length-3))==null?void 0:P.wkly_reversal)??0))/2,resistance_avg:((((L=i(l,S=>0))==null?void 0:L.reversal)??0)+(((O=i(l,S=>0))==null?void 0:O.wkly_reversal)??0))/2,resistance_1_1_avg:((((I=i(l,S=>1))==null?void 0:I.reversal)??0)+(((q=i(l,S=>1))==null?void 0:q.wkly_reversal)??0))/2,resistance_1_2_avg:((((se=i(l,S=>2))==null?void 0:se.reversal)??0)+(((te=i(l,S=>2))==null?void 0:te.wkly_reversal)??0))/2}},Wc=(e,r)=>{let s;return function(...n){const l=()=>{clearTimeout(s),e(...n)};clearTimeout(s),s=setTimeout(l,r)}},Ys=(e,r)=>{let s;return function(...a){s||(e.apply(this,a),s=!0,setTimeout(()=>s=!1,r))}},Uc=({symbols:e,currentSymbol:r,onSelect:s,theme:a})=>{const[n,l]=o.useState(!1),[i,c]=o.useState(""),[d,g]=o.useState(0),[u,h]=o.useState({top:0,left:0}),m=o.useRef(null),p=o.useRef(null),x=o.useRef(null),b=o.useMemo(()=>{const w=[],f=[];return e.forEach(E=>{["NIFTY","BANKNIFTY","FINNIFTY","MIDCPNIFTY","SENSEX","BANKEX","NIFTYNXT50"].includes(E.symbol)?w.push(E):f.push(E)}),{indices:w,equities:f}},[e]),v=o.useMemo(()=>{const w=i.toLowerCase();return{indices:b.indices.filter(f=>f.symbol.toLowerCase().includes(w)||(f.name||"").toLowerCase().includes(w)),equities:b.equities.filter(f=>f.symbol.toLowerCase().includes(w)||(f.name||"").toLowerCase().includes(w))}},[b,i]),y=o.useMemo(()=>[...v.indices,...v.equities],[v]),k=()=>{if(p.current){const w=p.current.getBoundingClientRect();h({top:w.bottom+8,left:w.left})}l(!0)};o.useEffect(()=>{const w=f=>{m.current&&!m.current.contains(f.target)&&l(!1)};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]),o.useEffect(()=>{n&&x.current&&x.current.focus()},[n]);const N=w=>{if(!n){(w.key==="Enter"||w.key==="ArrowDown")&&(k(),w.preventDefault());return}switch(w.key){case"ArrowDown":g(f=>Math.min(f+1,y.length-1)),w.preventDefault();break;case"ArrowUp":g(f=>Math.max(f-1,0)),w.preventDefault();break;case"Enter":y[d]&&(s(y[d]),l(!1),c("")),w.preventDefault();break;case"Escape":l(!1),c("");break}},_=w=>{s(w),l(!1),c("")},C=a==="dark";return t.jsxs("div",{ref:m,className:"relative",onKeyDown:N,children:[t.jsxs("button",{ref:p,onClick:()=>n?l(!1):k(),className:`
          flex items-center gap-2 px-3 py-1.5 rounded-lg border
          font-semibold text-xs transition-all duration-200 min-w-[120px]
          ${C?"bg-gray-800 border-gray-700 text-white hover:bg-gray-700":"bg-white border-gray-200 text-gray-900 hover:bg-gray-50"}
          ${n?C?"ring-1 ring-blue-500":"ring-1 ring-blue-400":""}
        `,children:[t.jsx("span",{className:"font-bold",children:(r==null?void 0:r.symbol)||"Select"}),t.jsx("svg",{className:`w-3 h-3 ml-auto transition-transform ${n?"rotate-180":""} ${C?"text-gray-400":"text-gray-500"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),n&&Bt.createPortal(t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"fixed inset-0 z-[2147483646]",onClick:()=>l(!1)}),t.jsxs("div",{className:`
              fixed w-72 max-h-80 rounded-xl border shadow-2xl z-[2147483647]
              overflow-hidden
              ${C?"bg-gray-900 border-gray-700":"bg-white border-gray-200"}
            `,style:{top:u.top,left:u.left},children:[t.jsx("div",{className:`p-2 border-b ${C?"border-gray-700":"border-gray-100"}`,children:t.jsxs("div",{className:"relative",children:[t.jsx("svg",{className:`absolute left-2.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 ${C?"text-gray-500":"text-gray-400"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),t.jsx("input",{ref:x,type:"text",placeholder:"Search...",value:i,onChange:w=>{c(w.target.value),g(0)},className:`
                    w-full pl-8 pr-3 py-1.5 rounded-lg text-xs
                    focus:outline-none focus:ring-1 transition-all
                    ${C?"bg-gray-800 text-white placeholder-gray-500 focus:ring-blue-500":"bg-gray-100 text-gray-900 placeholder-gray-400 focus:ring-blue-400"}
                  `})]})}),t.jsxs("div",{className:"overflow-y-auto max-h-64 p-1",children:[v.indices.length>0&&t.jsxs("div",{className:"mb-1",children:[t.jsx("div",{className:`px-2 py-1 text-[10px] font-semibold uppercase ${C?"text-blue-400":"text-blue-600"}`,children:"Indices"}),v.indices.map((w,f)=>t.jsx(Xs,{symbol:w,isSelected:(r==null?void 0:r.symbol)===w.symbol,isHighlighted:d===f,onClick:()=>_(w),isDark:C},w.symbol))]}),v.equities.length>0&&t.jsxs("div",{children:[t.jsx("div",{className:`px-2 py-1 text-[10px] font-semibold uppercase ${C?"text-emerald-400":"text-emerald-600"}`,children:"Equities"}),v.equities.map((w,f)=>t.jsx(Xs,{symbol:w,isSelected:(r==null?void 0:r.symbol)===w.symbol,isHighlighted:d===v.indices.length+f,onClick:()=>_(w),isDark:C},w.symbol))]}),y.length===0&&t.jsx("div",{className:`text-center py-4 text-xs ${C?"text-gray-500":"text-gray-400"}`,children:"No symbols found"})]})]})]}),document.getElementById("dropdown-root")||document.body)]})},Xs=({symbol:e,isSelected:r,isHighlighted:s,onClick:a,isDark:n})=>t.jsxs("button",{onClick:a,className:`
        w-full flex items-center gap-2 px-2 py-1.5 rounded-lg text-left text-xs
        transition-all duration-100
        ${r?n?"bg-blue-600 text-white":"bg-blue-500 text-white":s?n?"bg-gray-800":"bg-gray-100":n?"hover:bg-gray-800":"hover:bg-gray-50"}
      `,children:[t.jsx("div",{className:"flex-1 min-w-0",children:t.jsx("div",{className:`font-semibold ${r?"text-white":n?"text-gray-200":"text-gray-800"}`,children:e.symbol})}),r&&t.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]}),vn=V.memo(({embedded:e=!1})=>{var _t,Et;const r=Jr(),s=le(F=>F.theme.theme),a=o.useMemo(()=>({background:s==="dark"?"bg-slate-900":"bg-white",text:s==="dark"?"#e2e8f0":"#334155",gridColor:s==="dark"?"rgba(255, 255, 255, 0.06)":"rgba(0, 0, 0, 0.06)",supportColor:s==="dark"?"#38bdf8":"#0ea5e9",resistanceColor:s==="dark"?"#fbbf24":"#f59e0b",nearersupportColor:s==="dark"?"#4ade80":"#22c55e",nearerresistanceColor:s==="dark"?"#f87171":"#ef4444"}),[s]),n=o.useMemo(()=>({layout:{background:{color:s==="dark"?"#0f172a":"#ffffff"},textColor:s==="dark"?"#94a3b8":"#475569"},grid:{vertLines:{color:a.gridColor},horzLines:{color:a.gridColor}},crosshair:{mode:1},rightPriceScale:{borderColor:s==="dark"?"#1e293b":"#e2e8f0",scaleMargins:{top:.1,bottom:.1}},timeScale:{borderColor:s==="dark"?"#1e293b":"#e2e8f0",timeVisible:!0,secondsVisible:!1,rightBarStaysOnScroll:!0,barSpacing:12,fixLeftEdge:!1,fixRightEdge:!1,lockVisibleTimeRangeOnResize:!0,rightOffset:12,visible:!0}}),[s,a.gridColor]),l=o.useMemo(()=>({upColor:"#10b981",downColor:"#f43f5e",borderVisible:!1,wickUpColor:"#10b981",wickDownColor:"#f43f5e"}),[]),i=o.useRef(null),c=o.useRef(null),d=o.useRef(null),g=o.useRef(new Map),u=o.useRef(null),[h,m]=o.useState({open:0,high:0,low:0,close:0,time:""}),[p,x]=o.useState(!1),[b,v]=o.useState(!1),[y,k]=o.useState(""),[N,_]=o.useState(null),[C,w]=o.useState(!1),[f,E]=o.useState(null),[P,L]=o.useState([]),[O,I]=o.useState("reversal"),[q,se]=o.useState(!0),{symbols:te,currentSymbol:S,timeframe:D,connectionStatus:H,daily:W,weekly:M,avg:$}=le(F=>F.chart),{sid:Q}=le(F=>F.data),G=le(F=>{var T,B,Y;return(Y=(B=(T=F.data)==null?void 0:T.data)==null?void 0:B.options)==null?void 0:Y.data}),me=G==null?void 0:G.oc,be=h==null?void 0:h.close,Le=Q==="CRUDEOIL",pe=o.useMemo(()=>[{value:"15S",label:"15s"},{value:"1",label:"1min"},{value:"2",label:"2min"},{value:"3",label:"3min"},{value:"5",label:"5min"},{value:"10",label:"10min"},{value:"15",label:"15min"},{value:"30",label:"30min"},{value:"60",label:"1H"},{value:"D",label:"Daily"}],[]),Me=o.useMemo(()=>!me||!be?null:Hc(me,be),[me,be,Le]),Oe=o.useCallback(F=>{if(!d.current||!F)return;g.current.forEach(Y=>{try{d.current.removePriceLine(Y)}catch(ce){console.warn("Error removing price line:",ce)}}),g.current.clear(),((Y,ce,oe,Z)=>{const z=[{key:"support_1",title:"S1",color:Z.nearersupportColor},{key:"support_1_1",title:"S1.1",color:Z.supportColor},{key:"support_1_2",title:"S1.2",color:Z.supportColor},{key:"resistance_1",title:"R1",color:Z.nearerresistanceColor},{key:"resistance_1_1",title:"R1.1",color:Z.resistanceColor},{key:"resistance_1_2",title:"R1.2",color:Z.resistanceColor}],Ce=[{key:"support_2",title:"S2",color:Z.nearersupportColor},{key:"support_2_1",title:"S2.1",color:Z.supportColor},{key:"support_2_2",title:"S2.2",color:Z.supportColor},{key:"resistance_2",title:"R2",color:Z.nearerresistanceColor},{key:"resistance_2_1",title:"R2.1",color:Z.resistanceColor},{key:"resistance_2_2",title:"R2.2",color:Z.resistanceColor}],Re=[{key:"support_avg",title:"S-Avg",color:"#a855f7"},{key:"support_1_1_avg",title:"S1.1-Avg",color:"#c084fc"},{key:"support_1_2_avg",title:"S1.2-Avg",color:"#c084fc"},{key:"resistance_avg",title:"R-Avg",color:"#f97316"},{key:"resistance_1_1_avg",title:"R1.1-Avg",color:"#fb923c"},{key:"resistance_1_2_avg",title:"R1.2-Avg",color:"#fb923c"}];return[...Y?z:[],...ce?Ce:[],...oe?Re:[]]})(W,M,$,a).forEach(Y=>{const ce=F[Y.key];if(ce!=null&&!isNaN(parseFloat(ce)))try{const oe=Y.key.includes("support"),Z=["support_1","support_2","resistance_1","resistance_2"].includes(Y.key),z=d.current.createPriceLine({price:parseFloat(ce),color:Y.color,lineWidth:2,lineStyle:Z?$r.Solid:$r.Dashed,axisLabelVisible:!0,axisLabelBackgroundColor:oe?"#002B36":"#360000",axisLabelTextColor:"#FFFFFF",axisLabelBorderColor:Y.color,title:Y.title});g.current.set(Y.key,z)}catch(oe){console.error("Error creating price line:",oe)}})},[W,M,$,a]);o.useEffect(()=>{c.current&&c.current.applyOptions(n),d.current&&d.current.applyOptions(l)},[n,l]),o.useEffect(()=>{Me&&d.current&&H==="connected"&&Oe(Me)},[W,M,$,Me,H,Oe]),o.useEffect(()=>{if(!(!i.current||c.current))try{const F=tl(i.current,{...n,width:i.current.clientWidth,height:window.innerHeight-180,handleScroll:{mouseWheel:!0,pressedMouseMove:!0,horzTouchDrag:!0,vertTouchDrag:!0},handleScale:{axisPressedMouseMove:!0,mouseWheel:!0,pinch:!0},timeScale:{...n.timeScale},localization:{timeFormatter:oe=>new Date(oe*1e3).toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"Asia/Kolkata"}),dateFormatter:oe=>new Date(oe*1e3).toLocaleDateString("en-IN",{day:"2-digit",month:"short",timeZone:"Asia/Kolkata"})}}),T=F.addSeries(rl,l);c.current=F,d.current=T;const B=Ys(oe=>{var Z,z,Ce,Re;if(oe.time){const _e=oe.seriesData.get(T);_e&&m({open:((Z=_e.open)==null?void 0:Z.toFixed(2))||0,high:((z=_e.high)==null?void 0:z.toFixed(2))||0,low:((Ce=_e.low)==null?void 0:Ce.toFixed(2))||0,close:((Re=_e.close)==null?void 0:Re.toFixed(2))||0,time:qs(oe.time)})}},16);F.subscribeCrosshairMove(B);const Y=new ResizeObserver(oe=>{if(oe.length===0||!oe[0].target)return;const Z=oe[0].contentRect;F.applyOptions({width:Z.width,height:Z.height})});Y.observe(i.current);const ce=g.current;return()=>{Y.disconnect(),c.current&&(c.current.remove(),c.current=null,d.current=null),ce.clear()}}catch(F){console.error("Error initializing chart:",F),r(Tt("error"))}},[]);const Ct=o.useCallback(async()=>{try{const B=(await(await fetch("http://localhost:8000/api/v1/charts/symbols")).json()).data||[];r(Lr(B)),B.length>0&&!S&&r(Cr(B[0]))}catch{const F=[{symbol:"NIFTY",name:"NIFTY 50"}];r(Lr(F)),S||r(Cr(F[0]))}},[r,S]);o.useEffect(()=>{te.length===0&&Ct()},[te.length,Ct]);const St=Q||(S==null?void 0:S.symbol)||"NIFTY";o.useEffect(()=>{if(!d.current)return;const F=async()=>{var B;r(Tt("loading"));try{const Y=new URLSearchParams({symbol:St,interval:D,days:"30"}),oe=await(await fetch(`http://localhost:8000/api/v1/charts/data?${Y.toString()}`)).json();if(oe.success&&((B=oe.candles)==null?void 0:B.length)>0){const Z=oe.candles.map(z=>({time:z.time,open:z.open,high:z.high,low:z.low,close:z.close})).sort((z,Ce)=>z.time-Ce.time);if(d.current&&Z.length>0){d.current.setData(Z);const z=Z[Z.length-1];m({open:z.open.toFixed(2),high:z.high.toFixed(2),low:z.low.toFixed(2),close:z.close.toFixed(2),time:qs(z.time)}),_(z.close),r(Ln(Z)),r(Tt("connected"))}}else r(Tt("error"))}catch{r(Tt("error"))}};F();const T=setInterval(F,3e4);return()=>clearInterval(T)},[St,D,r]);const Wt=o.useCallback(F=>r(Tn(F)),[r]),Ut=o.useCallback(F=>r(Pn(F)),[r]),zt=o.useCallback(F=>r(In(F)),[r]),Kt=o.useCallback(()=>{y&&parseInt(y)>0&&(r(Sr(y)),x(!1),k(""))},[y,r]),st=o.useMemo(()=>({container:s==="dark"?"bg-gray-900 text-white":"bg-white text-gray-900",toolbar:s==="dark"?"bg-gray-800 border-gray-700":"bg-gray-100 border-gray-300",select:s==="dark"?"bg-gray-700 text-white border-gray-600":"bg-white text-gray-900 border-gray-300",button:s==="dark"?"bg-gray-700 text-gray-300 hover:bg-gray-600 hover:text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300 hover:text-gray-900",activeButton:s==="dark"?"bg-blue-600 text-white":"bg-blue-500 text-white",modal:s==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-300",input:s==="dark"?"bg-gray-700 text-white border-gray-600":"bg-white text-gray-900 border-gray-300",chart:s==="dark"?"bg-gray-900":"bg-white"}),[s]),$t={none:{title:"Select a Profile",formula:"â€”",logic:"Choose a profile from the dropdown to overlay market structure analysis on the chart.",visual:"No overlay active.",signal:"Start with 'OI' for positioning or 'Reversal' for key levels."},oi:{title:"Smart OI (Liquidity Weighted)",formula:"SmartOI = OI Ã— (1 + Volume/MaxVolume)",logic:"Open Interest weighted by today's trading activity. Strikes with high OI but zero volume (ghost positions) are dimmed. Active battles are boosted.",visual:"ðŸ”´ Red Bar = Call OI (Resistance). ðŸŸ¢ Green Bar = Put OI (Support). SINGLE BAR = >60% dominance (strong level). SPLIT BARS = contested zone (weak).",signal:"Trade: Large single-color bars are hard walls. If price approaches, fade the move. Split bars indicate indecisionâ€”wait for clarity."},volume:{title:"Smart Volume (IV Weighted)",formula:"SmartVol = Volume Ã— (IV/AvgIV)",logic:"Volume weighted by Implied Volatility. High IV trades indicate fear/greed (conviction). Low IV trades are often hedging/arbitrage (noise).",visual:"ðŸ”´ Red = Call Volume (Bearish Pressure). ðŸŸ¢ Green = Put Volume (Bullish Pressure). Taller bars = higher conviction.",signal:"Trade: Look for tall single-color bars at key levels. High conviction at resistance = potential breakout. Split bars = no clear directional bet."},oi_change:{title:"Smart Flow (Volume Weighted)",formula:"SmartFlow = OI_Change Ã— (1 + Volume/MaxVolume)",logic:"Net change in positions, weighted by volume. Separates 'real money' moves from low-volume noise. Handles unwinding (negative values) correctly.",visual:"ðŸ”´ Red = Calls building (bearish bets). ðŸŸ¢ Green = Puts building (bullish bets). Negative values (unwinding) shown with dashed borders.",signal:"Trade: Follow the flow. Growing green bars = bullish accumulation. Growing red = bearish accumulation. Shrinking bars = profit-taking/trend exhaustion."},reversal:{title:"Smart Reversal Zones",formula:"Strength = (OIÃ—0.7 + VolÃ—0.3) Ã— GammaMult Ã— IVMult",logic:"Auto-detects high-probability reversal points using weighted OI+Volume, boosted by Gamma (hedging pressure) and IV (market fear). Levels are clustered within 0.1% to reduce noise. Statistical filtering removes weak signals.",visual:"ðŸ”´ Red = Resistance Zone. ðŸŸ¢ Green = Support Zone. SOLID (Tier 1) = Statistical outlier (>1.5Ïƒ). FADED = Normal level. SINGLE BAR = >60% dominance.",signal:"Trade: At Tier 1 Red zones, look for puts/shorts. At Tier 1 Green zones, look for calls/longs. Fade the move when price touches these levels."},delta:{title:"Delta Exposure",formula:"Raw CE Delta vs PE Delta",logic:"Net directional risk at each strike. Shows how much the market moves with (+) or against (-) price movement. Uses raw delta values with dominance filtering.",visual:"ðŸ”´ Red = Call Delta (bearish-leaning). ðŸŸ¢ Green = Put Delta (bullish-leaning). SINGLE BAR = one side heavily dominant.",signal:"Trade: High delta levels indicate strong directional bias. If price goes against accumulated delta, expect violent mean reversion."},gamma:{title:"Gamma Exposure",formula:"Raw CE Gamma vs PE Gamma",logic:"Acceleration risk. High gamma = price magnet effect. Market makers must hedge aggressively as price approaches, creating pinning behavior.",visual:"ðŸ”´ Red = Call Gamma. ðŸŸ¢ Green = Put Gamma. Large bars = strong pinning zones.",signal:"Trade: High gamma strikes act as magnets. Price tends to stick here during expiry. Good for range-bound strategies (Iron Condors)."},gex:{title:"Smart Exposure (True Risk)",formula:"TrueRisk = (OI Ã— |Delta|) + (OI Ã— |Gamma| Ã— Spot Ã— 0.01)",logic:"Combined Delta + Gamma risk. Delta shows current exposure; Gamma shows acceleration if price moves 1%. This is the 'pain point' where Market Makers are most vulnerable.",visual:"ðŸ”´ Red = Call-side risk (resistance). ðŸŸ¢ Green = Put-side risk (support). SINGLE BAR = clear one-sided risk.",signal:"Trade: These are the 'breakout trigger' levels. If price crosses a large GEX bar, expect acceleration as MMs are forced to hedge."},iv_skew:{title:"Smart Skew (OI Weighted)",formula:"SmartSkew = (CE_IV - PE_IV) Ã— (StrikeOI/MaxOI)",logic:"Difference between Call IV and Put IV, weighted by liquidity (OI). Removes noise from illiquid strikes. Positive skew = calls more expensive (bearish fear). Negative = puts more expensive (bullish FOMO).",visual:"ðŸ”´ Red = Call Skew (bearish sentiment). ðŸŸ¢ Green = Put Skew (bullish sentiment). Large bars = high conviction sentiment.",signal:"Trade: Extreme skew often precedes reversals. Heavy call skew at highs = potential top. Heavy put skew at lows = potential bottom."},pcr:{title:"PCR Sentiment",formula:"PCR = PE_OI / CE_OI (normalized 0.3-3.0)",logic:"Put-Call Ratio per strike. >1 = more put writing (support). <1 = more call writing (resistance). Visualizes the bull/bear balance at each level.",visual:"ðŸ”´ Red = Bearish (PCR < 1, call-heavy). ðŸŸ¢ Green = Bullish (PCR > 1, put-heavy).",signal:"Trade: Green bars are floors (puts written = support). Red bars are ceilings. Extreme readings often mark exhaustion."},oi_strength:{title:"OI Strength (Position + Momentum)",formula:"Strength = (OI Ã— |Delta|) + (OI_Change Ã— 2)",logic:"Combines position size (OI weighted by Delta) with recent momentum (OI Change with 2x multiplier). Highlights 'heavy' strikes with fresh activity.",visual:"ðŸ”´ Red = Call strength. ðŸŸ¢ Green = Put strength. Large bars = significant positioned + active strikes.",signal:"Trade: Use for trend confirmation. Increasing strength in trend direction = healthy trend. Divergence = potential reversal."},composite:{title:"Composite Score (Master Index)",formula:"Score = OI(30%) + OI_Chng(25%) + Vol(20%) + Delta(15%) + Gamma(10%)",logic:"Weighted combination of all major metrics. OI for positioning, OI Change for flow, Volume for activity, Delta for direction, Gamma for pinning. The 'God View' metric.",visual:"ðŸ”´ Red = Bearish composite. ðŸŸ¢ Green = Bullish composite. SINGLE BAR = strong consensus. SPLIT = conflicting signals.",signal:"Trade: Use as final filter. If composite aligns with your trade direction, confidence is higher. Divergence = wait for clarity."},vega:{title:"Vega Exposure",formula:"VegaExp = OI Ã— |Vega|",logic:"Sensitivity to volatility changes. High Vega strikes will see large P&L swings when IV changes. Important before events (earnings, expiry).",visual:"ðŸ”´ Red = Call Vega. ðŸŸ¢ Green = Put Vega. Large bars = high volatility sensitivity.",signal:"Trade: Avoid buying options at high-vega strikes if you expect IV crush. Sellers can target these for premium decay."},theta:{title:"Theta Decay (Time Burn)",formula:"ThetaExp = |Theta| Ã— OI",logic:"Daily premium decay at each strike. Shows where option sellers are harvesting time value. Price often gravitates here to 'burn' premium.",visual:"ðŸ”´ Red = Call Theta decay. ðŸŸ¢ Green = Put Theta decay. Large bars = heavy time decay zones.",signal:"Trade: The 'Burn Zone'. Price often drifts toward high-theta areas during low-volatility periods. Good reference for Iron Condors."},delta_oi:{title:"Delta-Weighted OI",formula:"Î”Ã—OI = OI Ã— |Delta|",logic:"Position size weighted by probability of being ITM. Higher delta = higher probability. This shows where 'real' money exposure sits.",visual:"ðŸ”´ Red = Call exposure. ðŸŸ¢ Green = Put exposure. Large bars = significant directional bets.",signal:"Trade: These are the 'smart money' levels. Large delta-weighted OI indicates institutional positioning."}},Ge=F=>$t[F]||$t.composite,ht=o.useMemo(()=>{var at;if(!me||O==="none")return null;const F=Object.keys(me);let T=[],B=0,Y=0,ce=null,oe=0;const Z=F.map(j=>{var ge,J,K,ne,ue,he,ae,U;const ee=me[j],de=parseFloat(j),A=ee.ce||{},R=ee.pe||{};return{strikeStr:j,strike:de,ce_oi:A.OI||A.oi||0,pe_oi:R.OI||R.oi||0,ce_oi_chng:A.oichng||A.oi_change||0,pe_oi_chng:R.oichng||R.oi_change||0,ce_vol:A.volume||A.vol||0,pe_vol:R.volume||R.vol||0,ce_delta:((ge=A.optgeeks)==null?void 0:ge.delta)||A.delta||0,pe_delta:((J=R.optgeeks)==null?void 0:J.delta)||R.delta||0,ce_gamma:((K=A.optgeeks)==null?void 0:K.gamma)||A.gamma||0,pe_gamma:((ne=R.optgeeks)==null?void 0:ne.gamma)||R.gamma||0,ce_theta:((ue=A.optgeeks)==null?void 0:ue.theta)||A.theta||0,pe_theta:((he=R.optgeeks)==null?void 0:he.theta)||R.theta||0,ce_vega:((ae=A.optgeeks)==null?void 0:ae.vega)||A.vega||0,pe_vega:((U=R.optgeeks)==null?void 0:U.vega)||R.vega||0,ce_iv:A.iv||A.IV||A.impliedVolatility||0,pe_iv:R.iv||R.IV||R.impliedVolatility||0,ce_ltp:A.ltp||0,pe_ltp:R.ltp||0,reversal:ee.reversal||0,wkly_reversal:ee.wkly_reversal||0,fut_reversal:ee.fut_reversal||0}}),z=(j,ee)=>{const de=Math.abs(j),A=Math.abs(ee),R=de+A;if(R===0)return{ceVal:0,peVal:0,total:0,opacity:.5};const J=Math.max(de,A)/R>.6;let K=de,ne=A;return J&&(de>A?(K=R,ne=0):(K=0,ne=R)),{ceVal:K,peVal:ne,total:R,opacity:J?.9:.5}},Ce=be||Math.min(...Z.map(j=>j.ce_ltp+j.pe_ltp))>0?(at=Z.reduce((j,ee)=>ee.ce_ltp+ee.pe_ltp<(j==null?void 0:j.ce_ltp)+(j==null?void 0:j.pe_ltp)&&ee.ce_ltp+ee.pe_ltp>0?ee:j,Z[0]))==null?void 0:at.strike:null,Re=Math.max(...Z.map(j=>Math.max(j.ce_vol,j.pe_vol,1))),_e=Z.reduce((j,ee)=>j+ee.ce_iv+ee.pe_iv,0)/(Z.length*2||1),jr=_e>0?_e:1,wr=be||0;if(Z.forEach(j=>{let ee=0,de=0,A=0,R=null;switch(O){case"oi":{const J=j.ce_oi*(1+j.ce_vol/Re),K=j.pe_oi*(1+j.pe_vol/Re);({ceVal:ee,peVal:de,total:A,opacity:j.opacity}=z(J,K));break}case"volume":{const J=j.ce_vol*(j.ce_iv/jr),K=j.pe_vol*(j.pe_iv/jr);({ceVal:ee,peVal:de,total:A,opacity:j.opacity}=z(J,K));break}case"oi_change":{const J=j.ce_oi_chng*(1+j.ce_vol/Re),K=j.pe_oi_chng*(1+j.pe_vol/Re),{ceVal:ne,peVal:ue,total:he,opacity:ae}=z(Math.abs(J),Math.abs(K));ee=J<0?-ne:ne,de=K<0?-ue:ue,A=he,j.opacity=ae;break}case"delta":{({ceVal:ee,peVal:de,total:A,opacity:j.opacity}=z(j.ce_delta,j.pe_delta));break}case"gamma":{({ceVal:ee,peVal:de,total:A,opacity:j.opacity}=z(j.ce_gamma,j.pe_gamma));break}case"gex":{const J=j.ce_oi*Math.abs(j.ce_delta)+j.ce_oi*Math.abs(j.ce_gamma)*wr*.01,K=j.pe_oi*Math.abs(j.pe_delta)+j.pe_oi*Math.abs(j.pe_gamma)*wr*.01;({ceVal:ee,peVal:de,total:A,opacity:j.opacity}=z(J,K)),R=J-K;break}case"delta_oi":{const J=j.ce_oi*Math.abs(j.ce_delta),K=j.pe_oi*Math.abs(j.pe_delta);({ceVal:ee,peVal:de,total:A,opacity:j.opacity}=z(J,K));break}case"iv_skew":{const J=j.ce_oi+j.pe_oi,K=Math.max(...Z.map(re=>re.ce_oi+re.pe_oi))||1,ne=J/K,he=(j.ce_iv-j.pe_iv)*ne,ae=he>0?he:0,U=he<0?Math.abs(he):0;({ceVal:ee,peVal:de,total:A,opacity:j.opacity}=z(ae,U)),R=he;break}case"pcr":{const J=j.ce_oi>0?j.pe_oi/j.ce_oi:0,K=Math.min(Math.max(J,.3),3),ne=K<1?1-K:0,ue=K>1?K-1:0;({ceVal:ee,peVal:de,total:A,opacity:j.opacity}=z(ne,ue)),R=J;break}case"oi_strength":{const J=j.ce_oi*Math.abs(j.ce_delta)+j.ce_oi_chng*2,K=j.pe_oi*Math.abs(j.pe_delta)+j.pe_oi_chng*2;({ceVal:ee,peVal:de,total:A,opacity:j.opacity}=z(Math.max(0,J),Math.max(0,K)));break}case"composite":{const J=j.ce_oi,K=j.pe_oi,ne=Math.abs(j.ce_oi_chng),ue=Math.abs(j.pe_oi_chng),he=j.ce_vol,ae=j.pe_vol,U=Math.abs(j.ce_delta)*100,re=Math.abs(j.pe_delta)*100,je=j.ce_gamma*1e4,Ee=j.pe_gamma*1e4,Fe=J*.3+ne*.25+he*.2+U*.15+je*.1,we=K*.3+ue*.25+ae*.2+re*.15+Ee*.1;({ceVal:ee,peVal:de,total:A,opacity:j.opacity}=z(Fe,we));break}case"reversal":{const J=1+Math.abs(j.ce_gamma||0)*50,K=1+Math.abs(j.pe_gamma||0)*50,ne=1+(j.ce_iv||0)/100,ue=1+(j.pe_iv||0)/100,he=(j.ce_oi*.7+j.ce_vol*.3)*J*ne,ae=(j.pe_oi*.7+j.pe_vol*.3)*K*ue;[{val:parseFloat(j.reversal),label:"Intraday"},{val:parseFloat(j.wkly_reversal),label:"Weekly"},{val:parseFloat(j.fut_reversal),label:"Future"}].filter(re=>re.val&&re.val>0&&!isNaN(re.val)).forEach(re=>{const je=Ce?re.val>Ce:re.val>j.strike,Ee=je?he:ae;T.push({strike:re.val,total:Ee,ceVal:je?Ee:0,peVal:je?0:Ee,singleVal:Ee,rawCeStrength:he,rawPeStrength:ae,isResistanceRaw:je,isRawReversal:!0,reversalType:re.label,metrics:{gamma:je?j.ce_gamma:j.pe_gamma,iv:je?j.ce_iv:j.pe_iv}})});return}case"vega":({ceVal:ee,peVal:de,total:A,opacity:j.opacity}=z(j.ce_oi*Math.abs(j.ce_vega),j.pe_oi*Math.abs(j.pe_vega)));break;case"theta":({ceVal:ee,peVal:de,total:A,opacity:j.opacity}=z(Math.abs(j.ce_theta*j.ce_oi),Math.abs(j.pe_theta*j.pe_oi)));break;default:return}const ge=Math.max(Math.abs(ee),Math.abs(de));Y=Math.max(Y,ge),B+=A,A>oe&&(oe=A,ce=j.strikeStr),T.push({strike:j.strikeStr,total:A,ceVal:ee,peVal:de,singleVal:R,raw:j,opacity:j.opacity})}),O==="reversal"&&T.length>0){T.sort((R,ge)=>R.strike-ge.strike);const j=[],de=(Ce||T[0].strike)*.001;let A=null;if(T.forEach(R=>{if(!A)A={totalStrength:R.total,ceSum:R.rawCeStrength||R.ceVal,peSum:R.rawPeStrength||R.peVal,weightedSum:R.strike*R.total,points:[R]};else{const ge=A.weightedSum/A.totalStrength;Math.abs(R.strike-ge)<de?(A.totalStrength+=R.total,A.ceSum+=R.rawCeStrength||R.ceVal,A.peSum+=R.rawPeStrength||R.peVal,A.weightedSum+=R.strike*R.total,A.points.push(R)):(j.push(A),A={totalStrength:R.total,ceSum:R.rawCeStrength||R.ceVal,peSum:R.rawPeStrength||R.peVal,weightedSum:R.strike*R.total,points:[R]})}}),A&&j.push(A),j.length>0){const R=j.map(U=>U.totalStrength),ge=Math.max(...R),J=R.reduce((U,re)=>U+re,0)/R.length,K=R.reduce((U,re)=>U+Math.pow(re-J,2),0)/R.length,ne=Math.sqrt(K),ue=G==null?void 0:G.meta;let he;q&&(ue!=null&&ue.recommended_threshold)?he=ue.recommended_threshold:he=Math.max(ge*.05,J*.5);const ae=j.filter(U=>U.totalStrength>he);Ce&&Ce>100||T[0].strike,T=ae.map(U=>{const re=U.weightedSum/U.totalStrength,je=U.ceSum>=U.peSum,Fe=Math.max(U.ceSum,U.peSum)/U.totalStrength>.6;let we;q&&(ue!=null&&ue.std_dev)?we=U.totalStrength>ue.noise_floor+2*ue.std_dev:we=U.totalStrength>J+1.5*ne||U.totalStrength>ge*.8,Fe||(we=!1);const Nr=we?1:Fe?.65:.4;return{strike:re,total:U.totalStrength,ceVal:Fe?je?U.totalStrength:0:U.ceSum,peVal:Fe?je?0:U.totalStrength:U.peSum,singleVal:U.totalStrength,isCluster:!0,clusterCount:U.points.length,confidenceTier:we?1:2,opacity:Nr,isDominant:Fe}})}else T=[];if(T.length>0){Y=Math.max(...T.map(ge=>ge.total)),B=T.reduce((ge,J)=>ge+J.total,0);const R=T.reduce((ge,J)=>J.total>ge.total?J:ge,T[0]);ce=R.strike.toString(),oe=R.total}}if(Y===0)return null;const qt=[...T].sort((j,ee)=>ee.total-j.total),Yt=B*.7;let Ft=0;const ft=new Set;for(const j of qt)if(Ft+=j.total,ft.add(j.strike),Ft>=Yt)break;return{dataPoints:T,maxVal:Y,pocStrike:ce,vaStrikes:ft,meta:{oi:{name:"Smart OI (Liquidity)",ceLabel:"CE Liq",peLabel:"PE Liq"},volume:{name:"Smart Volume (Conviction)",ceLabel:"CE Conv",peLabel:"PE Conv"},oi_change:{name:"Smart Flow (Vol. Wgt)",ceLabel:"CE Flow",peLabel:"PE Flow",showSign:!0},delta:{name:"Delta",ceLabel:"CE Î”",peLabel:"PE Î”"},gamma:{name:"Gamma",ceLabel:"CE Î“",peLabel:"PE Î“"},gex:{name:"Smart Exposure (Risk)",ceLabel:"CE Risk",peLabel:"PE Risk",showNet:!0},delta_oi:{name:"Delta-Weighted OI",ceLabel:"CE Î”Ã—OI",peLabel:"PE Î”Ã—OI"},iv_skew:{name:"Smart Skew (OI Wgt)",ceLabel:"CE IVâ†‘",peLabel:"PE IVâ†‘",showNet:!0},pcr:{name:"PCR Sentiment",ceLabel:"Bearish",peLabel:"Bullish",showRatio:!0},oi_strength:{name:"OI Strength",ceLabel:"CE Str",peLabel:"PE Str"},composite:{name:"Composite",ceLabel:"CE Score",peLabel:"PE Score"},reversal:{name:"Reversal Zones",ceLabel:"Resist. Str",peLabel:"Support Str"},vega:{name:"Vega Exposure",ceLabel:"CE Vega",peLabel:"PE Vega"},theta:{name:"Theta Decay",ceLabel:"CE Î˜",peLabel:"PE Î˜"}}[O]}},[me,O,be]);return o.useEffect(()=>{const F=u.current;if(!F||!c.current||!d.current||!ht){F&&F.getContext("2d").clearRect(0,0,F.width,F.height);return}const T=F.getContext("2d",{alpha:!0}),B=d.current,{dataPoints:Y,maxVal:ce,pocStrike:oe,vaStrikes:Z}=ht;let z=null,Ce=0;const Re=16,_e=ft=>{if(ft-Ce<Re){z=requestAnimationFrame(_e);return}if(Ce=ft,!F||!B)return;const He=F.parentElement.getBoundingClientRect(),at=window.devicePixelRatio||1,j=Math.floor(He.width*at),ee=Math.floor(He.height*at);(F.width!==j||F.height!==ee)&&(F.width=j,F.height=ee,F.style.width=`${He.width}px`,F.style.height=`${He.height}px`),T.setTransform(at,0,0,at,0,0),T.clearRect(0,0,He.width,He.height);const de=65,A=He.width-de,R=(He.width-de)*.4,ge=5,J=1,K={r:239,g:68,b:68},ne={r:34,g:197,b:94},ue="#FACC15";T.lineCap="round",T.lineJoin="round";const he=[];Y.forEach(ae=>{const U=parseFloat(ae.strike),re=B.priceToCoordinate(U);if(re===null||re<0||re>He.height)return;const je=Z.has(ae.strike),Ee=ae.strike===oe,Fe=Math.abs(ae.ceVal)/ce*R,we=Math.abs(ae.peVal)/ce*R;he.push({y:re,ceWidth:Fe,peWidth:we,isVA:je,isPOC:Ee,ceUnwinding:O==="oi_change"&&ae.ceVal<0,peUnwinding:O==="oi_change"&&ae.peVal<0,customColor:ae.color,opacity:ae.opacity})}),he.forEach(({y:ae,ceWidth:U,peWidth:re,isVA:je,ceUnwinding:Ee,peUnwinding:Fe,customColor:we,opacity:Nr})=>{const ks=je?.6:.25,js={opacity:Nr};if(U>.5){const nt=js.opacity||ks;if(we)T.fillStyle=we;else if(Ee)T.fillStyle=`rgba(${K.r}, ${K.g}, ${K.b}, ${nt*.4})`;else{const lt=T.createLinearGradient(A-U,0,A,0);lt.addColorStop(0,`rgba(${K.r}, ${K.g}, ${K.b}, ${nt*.3})`),lt.addColorStop(1,`rgba(${K.r}, ${K.g}, ${K.b}, ${nt})`),T.fillStyle=lt}T.beginPath(),T.roundRect(A-U,ae-ge-J,U,ge,2),T.fill()}if(re>.5){const nt=js.opacity||ks;if(we)T.fillStyle=we;else if(Fe)T.fillStyle=`rgba(${ne.r}, ${ne.g}, ${ne.b}, ${nt*.4})`;else{const lt=T.createLinearGradient(A-re,0,A,0);lt.addColorStop(0,`rgba(${ne.r}, ${ne.g}, ${ne.b}, ${nt*.3})`),lt.addColorStop(1,`rgba(${ne.r}, ${ne.g}, ${ne.b}, ${nt})`),T.fillStyle=lt}T.beginPath(),T.roundRect(A-re,ae+J,re,ge,2),T.fill()}}),T.lineWidth=1,he.forEach(({y:ae,ceWidth:U,peWidth:re,isVA:je,ceUnwinding:Ee,peUnwinding:Fe})=>{const we=je?.8:.4;Ee&&U>.5&&(T.strokeStyle=`rgba(${K.r}, ${K.g}, ${K.b}, ${we})`,T.beginPath(),T.roundRect(A-U,ae-ge-J,U,ge,2),T.stroke()),Fe&&re>.5&&(T.strokeStyle=`rgba(${ne.r}, ${ne.g}, ${ne.b}, ${we})`,T.beginPath(),T.roundRect(A-re,ae+J,re,ge,2),T.stroke())}),T.lineWidth=2,T.strokeStyle=ue,T.shadowColor=ue,T.shadowBlur=6,he.filter(ae=>ae.isPOC).forEach(({y:ae,ceWidth:U,peWidth:re})=>{T.beginPath(),T.moveTo(A-Math.max(U,re)-10,ae),T.lineTo(A+5,ae),T.stroke(),T.shadowBlur=0,T.font="bold 10px Inter, system-ui, sans-serif",T.fillStyle=ue,T.textAlign="right",T.fillText("POC",A-Math.max(U,re)-14,ae+3)}),T.shadowBlur=0};(()=>{z=requestAnimationFrame(_e)})();const qt=c.current.timeScale(),Yt=Ys(()=>{z&&cancelAnimationFrame(z),z=requestAnimationFrame(_e)},32);qt.subscribeVisibleLogicalRangeChange(Yt);const Ft=new ResizeObserver(Wc(()=>{z&&cancelAnimationFrame(z),z=requestAnimationFrame(_e)},100));return F.parentElement&&Ft.observe(F.parentElement),()=>{z&&cancelAnimationFrame(z),qt.unsubscribeVisibleLogicalRangeChange(Yt),Ft.disconnect()}},[ht,O]),o.useEffect(()=>{if(!c.current||!d.current)return;const F=c.current,T=B=>{if(f!=="hline"||!B.point)return;const Y=d.current,ce=Y.coordinateToPrice(B.point.y);if(ce!==null){const oe=Y.createPriceLine({price:ce,color:s==="dark"?"#60a5fa":"#2563eb",lineWidth:2,lineStyle:$r.Solid,axisLabelVisible:!0,title:"Level",draggable:!0});L(Z=>[...Z,oe])}};return F.subscribeClick(T),()=>{F.unsubscribeClick(T)}},[f,s]),t.jsxs("div",{className:`${e?"h-full":"h-screen"} font-sans flex flex-col relative ${st.container} ${C?"fixed inset-0 z-50 bg-inherit":""}`,children:[t.jsxs("div",{className:`absolute ${e?"top-12":"top-20"} left-4 z-10 px-3 py-1 rounded-md shadow-sm border text-xs flex flex-wrap items-center gap-x-3 gap-y-1 ${s==="dark"?"bg-gray-800/90 border-gray-700 text-gray-300":"bg-white/90 border-gray-200 text-gray-700"}`,children:[t.jsxs("span",{className:"font-semibold",children:[(S==null?void 0:S.symbol)||"Loading..."," (",((_t=pe.find(F=>F.value===D))==null?void 0:_t.label)||D,")"]}),N&&t.jsx("span",{className:`font-semibold ${s==="dark"?"text-green-400":"text-green-600"}`,children:N.toFixed(2)}),t.jsxs("span",{children:["O: ",t.jsx("span",{className:s==="dark"?"text-white":"text-gray-900",children:h.open})]}),t.jsxs("span",{children:["H: ",t.jsx("span",{className:s==="dark"?"text-green-400":"text-green-600",children:h.high})]}),t.jsxs("span",{children:["L: ",t.jsx("span",{className:s==="dark"?"text-red-400":"text-red-600",children:h.low})]}),t.jsxs("span",{children:["C: ",t.jsx("span",{className:s==="dark"?"text-white":"text-gray-900",children:h.close})]}),h.time&&t.jsxs("span",{className:"text-[10px] opacity-70 ml-1",children:["(",h.time," IST)"]})]}),p&&t.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center z-20",children:t.jsxs("div",{className:`p-6 rounded-lg border ${st.modal}`,children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Custom Timeframe"}),t.jsxs("div",{className:"flex gap-2 mb-4",children:[t.jsx("input",{type:"number",placeholder:"Enter minutes",value:y,onChange:F=>k(F.target.value),className:`px-3 py-2 rounded border focus:outline-none focus:ring-2 focus:ring-blue-500 ${st.input}`}),t.jsx("span",{className:`self-center ${s==="dark"?"text-gray-400":"text-gray-600"}`,children:"minutes"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:Kt,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition-colors",children:"Apply"}),t.jsx("button",{onClick:()=>{x(!1),k("")},className:`px-4 py-2 rounded transition-colors ${s==="dark"?"bg-gray-600 text-white hover:bg-gray-700":"bg-gray-300 text-gray-700 hover:bg-gray-400"}`,children:"Cancel"})]})]})}),t.jsxs("div",{className:`relative z-[100] flex items-center gap-1.5 px-2 py-1.5 border-b backdrop-blur-sm ${s==="dark"?"bg-gray-900/95 border-gray-800":"bg-white/95 border-gray-200"}`,children:[!e&&t.jsxs("div",{className:"flex items-center gap-2 pr-2 border-r border-gray-700/30",children:[t.jsx(Uc,{symbols:te,currentSymbol:S,onSelect:F=>r(Cr(F)),theme:s}),N&&t.jsx("span",{className:`text-sm font-bold tabular-nums ${s==="dark"?"text-emerald-400":"text-emerald-600"}`,children:N.toFixed(2)})]}),t.jsxs("div",{className:"flex items-center gap-0.5 px-1",children:[pe.slice(0,6).map(F=>t.jsx("button",{onClick:()=>r(Sr(F.value)),className:`px-2 py-1 text-[11px] font-medium rounded transition-all ${D===F.value?s==="dark"?"bg-blue-600 text-white":"bg-blue-500 text-white":s==="dark"?"text-gray-400 hover:text-white hover:bg-gray-800":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"}`,children:F.label},F.value)),t.jsxs("div",{className:"relative",children:[t.jsx("button",{onClick:()=>v(!b),className:`px-2 py-1 text-[11px] font-medium rounded transition-all ${pe.slice(6).some(F=>F.value===D)?s==="dark"?"bg-blue-600 text-white":"bg-blue-500 text-white":s==="dark"?"text-gray-400 hover:text-white hover:bg-gray-800":"text-gray-500 hover:text-gray-900 hover:bg-gray-100"}`,children:pe.slice(6).some(F=>F.value===D)?(Et=pe.find(F=>F.value===D))==null?void 0:Et.label:"+"}),b&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"fixed inset-0 z-[2147483646]",onClick:()=>v(!1)}),t.jsxs("div",{className:`absolute top-full right-0 mt-1 py-1 rounded-lg shadow-xl border z-[2147483647] min-w-[100px] ${s==="dark"?"bg-gray-900 border-gray-700":"bg-white border-gray-200"}`,children:[pe.slice(6).map(F=>t.jsx("button",{onClick:()=>{r(Sr(F.value)),v(!1)},className:`block w-full px-3 py-1.5 text-xs text-left whitespace-nowrap ${D===F.value?s==="dark"?"bg-blue-600 text-white":"bg-blue-500 text-white":s==="dark"?"text-gray-300 hover:bg-gray-800":"text-gray-700 hover:bg-gray-100"}`,children:F.label},F.value)),t.jsx("div",{className:`border-t my-1 ${s==="dark"?"border-gray-700":"border-gray-200"}`}),t.jsx("button",{onClick:()=>{x(!0),v(!1)},className:`block w-full px-3 py-1.5 text-xs text-left ${s==="dark"?"text-gray-400 hover:bg-gray-800":"text-gray-500 hover:bg-gray-100"}`,children:"Custom..."})]})]})]})]}),t.jsx("div",{className:`w-px h-5 ${s==="dark"?"bg-gray-700":"bg-gray-300"}`}),t.jsxs("div",{className:`flex items-center rounded-md overflow-hidden border ${s==="dark"?"border-gray-700 bg-gray-800/50":"border-gray-200 bg-gray-50"}`,children:[t.jsx("button",{onClick:()=>Wt(!W),className:`px-2 py-1 text-[10px] font-semibold transition-all ${W?"bg-blue-500 text-white":s==="dark"?"text-gray-400 hover:text-white":"text-gray-500 hover:text-gray-900"}`,title:"Daily S/R",children:"D"}),t.jsx("button",{onClick:()=>Ut(!M),className:`px-2 py-1 text-[10px] font-semibold transition-all border-l ${M?"bg-emerald-500 text-white":s==="dark"?"text-gray-400 hover:text-white border-gray-700":"text-gray-500 hover:text-gray-900 border-gray-200"}`,title:"Weekly S/R",children:"W"}),t.jsx("button",{onClick:()=>zt(!$),className:`px-2 py-1 text-[10px] font-semibold transition-all border-l ${$?"bg-purple-500 text-white":s==="dark"?"text-gray-400 hover:text-white border-gray-700":"text-gray-500 hover:text-gray-900 border-gray-200"}`,title:"Average S/R",children:"A"})]}),t.jsx("button",{onClick:()=>E(f==="hline"?null:"hline"),className:`p-1.5 rounded transition-all ${f==="hline"?"bg-blue-500 text-white":s==="dark"?"text-gray-400 hover:text-white hover:bg-gray-800":"text-gray-500 hover:text-gray-900 hover:bg-gray-100"}`,title:"Draw Line",children:t.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 12h16"})})}),t.jsx("div",{className:`w-px h-5 ${s==="dark"?"bg-gray-700":"bg-gray-300"}`}),t.jsxs("select",{className:`text-[11px] font-medium px-2 py-1 rounded border-0 outline-none cursor-pointer ${s==="dark"?"bg-gray-800 text-gray-300 focus:ring-1 focus:ring-blue-500":"bg-gray-100 text-gray-700 focus:ring-1 focus:ring-blue-500"}`,value:O,onChange:F=>I(F.target.value),children:[t.jsx("option",{value:"none",children:"Profile"}),t.jsx("option",{value:"oi",children:"OI"}),t.jsx("option",{value:"oi_change",children:"OI Î”"}),t.jsx("option",{value:"volume",children:"Vol"}),t.jsx("option",{value:"delta",children:"Delta"}),t.jsx("option",{value:"gamma",children:"Gamma"}),t.jsx("option",{value:"gex",children:"GEX"}),t.jsx("option",{value:"delta_oi",children:"Î”Ã—OI"}),t.jsx("option",{value:"composite",children:"Comp"}),t.jsx("option",{value:"pcr",children:"PCR"}),t.jsx("option",{value:"iv_skew",children:"IV Skew"}),t.jsx("option",{value:"vega",children:"Vega"}),t.jsx("option",{value:"theta",children:"Theta"}),t.jsx("option",{value:"reversal",children:"Reversal"})]}),O!=="none"&&t.jsxs("div",{className:"relative group ml-1.5 flex items-center",children:[t.jsx("div",{className:`cursor-help p-1 rounded-full border transition-colors ${s==="dark"?"border-gray-700 hover:border-blue-500 text-gray-400 hover:text-blue-400":"border-gray-200 hover:border-blue-500 text-gray-500 hover:text-blue-600"}`,children:t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),t.jsxs("div",{className:`absolute top-full left-0 mt-2 w-80 p-3 rounded-lg border shadow-xl backdrop-blur-xl z-[200] opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 ${s==="dark"?"bg-gray-900/95 border-gray-700 text-gray-200":"bg-white/95 border-blue-100 text-gray-800"}`,children:[t.jsx("div",{className:`absolute -top-1.5 left-2 w-3 h-3 rotate-45 border-l border-t ${s==="dark"?"bg-gray-900 border-gray-700":"bg-white border-blue-100"}`}),t.jsxs("div",{className:"relative z-10 flex flex-col gap-2.5",children:[t.jsxs("div",{className:"flex items-center gap-1.5 border-b pb-2 border-dashed border-opacity-30 border-gray-500",children:[t.jsx("span",{className:"text-base",children:"ðŸ’¡"}),t.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider text-blue-500",children:Ge(O).title})]}),Ge(O).formula&&t.jsxs("div",{className:`p-1.5 rounded font-mono text-[9px] ${s==="dark"?"bg-gray-800 text-green-400":"bg-gray-100 text-green-700"}`,children:[t.jsx("span",{className:"opacity-50 mr-1",children:"Æ’"})," ",Ge(O).formula]}),t.jsxs("div",{children:[t.jsx("span",{className:`text-[8px] uppercase font-bold block mb-0.5 ${s==="dark"?"text-gray-500":"text-gray-400"}`,children:"Logic"}),t.jsx("p",{className:"text-[10px] leading-snug opacity-90",children:Ge(O).logic})]}),Ge(O).visual&&t.jsxs("div",{className:`p-1.5 rounded border-l-2 ${s==="dark"?"bg-gray-800/50 border-yellow-500/50":"bg-yellow-50 border-yellow-400"}`,children:[t.jsx("span",{className:`text-[8px] uppercase font-bold block mb-0.5 ${s==="dark"?"text-yellow-500/70":"text-yellow-600"}`,children:"Visual Guide"}),t.jsx("p",{className:`text-[9px] leading-snug ${s==="dark"?"text-yellow-200/80":"text-yellow-800"}`,children:Ge(O).visual})]}),t.jsxs("div",{className:`p-1.5 rounded border-l-2 ${s==="dark"?"bg-blue-500/10 border-blue-500":"bg-blue-50 border-blue-500"}`,children:[t.jsx("span",{className:`text-[8px] uppercase font-bold block mb-0.5 ${s==="dark"?"text-blue-400/70":"text-blue-600"}`,children:"Trade Signal"}),t.jsx("p",{className:"text-[9px] font-medium leading-snug text-blue-500",children:Ge(O).signal})]})]})]})]}),O==="reversal"&&t.jsxs("button",{onClick:()=>se(!q),className:`ml-2 px-2 py-1 flex items-center gap-1.5 text-[10px] font-bold rounded border transition-all ${q?"bg-gradient-to-r from-indigo-500 to-purple-600 text-white border-transparent shadow-sm":s==="dark"?"bg-gray-800 text-gray-400 border-gray-700":"bg-white text-gray-500 border-gray-200"}`,title:"Auto-Detect Thresholds based on Market Context",children:[t.jsx("span",{children:"âœ¨ Auto"}),q&&(G==null?void 0:G.meta)&&t.jsx("span",{className:"bg-white/20 px-1 rounded text-[9px] font-mono",children:G.meta.recommended_threshold>0?Math.round(G.meta.recommended_threshold):"60"})]}),t.jsx("div",{className:"flex-grow"}),t.jsxs("div",{className:"flex items-center gap-0.5",children:[t.jsx("button",{onClick:()=>{if(c.current){const F=c.current.timeScale(),T=F.getVisibleLogicalRange();T&&F.setVisibleLogicalRange({from:T.from+(T.to-T.from)*.1,to:T.to-(T.to-T.from)*.1})}},className:`p-1.5 rounded transition-all ${s==="dark"?"text-gray-400 hover:text-white hover:bg-gray-800":"text-gray-500 hover:text-gray-900 hover:bg-gray-100"}`,title:"Zoom In",children:t.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v12M6 12h12"})})}),t.jsx("button",{onClick:()=>{if(c.current){const F=c.current.timeScale(),T=F.getVisibleLogicalRange();T&&F.setVisibleLogicalRange({from:T.from-(T.to-T.from)*.1,to:T.to+(T.to-T.from)*.1})}},className:`p-1.5 rounded transition-all ${s==="dark"?"text-gray-400 hover:text-white hover:bg-gray-800":"text-gray-500 hover:text-gray-900 hover:bg-gray-100"}`,title:"Zoom Out",children:t.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),t.jsx("button",{onClick:()=>{c.current&&c.current.timeScale().fitContent()},className:`p-1.5 rounded transition-all ${s==="dark"?"text-gray-400 hover:text-white hover:bg-gray-800":"text-gray-500 hover:text-gray-900 hover:bg-gray-100"}`,title:"Fit All",children:t.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})}),t.jsx("div",{className:`w-px h-4 mx-1 ${s==="dark"?"bg-gray-700":"bg-gray-300"}`}),t.jsx("button",{onClick:()=>{var T,B,Y,ce;const F=(B=(T=i.current)==null?void 0:T.parentElement)==null?void 0:B.parentElement;document.fullscreenElement?((ce=document.exitFullscreen)==null||ce.call(document),w(!1)):((Y=F==null?void 0:F.requestFullscreen)==null||Y.call(F),w(!0))},className:`p-1.5 rounded transition-all ${s==="dark"?"text-gray-400 hover:text-white hover:bg-gray-800":"text-gray-500 hover:text-gray-900 hover:bg-gray-100"}`,title:C?"Exit Fullscreen":"Fullscreen",children:t.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:C?t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 9V4.5M9 9H4.5M9 9L3.75 3.75M9 15v4.5M9 15H4.5M9 15l-5.25 5.25M15 9h4.5M15 9V4.5M15 9l5.25-5.25M15 15h4.5M15 15v4.5m0-4.5l5.25 5.25"}):t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15"})})}),t.jsx("div",{className:`w-2 h-2 rounded-full ml-1 ${H==="connected"?"bg-emerald-500":H==="loading"?"bg-amber-500 animate-pulse":"bg-red-500"}`,title:H})]})]}),t.jsxs("div",{className:"relative w-full flex-grow",style:{height:C?"100vh":e?"calc(100vh - 120px)":"calc(100vh - 100px)"},children:[t.jsx("div",{ref:i,className:`w-full h-full ${st.chart}`}),t.jsx("canvas",{ref:u,className:"absolute top-0 left-0 pointer-events-none z-20"})]})]})});vn.displayName="TradingChart";const nd=()=>{const e=le(Mn),r=On(),[s,a]=o.useState(!1);le(g=>g.theme.theme);const{spotData:n,futuresData:l,data:i}=la(),c=i==null?void 0:i.pcr,d=i==null?void 0:i.max_pain_strike;return e?t.jsxs(t.Fragment,{children:[t.jsxs(Rn,{children:[t.jsxs("title",{children:[s?"Chart":"Option Chain"," | Stockify"]}),t.jsx("meta",{name:"description",content:"Real-time NSE Option Chain with advanced Greeks and analysis"})]}),t.jsx(gl,{children:t.jsx(sl,{children:t.jsxs("div",{className:"w-full px-2 py-2 space-y-2",children:[t.jsxs("div",{className:"flex flex-wrap items-center gap-2 p-2 glass rounded-xl",children:[t.jsx(ts,{showChart:s,onToggleChart:()=>a(!s)}),t.jsx(ur,{spotData:n,futuresData:l,pcr:c,maxPain:d}),t.jsx("div",{className:"flex-1"}),!s&&t.jsx(hs,{})]}),s?t.jsx(Qs,{variant:"glass",className:"overflow-hidden",padding:"none",children:t.jsx(vn,{embedded:!0})}):t.jsx("div",{className:"glass-strong rounded-2xl overflow-hidden animate-fade-in",children:t.jsx(Gc,{showControls:!1})})]})})})]}):t.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[60vh] gap-4",children:[t.jsx("h2",{className:"text-2xl font-bold dark:text-white",children:"Authentication Required"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Please log in to view real-time option chain data."}),t.jsx(ea,{onClick:()=>r("/login"),children:"Login Now"})]})};export{nd as default};
//# sourceMappingURL=OptionChain-DCcHyxlZ.js.map
