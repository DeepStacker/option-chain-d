import{r as v,j as e}from"./animations-CCQynVHD.js";import{u as w,e as X}from"./redux-CHwIDTp6.js";import{P as $,a as L,F as M,Q as Z,R as ee,S as te,T as W,U,V as se,W as ae,b as re,o as le,t as ie,y as de,H as D}from"./index-DUqnRfh4.js";import{a as F,a7 as ne,x as Y,W as O,F as V,b as ce,C as B,m as T,i as K,a8 as oe,a9 as xe,aa as I,ab as G,l as me,ac as he,ad as pe,h as ge,a5 as be}from"./icons-1ld_-Ybk.js";import"./network-htDwveLI.js";import"./firebase-UuSzqDeJ.js";const H=()=>{const n=w($),b=w(L),c=w(M),u=w(Z),o=w(ee),m=w(te),j=w(W),[k,h]=v.useState(null),[t,l]=v.useState(null),r=i=>{if(!i||i===0)return"0";const y=Math.abs(i),N=i<0?"-":"";return y>=1e12?N+(y/1e12).toFixed(2)+"T":y>=1e9?N+(y/1e9).toFixed(2)+"B":y>=1e6?N+(y/1e6).toFixed(2)+"M":y>=1e3?N+(y/1e3).toFixed(1)+"K":N+y.toFixed(0)},d=v.useMemo(()=>n?Object.entries(n).map(([i,y])=>{const N=y.ce||{},C=y.pe||{},E=N.OI||N.oi||0,P=C.OI||C.oi||0,S=N.oichng||N.oi_change||0,A=C.oichng||C.oi_change||0,z=E>0?P/E:0,q=S!==0?Math.abs(A/S):0,Q=N.reversal||0,J=C.reversal||0;return{strike:parseFloat(i),ce_oi:E,pe_oi:P,ce_oi_chng:S,pe_oi_chng:A,pcr_oi:z,pcr_oi_chng:q,ce_reversal:Q,pe_reversal:J,ce_ltp:N.ltp||0,pe_ltp:C.ltp||0,ce_iv:N.iv||0,pe_iv:C.iv||0}}).filter(i=>i.ce_oi>0||i.pe_oi>0).sort((i,y)=>i.strike-y.strike):[],[n]),g=v.useMemo(()=>[...d].sort((i,y)=>y.ce_oi-i.ce_oi).slice(0,5),[d]),f=v.useMemo(()=>[...d].sort((i,y)=>y.pe_oi-i.pe_oi).slice(0,5),[d]),a=v.useMemo(()=>Math.max(...d.flatMap(i=>[i.ce_oi,i.pe_oi]),1),[d]),x=v.useMemo(()=>t?d.find(i=>i.strike===t):null,[t,d]),s=u>1.2?"text-green-600":u>.8?"text-amber-600":"text-red-600",p=u>1.2?"Bullish":u>.8?"Neutral":"Bearish",_=i=>i>1.5?"text-green-600 bg-green-50 dark:bg-green-900/30":i>1?"text-green-500 bg-green-50/50 dark:bg-green-900/20":i>.7?"text-amber-600 bg-amber-50 dark:bg-amber-900/30":"text-red-600 bg-red-50 dark:bg-red-900/30";return n?e.jsxs("div",{className:"space-y-6",children:[j&&e.jsxs("div",{className:"text-center mb-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Showing data for"}),e.jsx("span",{className:"ml-2 px-3 py-1 bg-blue-100 dark:bg-blue-900/50 text-blue-700 dark:text-blue-300 rounded-lg font-bold",children:j})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-red-500 to-red-600 rounded-xl p-4 text-white",children:[e.jsx("div",{className:"text-xs opacity-80 mb-1",children:"Total Call OI"}),e.jsx("div",{className:"text-2xl font-bold",children:r(o.calls)})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-500 to-green-600 rounded-xl p-4 text-white",children:[e.jsx("div",{className:"text-xs opacity-80 mb-1",children:"Total Put OI"}),e.jsx("div",{className:"text-2xl font-bold",children:r(o.puts)})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"PCR"}),e.jsx("div",{className:`text-2xl font-bold ${s}`,children:u==null?void 0:u.toFixed(2)}),e.jsx("div",{className:`text-xs ${s}`,children:p})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl p-4 text-white",children:[e.jsxs("div",{className:"text-xs opacity-80 mb-1 flex items-center gap-1",children:[e.jsx(ne,{className:"w-3 h-3"})," Max Pain"]}),e.jsx("div",{className:"text-2xl font-bold",children:m}),e.jsxs("div",{className:"text-xs opacity-80",children:[((m-b)/b*100).toFixed(2),"% from spot"]})]})]}),t&&x&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>l(null),children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full p-6",onClick:i=>i.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-xl font-bold",children:["Strike ",t]}),e.jsx("button",{onClick:()=>l(null),className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",children:e.jsx(Y,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"mb-4 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-xl",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Strike PCR (PE/CE OI)"}),e.jsx("div",{className:`text-2xl font-bold ${_(x.pcr_oi).split(" ")[0]}`,children:x.pcr_oi.toFixed(2)}),e.jsx("div",{className:"text-xs text-gray-400",children:x.pcr_oi>1?"More Puts = Bullish Support":"More Calls = Bearish Resistance"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 rounded-xl",children:[e.jsxs("div",{className:"text-xs text-red-600 mb-1 flex items-center gap-1",children:[e.jsx(O,{className:"w-3 h-3"})," Resistance (CE)"]}),e.jsx("div",{className:"text-lg font-bold text-red-700 dark:text-red-400",children:x.ce_reversal?x.ce_reversal.toFixed(2):"N/A"}),e.jsxs("div",{className:"text-xs text-gray-500",children:["CE OI: ",r(x.ce_oi)]})]}),e.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900/20 rounded-xl",children:[e.jsxs("div",{className:"text-xs text-green-600 mb-1 flex items-center gap-1",children:[e.jsx(V,{className:"w-3 h-3"})," Support (PE)"]}),e.jsx("div",{className:"text-lg font-bold text-green-700 dark:text-green-400",children:x.pe_reversal?x.pe_reversal.toFixed(2):"N/A"}),e.jsxs("div",{className:"text-xs text-gray-500",children:["PE OI: ",r(x.pe_oi)]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"CE OI Change"}),e.jsxs("span",{className:x.ce_oi_chng>=0?"text-green-600":"text-red-600",children:[x.ce_oi_chng>=0?"+":"",r(x.ce_oi_chng)]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"PE OI Change"}),e.jsxs("span",{className:x.pe_oi_chng>=0?"text-red-600":"text-green-600",children:[x.pe_oi_chng>=0?"+":"",r(x.pe_oi_chng)]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"CE LTP"}),e.jsxs("span",{className:"font-medium",children:["₹",x.ce_ltp.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"PE LTP"}),e.jsxs("span",{className:"font-medium",children:["₹",x.pe_ltp.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"CE IV / PE IV"}),e.jsxs("span",{className:"font-medium",children:[x.ce_iv.toFixed(1),"% / ",x.pe_iv.toFixed(1),"%"]})]})]})]})}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between",children:[e.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[e.jsx(F,{className:"w-5 h-5 text-blue-500"}),"OI Distribution by Strike"]}),e.jsx("span",{className:"text-xs text-gray-500",children:"Click any strike for details"})]}),e.jsxs("div",{className:"p-4 overflow-x-auto",children:[e.jsxs("div",{className:"min-w-[700px]",children:[e.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500 mb-2 pb-2 border-b",children:[e.jsx("div",{className:"w-16 text-right",children:"CE OI"}),e.jsx("div",{className:"flex-1"}),e.jsx("div",{className:"w-12 text-center",children:"Strike"}),e.jsx("div",{className:"w-10 text-center",children:"PCR"}),e.jsx("div",{className:"flex-1"}),e.jsx("div",{className:"w-16 text-left",children:"PE OI"})]}),d.map((i,y)=>{const N=i.ce_oi/a*100,C=i.pe_oi/a*100,E=i.strike===c,P=k===i.strike,S=Math.abs(i.strike-b)<=100;return e.jsxs("div",{className:`flex items-center gap-1 py-1.5 cursor-pointer rounded transition-all ${E?"bg-blue-100 dark:bg-blue-900/40":""} ${P?"bg-gray-100 dark:bg-gray-700/50":""} hover:bg-gray-50 dark:hover:bg-gray-700/30`,onMouseEnter:()=>h(i.strike),onMouseLeave:()=>h(null),onClick:()=>l(i.strike),children:[e.jsx("div",{className:"w-16 text-right text-xs font-medium text-green-600",children:r(i.ce_oi)}),e.jsx("div",{className:"flex-1 flex justify-end items-center",children:e.jsxs("div",{className:"h-6 rounded-l relative overflow-hidden",style:{width:`${N}%`},children:[e.jsx("div",{className:`absolute inset-0 ${i.ce_oi_chng>0?"bg-gradient-to-l from-green-500 to-green-400":"bg-gradient-to-l from-green-300 to-green-200"}`}),i.ce_oi_chng!==0&&e.jsxs("div",{className:`absolute right-1 top-1 text-[8px] font-bold ${i.ce_oi_chng>0?"text-green-800":"text-red-600"}`,children:[i.ce_oi_chng>0?"+":"",r(i.ce_oi_chng)]})]})}),e.jsx("div",{className:`w-12 text-center text-xs font-bold py-1 rounded ${E?"bg-blue-500 text-white":S?"bg-gray-200 dark:bg-gray-600":"bg-gray-100 dark:bg-gray-700"}`,children:i.strike}),e.jsx("div",{className:`w-10 text-center text-[9px] font-bold py-0.5 px-1 rounded ${_(i.pcr_oi)}`,children:i.pcr_oi>0?i.pcr_oi.toFixed(1):"-"}),e.jsx("div",{className:"flex-1 flex items-center",children:e.jsxs("div",{className:"h-6 rounded-r relative overflow-hidden",style:{width:`${C}%`},children:[e.jsx("div",{className:`absolute inset-0 ${i.pe_oi_chng>0?"bg-gradient-to-r from-red-500 to-red-400":"bg-gradient-to-r from-red-300 to-red-200"}`}),i.pe_oi_chng!==0&&e.jsxs("div",{className:`absolute left-1 top-1 text-[8px] font-bold ${i.pe_oi_chng>0?"text-red-800":"text-green-600"}`,children:[i.pe_oi_chng>0?"+":"",r(i.pe_oi_chng)]})]})}),e.jsx("div",{className:"w-16 text-left text-xs font-medium text-red-600",children:r(i.pe_oi)})]},y)})]}),e.jsxs("div",{className:"flex justify-center gap-6 mt-4 text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 rounded bg-green-500"})," Call OI"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 rounded bg-red-500"})," Put OI"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-4 h-3 rounded bg-blue-500"})," ATM"]}),e.jsx("span",{className:"text-gray-400",children:"PCR: PE/CE ratio"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700 bg-green-50 dark:bg-green-900/20",children:e.jsxs("h3",{className:"font-semibold text-green-700 dark:text-green-400 flex items-center gap-2",children:[e.jsx(V,{className:"w-5 h-5"}),"Top Resistance Levels (Max Call OI)"]})}),e.jsx("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:g.map((i,y)=>e.jsxs("div",{className:"px-4 py-3 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-gray-700/30 cursor-pointer",onClick:()=>l(i.strike),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${y===0?"bg-green-500 text-white":"bg-gray-100 dark:bg-gray-700"}`,children:y+1}),e.jsx("span",{className:"font-bold",children:i.strike}),e.jsxs("span",{className:`text-[10px] px-1.5 py-0.5 rounded ${_(i.pcr_oi)}`,children:["PCR ",i.pcr_oi.toFixed(2)]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-semibold text-green-600",children:r(i.ce_oi)}),i.ce_oi_chng!==0&&e.jsxs("div",{className:`text-xs ${i.ce_oi_chng>0?"text-green-500":"text-red-500"}`,children:[i.ce_oi_chng>0?"+":"",r(i.ce_oi_chng)]})]})]},y))})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700 bg-red-50 dark:bg-red-900/20",children:e.jsxs("h3",{className:"font-semibold text-red-700 dark:text-red-400 flex items-center gap-2",children:[e.jsx(O,{className:"w-5 h-5"}),"Top Support Levels (Max Put OI)"]})}),e.jsx("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:f.map((i,y)=>e.jsxs("div",{className:"px-4 py-3 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-gray-700/30 cursor-pointer",onClick:()=>l(i.strike),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${y===0?"bg-red-500 text-white":"bg-gray-100 dark:bg-gray-700"}`,children:y+1}),e.jsx("span",{className:"font-bold",children:i.strike}),e.jsxs("span",{className:`text-[10px] px-1.5 py-0.5 rounded ${_(i.pcr_oi)}`,children:["PCR ",i.pcr_oi.toFixed(2)]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-semibold text-red-600",children:r(i.pe_oi)}),i.pe_oi_chng!==0&&e.jsxs("div",{className:`text-xs ${i.pe_oi_chng>0?"text-red-500":"text-green-500"}`,children:[i.pe_oi_chng>0?"+":"",r(i.pe_oi_chng)]})]})]},y))})]})]})]}):e.jsxs("div",{className:"p-8 text-center text-gray-400",children:[e.jsx(F,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"Load Option Chain data first"})]})},je=()=>{const n=w($);w(L);const b=w(M),[c,u]=v.useState(null),o=v.useMemo(()=>n?Object.entries(n).map(([t,l])=>{const r=l.ce||{},d=l.pe||{};return{strike:parseFloat(t),ce_vol:r.volume||r.vol||0,pe_vol:d.volume||d.vol||0,ce_ltp:r.ltp||0,pe_ltp:d.ltp||0,ce_oi:r.OI||r.oi||0,pe_oi:d.OI||d.oi||0,ce_vol_oi_ratio:(r.volume||r.vol||0)/(r.OI||r.oi||1),pe_vol_oi_ratio:(d.volume||d.vol||0)/(d.OI||d.oi||1)}}).filter(t=>t.ce_vol>0||t.pe_vol>0).sort((t,l)=>t.strike-l.strike):[],[n]),m=v.useMemo(()=>{const t=o.reduce((r,d)=>r+d.ce_vol,0),l=o.reduce((r,d)=>r+d.pe_vol,0);return{ce:t,pe:l,ratio:t/(l||1)}},[o]),j=v.useMemo(()=>{const t=[];return o.forEach(l=>{l.ce_vol_oi_ratio>.5&&t.push({strike:l.strike,type:"CE",ratio:l.ce_vol_oi_ratio,vol:l.ce_vol}),l.pe_vol_oi_ratio>.5&&t.push({strike:l.strike,type:"PE",ratio:l.pe_vol_oi_ratio,vol:l.pe_vol})}),t.sort((l,r)=>r.ratio-l.ratio).slice(0,6)},[o]),k=v.useMemo(()=>Math.max(...o.flatMap(t=>[t.ce_vol,t.pe_vol]),1),[o]),h=t=>{if(!t||t===0)return"0";const l=Math.abs(t),r=t<0?"-":"";return l>=1e12?r+(l/1e12).toFixed(2)+"T":l>=1e9?r+(l/1e9).toFixed(2)+"B":l>=1e6?r+(l/1e6).toFixed(2)+"M":l>=1e3?r+(l/1e3).toFixed(1)+"K":r+l.toFixed(0)};return n?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-cyan-500 to-cyan-600 rounded-2xl p-5 text-white shadow-lg shadow-cyan-500/25",children:[e.jsx("div",{className:"absolute -right-4 -top-4 w-16 h-16 bg-white/10 rounded-full blur-xl"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"text-xs opacity-80 mb-1 font-medium",children:"Total Call Volume"}),e.jsx("div",{className:"text-3xl font-bold",children:h(m.ce)}),e.jsx("div",{className:"text-xs opacity-70 mt-1",children:"Contracts traded"})]})]}),e.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-pink-500 to-rose-600 rounded-2xl p-5 text-white shadow-lg shadow-pink-500/25",children:[e.jsx("div",{className:"absolute -right-4 -top-4 w-16 h-16 bg-white/10 rounded-full blur-xl"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"text-xs opacity-80 mb-1 font-medium",children:"Total Put Volume"}),e.jsx("div",{className:"text-3xl font-bold",children:h(m.pe)}),e.jsx("div",{className:"text-xs opacity-70 mt-1",children:"Contracts traded"})]})]}),e.jsxs("div",{className:"glass rounded-2xl p-5 border border-slate-200 dark:border-slate-700",children:[e.jsx("div",{className:"text-xs text-slate-500 mb-1 font-medium",children:"Volume Ratio (CE/PE)"}),e.jsx("div",{className:`text-3xl font-bold ${m.ratio>1?"text-emerald-600":"text-rose-600"}`,children:m.ratio.toFixed(2)}),e.jsx("div",{className:`text-xs mt-1 ${m.ratio>1?"text-emerald-500":"text-rose-500"}`,children:m.ratio>1?"↑ More calls":"↓ More puts"})]}),e.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-amber-500 to-orange-600 rounded-2xl p-5 text-white shadow-lg shadow-amber-500/25",children:[e.jsx("div",{className:"absolute -right-4 -top-4 w-16 h-16 bg-white/10 rounded-full blur-xl"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"text-xs opacity-80 mb-1 font-medium",children:"Active Strikes"}),e.jsx("div",{className:"text-3xl font-bold",children:o.length}),e.jsx("div",{className:"text-xs opacity-70 mt-1",children:"With volume"})]})]})]}),j.length>0&&e.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-700/50 rounded-xl p-4",children:[e.jsxs("h3",{className:"font-semibold text-amber-700 dark:text-amber-400 flex items-center gap-2 mb-3",children:[e.jsx(ce,{className:"w-5 h-5"}),"Volume Spike Alerts (High Volume/OI Ratio)"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:j.map((t,l)=>e.jsxs("div",{className:`px-3 py-1.5 rounded-lg text-sm font-medium ${t.type==="CE"?"bg-green-100 text-green-700 dark:bg-green-900/50 dark:text-green-300":"bg-red-100 text-red-700 dark:bg-red-900/50 dark:text-red-300"}`,children:[t.strike," ",t.type," • ",(t.ratio*100).toFixed(0),"% Vol/OI"]},l))})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[e.jsx(F,{className:"w-5 h-5 text-cyan-500"}),"Volume Distribution by Strike"]})}),e.jsxs("div",{className:"p-4 overflow-x-auto",children:[e.jsx("div",{className:"min-w-[600px] space-y-1",children:o.map((t,l)=>{const r=t.ce_vol/k*100,d=t.pe_vol/k*100,g=t.strike===b,f=c===t.strike;return e.jsxs("div",{className:`flex items-center gap-1 py-1 cursor-pointer rounded ${g?"bg-blue-50 dark:bg-blue-900/30":""} ${f?"bg-gray-50 dark:bg-gray-700/50":""}`,onMouseEnter:()=>u(t.strike),onMouseLeave:()=>u(null),children:[e.jsxs("div",{className:"flex-1 flex justify-end items-center gap-1",children:[f&&e.jsx("span",{className:"text-[10px] text-cyan-600 font-medium",children:h(t.ce_vol)}),e.jsx("div",{className:"h-4 rounded-l bg-gradient-to-l from-cyan-500 to-cyan-400",style:{width:`${r}%`}})]}),e.jsx("div",{className:`w-14 text-center text-xs font-bold py-1 rounded ${g?"bg-blue-500 text-white":"bg-gray-100 dark:bg-gray-700"}`,children:t.strike}),e.jsxs("div",{className:"flex-1 flex items-center gap-1",children:[e.jsx("div",{className:"h-4 rounded-r bg-gradient-to-r from-pink-500 to-pink-400",style:{width:`${d}%`}}),f&&e.jsx("span",{className:"text-[10px] text-pink-600 font-medium",children:h(t.pe_vol)})]})]},l)})}),e.jsxs("div",{className:"flex justify-center gap-6 mt-4 text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 rounded bg-cyan-500"})," Call Volume"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-3 h-3 rounded bg-pink-500"})," Put Volume"]})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"font-semibold",children:"Strike-wise Volume Details"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 text-center",children:"Strike"}),e.jsx("th",{className:"p-2 text-right text-cyan-600",children:"CE Vol"}),e.jsx("th",{className:"p-2 text-right text-cyan-600",children:"CE LTP"}),e.jsx("th",{className:"p-2 text-right text-cyan-600",children:"Vol/OI %"}),e.jsx("th",{className:"p-2 text-left text-pink-600",children:"Vol/OI %"}),e.jsx("th",{className:"p-2 text-left text-pink-600",children:"PE LTP"}),e.jsx("th",{className:"p-2 text-left text-pink-600",children:"PE Vol"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:o.slice(0,20).map((t,l)=>e.jsxs("tr",{className:t.strike===b?"bg-blue-50 dark:bg-blue-900/20":"",children:[e.jsx("td",{className:"p-2 text-center font-bold",children:t.strike}),e.jsx("td",{className:"p-2 text-right",children:h(t.ce_vol)}),e.jsx("td",{className:"p-2 text-right",children:t.ce_ltp.toFixed(2)}),e.jsx("td",{className:"p-2 text-right",children:e.jsxs("span",{className:`px-1 rounded ${t.ce_vol_oi_ratio>.5?"bg-amber-100 text-amber-700":""}`,children:[(t.ce_vol_oi_ratio*100).toFixed(0),"%"]})}),e.jsx("td",{className:"p-2 text-left",children:e.jsxs("span",{className:`px-1 rounded ${t.pe_vol_oi_ratio>.5?"bg-amber-100 text-amber-700":""}`,children:[(t.pe_vol_oi_ratio*100).toFixed(0),"%"]})}),e.jsx("td",{className:"p-2 text-left",children:t.pe_ltp.toFixed(2)}),e.jsx("td",{className:"p-2 text-left",children:h(t.pe_vol)})]},l))})]})})]})]}):e.jsxs("div",{className:"p-8 text-center text-gray-400",children:[e.jsx(F,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"Load Option Chain data first"})]})},ue=()=>{const n=w($);w(L);const b=w(M),[c,u]=v.useState("delta"),o=v.useMemo(()=>n?Object.entries(n).map(([h,t])=>{var d,g,f,a,x,s;const l=((d=t.ce)==null?void 0:d.optgeeks)||((g=t.ce)==null?void 0:g.greeks)||{},r=((f=t.pe)==null?void 0:f.optgeeks)||((a=t.pe)==null?void 0:a.greeks)||{};return{strike:parseFloat(h),ce_delta:l.delta||0,pe_delta:r.delta||0,ce_gamma:l.gamma||0,pe_gamma:r.gamma||0,ce_theta:l.theta||0,pe_theta:r.theta||0,ce_vega:l.vega||0,pe_vega:r.vega||0,ce_iv:((x=t.ce)==null?void 0:x.iv)||0,pe_iv:((s=t.pe)==null?void 0:s.iv)||0}}).filter(h=>h.ce_delta!==0||h.pe_delta!==0).sort((h,t)=>h.strike-t.strike):[],[n]),m=v.useMemo(()=>({delta:o.reduce((h,t)=>h+t.ce_delta+t.pe_delta,0),gamma:o.reduce((h,t)=>h+t.ce_gamma+t.pe_gamma,0),theta:o.reduce((h,t)=>h+t.ce_theta+t.pe_theta,0),vega:o.reduce((h,t)=>h+t.ce_vega+t.pe_vega,0)}),[o]),j={delta:{ce:"#10B981",pe:"#EF4444"},gamma:{ce:"#8B5CF6",pe:"#F59E0B"},theta:{ce:"#06B6D4",pe:"#EC4899"},vega:{ce:"#3B82F6",pe:"#84CC16"}},k=(h,t,l)=>{const r=Math.abs(h),g=Math.min(r/({delta:1,gamma:.01,theta:50,vega:100}[t]||1),1);return l==="ce"?`rgba(16, 185, 129, ${g})`:`rgba(239, 68, 68, ${g})`};return!n||o.length===0?e.jsxs("div",{className:"p-8 text-center text-gray-400",children:[e.jsx(B,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No Greeks data available. Load Option Chain first."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-emerald-500 to-teal-600 rounded-2xl p-5 text-white shadow-lg shadow-emerald-500/25",children:[e.jsx("div",{className:"absolute -right-4 -top-4 w-16 h-16 bg-white/10 rounded-full blur-xl"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"text-xs opacity-80 mb-1 font-medium",children:"Net Delta"}),e.jsx("div",{className:"text-3xl font-bold",children:m.delta.toFixed(2)}),e.jsx("div",{className:"text-xs opacity-70 mt-1",children:"Direction exposure"})]})]}),e.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-violet-500 to-purple-600 rounded-2xl p-5 text-white shadow-lg shadow-violet-500/25",children:[e.jsx("div",{className:"absolute -right-4 -top-4 w-16 h-16 bg-white/10 rounded-full blur-xl"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"text-xs opacity-80 mb-1 font-medium",children:"Net Gamma"}),e.jsx("div",{className:"text-3xl font-bold",children:m.gamma.toFixed(4)}),e.jsx("div",{className:"text-xs opacity-70 mt-1",children:"Acceleration"})]})]}),e.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-cyan-500 to-blue-600 rounded-2xl p-5 text-white shadow-lg shadow-cyan-500/25",children:[e.jsx("div",{className:"absolute -right-4 -top-4 w-16 h-16 bg-white/10 rounded-full blur-xl"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"text-xs opacity-80 mb-1 font-medium",children:"Net Theta"}),e.jsx("div",{className:"text-3xl font-bold",children:m.theta.toFixed(2)}),e.jsx("div",{className:"text-xs opacity-70 mt-1",children:"Time decay"})]})]}),e.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl p-5 text-white shadow-lg shadow-blue-500/25",children:[e.jsx("div",{className:"absolute -right-4 -top-4 w-16 h-16 bg-white/10 rounded-full blur-xl"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"text-xs opacity-80 mb-1 font-medium",children:"Net Vega"}),e.jsx("div",{className:"text-3xl font-bold",children:m.vega.toFixed(2)}),e.jsx("div",{className:"text-xs opacity-70 mt-1",children:"Volatility"})]})]})]}),e.jsx("div",{className:"flex gap-2 p-1 bg-slate-100 dark:bg-slate-800 rounded-xl w-fit",children:["delta","gamma","theta","vega"].map(h=>e.jsx("button",{onClick:()=>u(h),className:`px-5 py-2.5 rounded-lg text-sm font-bold capitalize transition-all ${c===h?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-lg":"text-slate-600 dark:text-slate-400 hover:bg-white dark:hover:bg-slate-700"}`,children:h},h))}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("h3",{className:"font-semibold flex items-center gap-2 capitalize",children:[e.jsx(B,{className:"w-5 h-5 text-purple-500"}),c," Heatmap by Strike"]})}),e.jsx("div",{className:"p-4 overflow-x-auto",children:e.jsxs("div",{className:"min-w-[600px]",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-2 text-xs text-gray-500",children:[e.jsxs("div",{className:"flex-1 text-right",children:["CE ",c]}),e.jsx("div",{className:"w-14 text-center font-bold",children:"Strike"}),e.jsxs("div",{className:"flex-1 text-left",children:["PE ",c]})]}),o.map((h,t)=>{const l=h[`ce_${c}`],r=h[`pe_${c}`],d=h.strike===b;return e.jsxs("div",{className:`flex items-center gap-1 py-0.5 ${d?"bg-blue-50 dark:bg-blue-900/20":""}`,children:[e.jsx("div",{className:"flex-1 flex justify-end",children:e.jsx("div",{className:"px-2 py-1 rounded text-xs font-medium text-right min-w-16",style:{backgroundColor:k(l,c,"ce")},children:l.toFixed(c==="gamma"?4:2)})}),e.jsx("div",{className:`w-14 text-center text-xs font-bold py-1 rounded ${d?"bg-blue-500 text-white":"bg-gray-100 dark:bg-gray-700"}`,children:h.strike}),e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"px-2 py-1 rounded text-xs font-medium min-w-16",style:{backgroundColor:k(r,c,"pe")},children:r.toFixed(c==="gamma"?4:2)})})]},t)})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("h3",{className:"font-semibold flex items-center gap-2 capitalize",children:[e.jsx(F,{className:"w-5 h-5 text-blue-500"}),c," Distribution"]})}),e.jsx("div",{className:"p-4",children:e.jsx(fe,{data:o,greek:c,atmStrike:b,colors:j[c]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"font-semibold",children:"IV Skew Analysis"})}),e.jsx("div",{className:"p-4",children:e.jsx(ye,{data:o,atmStrike:b})})]})]})},fe=({data:n,greek:b,atmStrike:c,colors:u})=>{if(!n||n.length===0)return null;const o=700,m=200,j={left:50,right:30,top:20,bottom:30},k=n.map(s=>s[`ce_${b}`]),h=n.map(s=>s[`pe_${b}`]),t=[...k,...h],l=Math.min(...t),r=Math.max(...t),d=r-l||1,g=s=>j.left+s/(n.length-1)*(o-j.left-j.right),f=s=>j.top+(r-s)/d*(m-j.top-j.bottom),a=n.map((s,p)=>`${g(p)},${f(s[`ce_${b}`])}`).join(" "),x=n.map((s,p)=>`${g(p)},${f(s[`pe_${b}`])}`).join(" ");return e.jsxs("svg",{width:"100%",height:m,viewBox:`0 0 ${o} ${m}`,children:[l<0&&r>0&&e.jsx("line",{x1:j.left,y1:f(0),x2:o-j.right,y2:f(0),stroke:"#E5E7EB",strokeDasharray:"4"}),c&&n.findIndex(s=>s.strike===c)>=0&&e.jsx("line",{x1:g(n.findIndex(s=>s.strike===c)),y1:j.top,x2:g(n.findIndex(s=>s.strike===c)),y2:m-j.bottom,stroke:"#3B82F6",strokeWidth:"2",strokeDasharray:"4"}),e.jsx("polyline",{points:a,fill:"none",stroke:u.ce,strokeWidth:"3",strokeLinecap:"round"}),e.jsx("polyline",{points:x,fill:"none",stroke:u.pe,strokeWidth:"3",strokeLinecap:"round"}),n.map((s,p)=>e.jsxs("g",{children:[e.jsx("circle",{cx:g(p),cy:f(s[`ce_${b}`]),r:"3",fill:u.ce}),e.jsx("circle",{cx:g(p),cy:f(s[`pe_${b}`]),r:"3",fill:u.pe})]},p)),e.jsx("text",{x:j.left-5,y:j.top+5,textAnchor:"end",className:"fill-gray-400 text-[10px]",children:r.toFixed(2)}),e.jsx("text",{x:j.left-5,y:m-j.bottom,textAnchor:"end",className:"fill-gray-400 text-[10px]",children:l.toFixed(2)}),e.jsxs("g",{transform:`translate(${o-100}, 10)`,children:[e.jsx("line",{x1:"0",y1:"6",x2:"15",y2:"6",stroke:u.ce,strokeWidth:"3"}),e.jsx("text",{x:"20",y:"10",className:"fill-gray-600 text-[10px]",children:"CE"}),e.jsx("line",{x1:"45",y1:"6",x2:"60",y2:"6",stroke:u.pe,strokeWidth:"3"}),e.jsx("text",{x:"65",y:"10",className:"fill-gray-600 text-[10px]",children:"PE"})]})]})},ye=({data:n,atmStrike:b})=>{if(!n||n.length===0)return null;const c=700,u=180,o={left:50,right:30,top:20,bottom:30},m=n.filter(r=>r.ce_iv>0||r.pe_iv>0),j=Math.max(...m.flatMap(r=>[r.ce_iv,r.pe_iv])),k=r=>o.left+r/(m.length-1)*(c-o.left-o.right),h=r=>o.top+(j-r)/j*(u-o.top-o.bottom),t=m.map((r,d)=>`${k(d)},${h(r.ce_iv)}`).join(" "),l=m.map((r,d)=>`${k(d)},${h(r.pe_iv)}`).join(" ");return e.jsxs("svg",{width:"100%",height:u,viewBox:`0 0 ${c} ${u}`,children:[[.25,.5,.75].map((r,d)=>e.jsx("line",{x1:o.left,y1:h(j*r),x2:c-o.right,y2:h(j*r),stroke:"#E5E7EB",strokeDasharray:"2"},d)),b&&m.findIndex(r=>r.strike===b)>=0&&e.jsxs(e.Fragment,{children:[e.jsx("line",{x1:k(m.findIndex(r=>r.strike===b)),y1:o.top,x2:k(m.findIndex(r=>r.strike===b)),y2:u-o.bottom,stroke:"#3B82F6",strokeWidth:"2",strokeDasharray:"4"}),e.jsx("text",{x:k(m.findIndex(r=>r.strike===b)),y:u-5,textAnchor:"middle",className:"fill-blue-600 text-[10px] font-bold",children:"ATM"})]}),e.jsx("polyline",{points:t,fill:"none",stroke:"#10B981",strokeWidth:"2.5",strokeLinecap:"round"}),e.jsx("polyline",{points:l,fill:"none",stroke:"#EF4444",strokeWidth:"2.5",strokeLinecap:"round"}),e.jsxs("text",{x:o.left-5,y:o.top+5,textAnchor:"end",className:"fill-gray-400 text-[10px]",children:[j.toFixed(0),"%"]}),e.jsx("text",{x:o.left-5,y:u-o.bottom,textAnchor:"end",className:"fill-gray-400 text-[10px]",children:"0%"}),e.jsxs("g",{transform:`translate(${c-100}, 10)`,children:[e.jsx("line",{x1:"0",y1:"6",x2:"15",y2:"6",stroke:"#10B981",strokeWidth:"3"}),e.jsx("text",{x:"20",y:"10",className:"fill-gray-600 text-[10px]",children:"CE IV"}),e.jsx("line",{x1:"55",y1:"6",x2:"70",y2:"6",stroke:"#EF4444",strokeWidth:"3"}),e.jsx("text",{x:"75",y:"10",className:"fill-gray-600 text-[10px]",children:"PE IV"})]})]})},ve=()=>{const n=w($),b=w(L),c=w(M),u=w(U);w(se);const[o,m]=v.useState(null),[j,k]=v.useState(100),h=v.useMemo(()=>n?Object.keys(n).map(Number).sort((d,g)=>d-g):[],[n]),t=v.useMemo(()=>{var y,N,C,E;if(!n||!c)return null;const d=o||c,g=n[d];if(!g)return null;const f=g.ce||{},a=g.pe||{},x=f.ltp||0,s=a.ltp||0,p=x+s,_=d+p,i=d-p;return{strike:d,ceLTP:x,peLTP:s,straddlePrice:p,upperBE:_,lowerBE:i,ceIV:f.iv||0,peIV:a.iv||0,avgIV:((f.iv||0)+(a.iv||0))/2,ceDelta:((y=f.optgeeks)==null?void 0:y.delta)||0,peDelta:((N=a.optgeeks)==null?void 0:N.delta)||0,ceTheta:((C=f.optgeeks)==null?void 0:C.theta)||0,peTheta:((E=a.optgeeks)==null?void 0:E.theta)||0,maxLoss:p,expectedMove:p/d*100}},[n,c,o]),l=v.useMemo(()=>{var _,i;if(!n||!c)return null;const d=c+j,g=c-j,f=((_=n[d])==null?void 0:_.ce)||{},a=((i=n[g])==null?void 0:i.pe)||{},x=f.ltp||0,s=a.ltp||0,p=x+s;return{ceStrike:d,peStrike:g,ceLTP:x,peLTP:s,stranglePrice:p,upperBE:d+p,lowerBE:g-p,savings:t?t.straddlePrice-p:0}},[n,c,j,t]),r=v.useMemo(()=>{if(!t)return[];const{strike:d,straddlePrice:g}=t,f=[];for(let a=d-500;a<=d+500;a+=10){const x=Math.max(0,a-d)-t.ceLTP,s=Math.max(0,d-a)-t.peLTP;f.push({price:a,payoff:x+s})}return f},[t]);return n?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"glass rounded-2xl p-4 border border-slate-200/50 dark:border-slate-700/50",children:e.jsxs("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("label",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300",children:"Strike:"}),e.jsx("select",{value:o||c,onChange:d=>m(Number(d.target.value)),className:"px-4 py-2 rounded-xl border border-slate-200 dark:border-slate-600 bg-white dark:bg-slate-800 text-sm font-medium focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 transition-all",children:h.map(d=>e.jsxs("option",{value:d,children:[d," ",d===c?"(ATM)":""]},d))})]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-purple-50 dark:bg-purple-900/30 rounded-xl",children:[e.jsx(K,{className:"w-4 h-4 text-purple-600 dark:text-purple-400"}),e.jsxs("span",{className:"text-sm font-semibold text-purple-700 dark:text-purple-300",children:[u," days to expiry"]})]})]})}),t&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-violet-500 to-purple-600 rounded-2xl p-5 text-white shadow-lg shadow-violet-500/25",children:[e.jsx("div",{className:"absolute -right-4 -top-4 w-16 h-16 bg-white/10 rounded-full blur-xl"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"text-xs opacity-80 mb-1 font-medium",children:"Straddle Price"}),e.jsxs("div",{className:"text-3xl font-bold",children:["₹",t.straddlePrice.toFixed(2)]}),e.jsx("div",{className:"text-xs opacity-70 mt-1",children:"CE + PE Premium"})]})]}),e.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-emerald-500 to-green-600 rounded-2xl p-5 text-white shadow-lg shadow-emerald-500/25",children:[e.jsx("div",{className:"absolute -right-4 -top-4 w-16 h-16 bg-white/10 rounded-full blur-xl"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"text-xs opacity-80 mb-1 font-medium",children:"Upper Breakeven"}),e.jsx("div",{className:"text-3xl font-bold",children:t.upperBE.toFixed(0)}),e.jsxs("div",{className:"text-xs opacity-70 mt-1",children:["+",(t.upperBE-b).toFixed(0)," from spot"]})]})]}),e.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-rose-500 to-red-600 rounded-2xl p-5 text-white shadow-lg shadow-rose-500/25",children:[e.jsx("div",{className:"absolute -right-4 -top-4 w-16 h-16 bg-white/10 rounded-full blur-xl"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"text-xs opacity-80 mb-1 font-medium",children:"Lower Breakeven"}),e.jsx("div",{className:"text-3xl font-bold",children:t.lowerBE.toFixed(0)}),e.jsxs("div",{className:"text-xs opacity-70 mt-1",children:[(t.lowerBE-b).toFixed(0)," from spot"]})]})]}),e.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-amber-500 to-orange-600 rounded-2xl p-5 text-white shadow-lg shadow-amber-500/25",children:[e.jsx("div",{className:"absolute -right-4 -top-4 w-16 h-16 bg-white/10 rounded-full blur-xl"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"text-xs opacity-80 mb-1 font-medium",children:"Expected Move"}),e.jsxs("div",{className:"text-3xl font-bold",children:["±",t.expectedMove.toFixed(2),"%"]}),e.jsxs("div",{className:"text-xs opacity-70 mt-1",children:[t.straddlePrice.toFixed(0)," pts range"]})]})]})]}),t&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[e.jsx(T,{className:"w-5 h-5 text-purple-500"}),"Premium Breakdown"]})}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"flex h-8 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-green-500 flex items-center justify-center text-white text-xs font-bold",style:{width:`${t.ceLTP/t.straddlePrice*100}%`},children:["CE ₹",t.ceLTP.toFixed(0)]}),e.jsxs("div",{className:"bg-red-500 flex items-center justify-center text-white text-xs font-bold",style:{width:`${t.peLTP/t.straddlePrice*100}%`},children:["PE ₹",t.peLTP.toFixed(0)]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"CE Premium"}),e.jsxs("div",{className:"font-bold text-green-600",children:["₹",t.ceLTP.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"PE Premium"}),e.jsxs("div",{className:"font-bold text-red-600",children:["₹",t.peLTP.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"CE IV"}),e.jsxs("div",{className:"font-bold",children:[t.ceIV.toFixed(2),"%"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"PE IV"}),e.jsxs("div",{className:"font-bold",children:[t.peIV.toFixed(2),"%"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Net Theta"}),e.jsxs("div",{className:"font-bold text-amber-600",children:["₹",(t.ceTheta+t.peTheta).toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Net Delta"}),e.jsx("div",{className:"font-bold",children:(t.ceDelta+t.peDelta).toFixed(3)})]})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[e.jsx(F,{className:"w-5 h-5 text-blue-500"}),"Payoff Diagram"]})}),e.jsx("div",{className:"p-4",children:e.jsx(Ne,{data:r,spotPrice:b,strike:t.strike})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[e.jsx(oe,{className:"w-5 h-5 text-indigo-500"}),"Strangle Builder"]})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("label",{className:"text-sm font-medium",children:"Width from ATM:"}),e.jsx("input",{type:"range",min:"50",max:"500",step:"50",value:j,onChange:d=>k(Number(d.target.value)),className:"flex-1"}),e.jsxs("span",{className:"font-bold text-indigo-600",children:[j," pts"]})]}),l&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 text-center",children:[e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-green-600",children:"CE Strike"}),e.jsx("div",{className:"font-bold text-lg",children:l.ceStrike}),e.jsxs("div",{className:"text-sm text-green-600",children:["₹",l.ceLTP.toFixed(2)]})]}),e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-red-600",children:"PE Strike"}),e.jsx("div",{className:"font-bold text-lg",children:l.peStrike}),e.jsxs("div",{className:"text-sm text-red-600",children:["₹",l.peLTP.toFixed(2)]})]}),e.jsxs("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-indigo-600",children:"Strangle Price"}),e.jsxs("div",{className:"font-bold text-lg",children:["₹",l.stranglePrice.toFixed(2)]})]}),e.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/20 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-amber-600",children:"Savings vs Straddle"}),e.jsxs("div",{className:"font-bold text-lg text-green-600",children:["₹",l.savings.toFixed(2)]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-gray-600",children:"Breakeven Range"}),e.jsxs("div",{className:"font-bold",children:[l.lowerBE.toFixed(0)," - ",l.upperBE.toFixed(0)]})]})]})]})]})]}):e.jsxs("div",{className:"p-8 text-center text-gray-400",children:[e.jsx(T,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"Load Option Chain data first"})]})},Ne=({data:n,spotPrice:b,strike:c})=>{if(!n||n.length===0)return null;const u=400,o=180,m={left:40,right:20,top:10,bottom:30},j=n.map(s=>s.price),k=n.map(s=>s.payoff),h=Math.min(...j),t=Math.max(...j),l=Math.min(...k),r=Math.max(...k),d=r-l||1,g=s=>m.left+(s-h)/(t-h)*(u-m.left-m.right),f=s=>m.top+(r-s)/d*(o-m.top-m.bottom),a=n.map(s=>`${g(s.price)},${f(s.payoff)}`).join(" "),x=f(0);return e.jsxs("svg",{width:"100%",height:o,viewBox:`0 0 ${u} ${o}`,children:[e.jsx("line",{x1:m.left,y1:x,x2:u-m.right,y2:x,stroke:"#E5E7EB",strokeWidth:"1"}),e.jsx("line",{x1:g(c),y1:m.top,x2:g(c),y2:o-m.bottom,stroke:"#8B5CF6",strokeWidth:"2",strokeDasharray:"4"}),e.jsx("line",{x1:g(b),y1:m.top,x2:g(b),y2:o-m.bottom,stroke:"#3B82F6",strokeWidth:"2"}),e.jsx("polyline",{points:a,fill:"none",stroke:"#10B981",strokeWidth:"2.5"}),e.jsx("polygon",{points:`${a} ${g(t)},${x} ${g(h)},${x}`,fill:"url(#payoffGradient)"}),e.jsx("defs",{children:e.jsxs("linearGradient",{id:"payoffGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#10B981",stopOpacity:"0.3"}),e.jsx("stop",{offset:"100%",stopColor:"#10B981",stopOpacity:"0"})]})}),e.jsx("text",{x:g(c),y:o-5,textAnchor:"middle",className:"fill-purple-600 text-[9px] font-bold",children:"Strike"}),e.jsx("text",{x:g(b),y:o-5,textAnchor:"middle",className:"fill-blue-600 text-[9px] font-bold",children:"Spot"})]})},ke=()=>{const n=w($);w(L);const b=w(M),[c,u]=v.useState([]),[o,m]=v.useState("oi"),j=v.useMemo(()=>n?Object.keys(n).map(Number).sort((a,x)=>a-x):[],[n]),k=v.useCallback(a=>{!c.includes(a)&&c.length<8&&u(x=>[...x,a].sort((s,p)=>s-p))},[c]),h=v.useCallback(a=>{u(x=>x.filter(s=>s!==a))},[]),t=v.useCallback(()=>{if(!b)return;const a=j.filter(x=>Math.abs(x-b)<=300);u(a.slice(0,8))},[b,j]),l=v.useMemo(()=>!n||c.length===0?[]:c.map(a=>{var _,i,y,N,C,E;const x=n[a],s=(x==null?void 0:x.ce)||{},p=(x==null?void 0:x.pe)||{};return{strike:a,ce_oi:s.OI||s.oi||0,pe_oi:p.OI||p.oi||0,ce_volume:s.volume||s.vol||0,pe_volume:p.volume||p.vol||0,ce_iv:s.iv||0,pe_iv:p.iv||0,ce_ltp:s.ltp||0,pe_ltp:p.ltp||0,ce_delta:((_=s.optgeeks)==null?void 0:_.delta)||0,pe_delta:((i=p.optgeeks)==null?void 0:i.delta)||0,ce_theta:((y=s.optgeeks)==null?void 0:y.theta)||0,pe_theta:((N=p.optgeeks)==null?void 0:N.theta)||0,ce_gamma:((C=s.optgeeks)==null?void 0:C.gamma)||0,pe_gamma:((E=p.optgeeks)==null?void 0:E.gamma)||0}}),[n,c]),r=[{key:"oi",label:"Open Interest",ceKey:"ce_oi",peKey:"pe_oi"},{key:"volume",label:"Volume",ceKey:"ce_volume",peKey:"pe_volume"},{key:"iv",label:"IV %",ceKey:"ce_iv",peKey:"pe_iv"},{key:"ltp",label:"LTP",ceKey:"ce_ltp",peKey:"pe_ltp"},{key:"delta",label:"Delta",ceKey:"ce_delta",peKey:"pe_delta"},{key:"theta",label:"Theta",ceKey:"ce_theta",peKey:"pe_theta"}],d=r.find(a=>a.key===o)||r[0],g=a=>a>=1e5?(a/1e5).toFixed(2)+"L":a>=1e3?(a/1e3).toFixed(1)+"K":(a==null?void 0:a.toFixed(2))||"0",f=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#06B6D4","#EC4899","#84CC16"];return n?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[e.jsx(xe,{className:"w-5 h-5 text-blue-500"}),"Select Strikes to Compare (max 8)"]}),e.jsx("button",{onClick:t,className:"px-3 py-1.5 bg-blue-100 dark:bg-blue-900/50 text-blue-700 dark:text-blue-300 rounded-lg text-sm font-medium hover:bg-blue-200",children:"Add ATM ±300"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[c.map((a,x)=>e.jsxs("div",{className:"flex items-center gap-1 px-3 py-1.5 rounded-lg text-sm font-medium text-white",style:{backgroundColor:f[x%f.length]},children:[a," ",a===b&&"(ATM)",e.jsx("button",{onClick:()=>h(a),className:"ml-1 hover:bg-white/20 rounded p-0.5",children:e.jsx(Y,{className:"w-4 h-4"})})]},a)),c.length===0&&e.jsx("span",{className:"text-gray-400 text-sm",children:"Click strikes below to add..."})]}),e.jsx("div",{className:"flex flex-wrap gap-1 max-h-40 overflow-y-auto",children:j.map(a=>{const x=c.includes(a),s=a===b;return e.jsx("button",{onClick:()=>x?h(a):k(a),disabled:!x&&c.length>=8,className:`px-2 py-1 text-xs rounded transition-colors ${x?"bg-blue-500 text-white":s?"bg-blue-100 dark:bg-blue-900/50 text-blue-700 dark:text-blue-300 hover:bg-blue-200":"bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600"} ${c.length>=8&&!x?"opacity-50 cursor-not-allowed":""}`,children:a},a)})})]}),c.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex gap-2 flex-wrap",children:r.map(a=>e.jsx("button",{onClick:()=>m(a.key),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${o===a.key?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:a.label},a.key))}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[e.jsx(F,{className:"w-5 h-5 text-blue-500"}),d.label," Comparison"]})}),e.jsx("div",{className:"p-4",children:e.jsx(we,{data:l,ceKey:d.ceKey,peKey:d.peKey,label:d.label,colors:f,atmStrike:b})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h3",{className:"font-semibold",children:"Detailed Comparison"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 text-left",children:"Metric"}),l.map((a,x)=>e.jsxs("th",{className:"p-2 text-center",style:{color:f[x%f.length]},children:[a.strike," ",a.strike===b&&"⭐"]},a.strike))]})}),e.jsxs("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:[e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 font-medium text-red-600",children:"CE OI"}),l.map(a=>e.jsx("td",{className:"p-2 text-center",children:g(a.ce_oi)},a.strike))]}),e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 font-medium text-green-600",children:"PE OI"}),l.map(a=>e.jsx("td",{className:"p-2 text-center",children:g(a.pe_oi)},a.strike))]}),e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 font-medium text-red-600",children:"CE LTP"}),l.map(a=>e.jsxs("td",{className:"p-2 text-center",children:["₹",a.ce_ltp.toFixed(2)]},a.strike))]}),e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 font-medium text-green-600",children:"PE LTP"}),l.map(a=>e.jsxs("td",{className:"p-2 text-center",children:["₹",a.pe_ltp.toFixed(2)]},a.strike))]}),e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 font-medium text-red-600",children:"CE IV"}),l.map(a=>e.jsxs("td",{className:"p-2 text-center",children:[a.ce_iv.toFixed(1),"%"]},a.strike))]}),e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 font-medium text-green-600",children:"PE IV"}),l.map(a=>e.jsxs("td",{className:"p-2 text-center",children:[a.pe_iv.toFixed(1),"%"]},a.strike))]}),e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 font-medium text-red-600",children:"CE Delta"}),l.map(a=>e.jsx("td",{className:"p-2 text-center",children:a.ce_delta.toFixed(3)},a.strike))]}),e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 font-medium text-green-600",children:"PE Delta"}),l.map(a=>e.jsx("td",{className:"p-2 text-center",children:a.pe_delta.toFixed(3)},a.strike))]}),e.jsxs("tr",{className:"bg-purple-50 dark:bg-purple-900/20",children:[e.jsx("td",{className:"p-2 font-medium",children:"Straddle"}),l.map(a=>e.jsxs("td",{className:"p-2 text-center font-bold",children:["₹",(a.ce_ltp+a.pe_ltp).toFixed(2)]},a.strike))]})]})]})})]})]})]}):e.jsxs("div",{className:"p-8 text-center text-gray-400",children:[e.jsx(F,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"Load Option Chain data first"})]})},we=({data:n,ceKey:b,peKey:c,label:u,colors:o,atmStrike:m})=>{if(!n||n.length===0)return null;const j=Math.max(...n.flatMap(r=>[r[b],r[c]])),k=Math.min(40,300/n.length),h=n.length*(k*2+20)+60,t=200,l=150;return e.jsxs("svg",{width:"100%",height:t,viewBox:`0 0 ${h} ${t}`,children:[[.25,.5,.75,1].map((r,d)=>e.jsx("line",{x1:"40",y1:l-r*l+20,x2:h-20,y2:l-r*l+20,stroke:"#E5E7EB",strokeDasharray:"2"},d)),n.map((r,d)=>{const g=50+d*(k*2+20),f=r[b]/j*l,a=r[c]/j*l,x=r.strike===m;return e.jsxs("g",{children:[x&&e.jsx("rect",{x:g-5,y:15,width:k*2+10,height:l+10,fill:"#3B82F620",rx:"4"}),e.jsx("rect",{x:g,y:20+l-f,width:k,height:f,fill:"#EF4444",rx:"2"}),e.jsx("rect",{x:g+k,y:20+l-a,width:k,height:a,fill:"#10B981",rx:"2"}),e.jsx("text",{x:g+k,y:t-5,textAnchor:"middle",className:`text-[10px] ${x?"fill-blue-600 font-bold":"fill-gray-500"}`,children:r.strike})]},r.strike)}),e.jsxs("g",{transform:"translate(50, 5)",children:[e.jsx("rect",{x:"0",y:"0",width:"12",height:"12",fill:"#EF4444",rx:"2"}),e.jsx("text",{x:"16",y:"10",className:"fill-gray-600 text-[10px]",children:"CE"}),e.jsx("rect",{x:"40",y:"0",width:"12",height:"12",fill:"#10B981",rx:"2"}),e.jsx("text",{x:"56",y:"10",className:"fill-gray-600 text-[10px]",children:"PE"})]})]})},_e=()=>{const n=w($),b=w(L),c=w(M),u=w(ae),[o,m]=v.useState([]),[j,k]=v.useState(!1),h=v.useMemo(()=>n?Object.keys(n).map(Number).sort((s,p)=>s-p):[],[n]),t=v.useCallback((s,p,_)=>{const i=n==null?void 0:n[s];if(!i)return;const y=p==="CE"?i.ce:i.pe;y&&m(N=>{var C,E,P,S;return[...N,{id:Date.now(),strike:s,type:p,action:_,qty:1,ltp:y.ltp||0,iv:y.iv||0,delta:((C=y.optgeeks)==null?void 0:C.delta)||0,theta:((E=y.optgeeks)==null?void 0:E.theta)||0,gamma:((P=y.optgeeks)==null?void 0:P.gamma)||0,vega:((S=y.optgeeks)==null?void 0:S.vega)||0}]})},[n]),l=v.useCallback(s=>{m(p=>p.filter(_=>_.id!==s))},[]),r=v.useCallback((s,p)=>{m(_=>_.map(i=>i.id===s?{...i,qty:Math.max(1,p)}:i))},[]),d=v.useCallback(()=>m([]),[]),g=[{name:"Long Straddle",build:()=>{t(c,"CE","BUY"),t(c,"PE","BUY")}},{name:"Short Straddle",build:()=>{t(c,"CE","SELL"),t(c,"PE","SELL")}},{name:"Bull Call Spread",build:()=>{t(c,"CE","BUY"),t(c+100,"CE","SELL")}},{name:"Bear Put Spread",build:()=>{t(c,"PE","BUY"),t(c-100,"PE","SELL")}},{name:"Iron Condor",build:()=>{t(c-200,"PE","BUY"),t(c-100,"PE","SELL"),t(c+100,"CE","SELL"),t(c+200,"CE","BUY")}},{name:"Iron Butterfly",build:()=>{t(c,"CE","SELL"),t(c,"PE","SELL"),t(c+100,"CE","BUY"),t(c-100,"PE","BUY")}},{name:"Long Strangle",build:()=>{t(c+100,"CE","BUY"),t(c-100,"PE","BUY")}}],f=v.useMemo(()=>{if(o.length===0)return null;let s=0,p=0,_=0,i=0,y=0;return o.forEach(N=>{const C=N.action==="BUY"?-1:1;s+=N.ltp*N.qty*C,p+=N.delta*N.qty*(N.action==="BUY"?1:-1),_+=N.gamma*N.qty*(N.action==="BUY"?1:-1),i+=N.theta*N.qty*(N.action==="BUY"?1:-1),y+=N.vega*N.qty*(N.action==="BUY"?1:-1)}),{totalPremium:s*u,netDelta:p,netGamma:_,netTheta:i,netVega:y,maxProfit:s>0?s*u:"Unlimited",maxLoss:s<0?Math.abs(s)*u:"Limited"}},[o,u]),a=v.useMemo(()=>{if(o.length===0)return[];const s=[],p=1e3;for(let _=b-p;_<=b+p;_+=10){let i=0;o.forEach(y=>{let N=0;y.type==="CE"?N=Math.max(0,_-y.strike):N=Math.max(0,y.strike-_);const C=(N-y.ltp)*y.qty;i+=y.action==="BUY"?C:-C}),s.push({price:_,payoff:i*u})}return s},[o,b,u]),x=v.useMemo(()=>{if(a.length<2)return[];const s=[];for(let p=1;p<a.length;p++)(a[p-1].payoff<0&&a[p].payoff>=0||a[p-1].payoff>=0&&a[p].payoff<0)&&s.push(a[p].price);return s},[a]);return n?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:e.jsxs("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[e.jsx(I,{className:"w-5 h-5 text-purple-500"}),"Strategy Builder"]}),e.jsxs("span",{className:"text-sm text-gray-500",children:["Lot Size: ",u]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>k(!j),className:"px-4 py-2 bg-purple-100 dark:bg-purple-900/50 text-purple-700 dark:text-purple-300 rounded-lg text-sm font-medium hover:bg-purple-200",children:"Presets ▾"}),j&&e.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700 z-10",children:g.map((s,p)=>e.jsx("button",{onClick:()=>{d(),setTimeout(s.build,50),k(!1)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 dark:hover:bg-gray-700 first:rounded-t-lg last:rounded-b-lg",children:s.name},p))})]}),e.jsx("button",{onClick:d,disabled:o.length===0,className:"px-4 py-2 bg-red-100 dark:bg-red-900/50 text-red-700 dark:text-red-300 rounded-lg text-sm font-medium hover:bg-red-200 disabled:opacity-50",children:"Clear All"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[e.jsx(G,{className:"w-5 h-5 text-blue-500"}),"Add Legs"]})}),e.jsx("div",{className:"p-4",children:e.jsx(Ce,{strikes:h,atmStrike:c,onAdd:t})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[e.jsx(me,{className:"w-5 h-5 text-green-500"}),"Strategy Summary"]})}),e.jsx("div",{className:"p-4",children:f?e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:`p-3 rounded-lg ${f.totalPremium>=0?"bg-green-50 dark:bg-green-900/20":"bg-red-50 dark:bg-red-900/20"}`,children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Net Premium"}),e.jsxs("div",{className:`text-lg font-bold ${f.totalPremium>=0?"text-green-600":"text-red-600"}`,children:[f.totalPremium>=0?"+":"","₹",f.totalPremium.toFixed(0)]}),e.jsx("div",{className:"text-[10px] text-gray-400",children:f.totalPremium>=0?"Credit":"Debit"})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-gray-50 dark:bg-gray-700/50",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Net Delta"}),e.jsx("div",{className:"text-lg font-bold",children:f.netDelta.toFixed(3)})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-gray-50 dark:bg-gray-700/50",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Net Theta"}),e.jsxs("div",{className:`text-lg font-bold ${f.netTheta>=0?"text-green-600":"text-red-600"}`,children:["₹",f.netTheta.toFixed(2)]})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-gray-50 dark:bg-gray-700/50",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Net Gamma"}),e.jsx("div",{className:"text-lg font-bold",children:f.netGamma.toFixed(4)})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-gray-50 dark:bg-gray-700/50",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Net Vega"}),e.jsx("div",{className:"text-lg font-bold",children:f.netVega.toFixed(2)})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-blue-50 dark:bg-blue-900/20",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Breakevens"}),e.jsx("div",{className:"text-sm font-bold text-blue-600",children:x.length>0?x.join(", "):"N/A"})]})]}):e.jsx("div",{className:"text-center text-gray-400 py-8",children:"Add legs to see summary"})})]})]}),o.length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("h3",{className:"font-semibold",children:["Strategy Legs (",o.length,")"]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 text-left",children:"Action"}),e.jsx("th",{className:"p-2 text-center",children:"Strike"}),e.jsx("th",{className:"p-2 text-center",children:"Type"}),e.jsx("th",{className:"p-2 text-center",children:"Qty"}),e.jsx("th",{className:"p-2 text-right",children:"LTP"}),e.jsx("th",{className:"p-2 text-right",children:"IV"}),e.jsx("th",{className:"p-2 text-right",children:"Delta"}),e.jsx("th",{className:"p-2 text-right",children:"Value"}),e.jsx("th",{className:"p-2"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:o.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"p-2",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold ${s.action==="BUY"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:s.action})}),e.jsx("td",{className:"p-2 text-center font-bold",children:s.strike}),e.jsx("td",{className:"p-2 text-center",children:e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${s.type==="CE"?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:s.type})}),e.jsx("td",{className:"p-2 text-center",children:e.jsx("input",{type:"number",min:"1",value:s.qty,onChange:p=>r(s.id,parseInt(p.target.value)||1),className:"w-12 text-center border rounded px-1 py-0.5"})}),e.jsxs("td",{className:"p-2 text-right",children:["₹",s.ltp.toFixed(2)]}),e.jsxs("td",{className:"p-2 text-right",children:[s.iv.toFixed(1),"%"]}),e.jsx("td",{className:"p-2 text-right",children:s.delta.toFixed(3)}),e.jsxs("td",{className:`p-2 text-right font-medium ${s.action==="SELL"?"text-green-600":"text-red-600"}`,children:[s.action==="SELL"?"+":"-","₹",(s.ltp*s.qty*u).toFixed(0)]}),e.jsx("td",{className:"p-2",children:e.jsx("button",{onClick:()=>l(s.id),className:"p-1 hover:bg-red-100 rounded text-red-500",children:e.jsx(he,{className:"w-4 h-4"})})})]},s.id))})]})})]}),a.length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[e.jsx(F,{className:"w-5 h-5 text-blue-500"}),"Payoff at Expiry"]})}),e.jsx("div",{className:"p-4",children:e.jsx(Ee,{data:a,spotPrice:b,breakevens:x})})]})]}):e.jsxs("div",{className:"p-8 text-center text-gray-400",children:[e.jsx(I,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"Load Option Chain data first"})]})},Ce=({strikes:n,atmStrike:b,onAdd:c})=>{const[u,o]=v.useState(b||n[0]||0),[m,j]=v.useState("CE"),[k,h]=v.useState("BUY");return e.jsxs("div",{className:"flex flex-wrap items-end gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"Action"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>h("BUY"),className:`px-3 py-1.5 rounded text-sm font-medium ${k==="BUY"?"bg-green-500 text-white":"bg-gray-100 dark:bg-gray-700"}`,children:"BUY"}),e.jsx("button",{onClick:()=>h("SELL"),className:`px-3 py-1.5 rounded text-sm font-medium ${k==="SELL"?"bg-red-500 text-white":"bg-gray-100 dark:bg-gray-700"}`,children:"SELL"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"Strike"}),e.jsx("select",{value:u,onChange:t=>o(Number(t.target.value)),className:"px-3 py-1.5 border rounded bg-white dark:bg-gray-700 text-sm",children:n.map(t=>e.jsxs("option",{value:t,children:[t," ",t===b?"(ATM)":""]},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"Type"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>j("CE"),className:`px-3 py-1.5 rounded text-sm font-medium ${m==="CE"?"bg-green-500 text-white":"bg-gray-100 dark:bg-gray-700"}`,children:"CE"}),e.jsx("button",{onClick:()=>j("PE"),className:`px-3 py-1.5 rounded text-sm font-medium ${m==="PE"?"bg-red-500 text-white":"bg-gray-100 dark:bg-gray-700"}`,children:"PE"})]})]}),e.jsxs("button",{onClick:()=>c(u,m,k),className:"px-4 py-1.5 bg-blue-600 text-white rounded text-sm font-medium hover:bg-blue-700 flex items-center gap-1",children:[e.jsx(G,{className:"w-4 h-4"})," Add Leg"]})]})},Ee=({data:n,spotPrice:b,breakevens:c})=>{if(!n||n.length===0)return null;const u=600,o=220,m={left:60,right:20,top:20,bottom:30},j=n.map(s=>s.price),k=n.map(s=>s.payoff),h=Math.min(...k,0),t=Math.max(...k,0),l=t-h||1,r=s=>m.left+(s-j[0])/(j[j.length-1]-j[0])*(u-m.left-m.right),d=s=>m.top+(t-s)/l*(o-m.top-m.bottom),g=d(0),f=n.map(s=>`${r(s.price)},${d(s.payoff)}`).join(" "),a=n.filter(s=>s.payoff>=0),x=n.filter(s=>s.payoff<0);return e.jsxs("svg",{width:"100%",height:o,viewBox:`0 0 ${u} ${o}`,children:[e.jsx("line",{x1:m.left,y1:g,x2:u-m.right,y2:g,stroke:"#9CA3AF",strokeWidth:"1.5"}),a.length>1&&e.jsx("polygon",{points:`${r(a[0].price)},${g} ${a.map(s=>`${r(s.price)},${d(s.payoff)}`).join(" ")} ${r(a[a.length-1].price)},${g}`,fill:"rgba(16, 185, 129, 0.3)"}),x.length>1&&e.jsx("polygon",{points:`${r(x[0].price)},${g} ${x.map(s=>`${r(s.price)},${d(s.payoff)}`).join(" ")} ${r(x[x.length-1].price)},${g}`,fill:"rgba(239, 68, 68, 0.3)"}),e.jsx("polyline",{points:f,fill:"none",stroke:"#1F2937",strokeWidth:"2.5",strokeLinejoin:"round"}),e.jsx("line",{x1:r(b),y1:m.top,x2:r(b),y2:o-m.bottom,stroke:"#3B82F6",strokeWidth:"2",strokeDasharray:"4"}),e.jsx("text",{x:r(b),y:o-5,textAnchor:"middle",className:"fill-blue-600 text-[10px] font-bold",children:"Spot"}),c.map((s,p)=>e.jsxs("g",{children:[e.jsx("circle",{cx:r(s),cy:g,r:"5",fill:"#F59E0B"}),e.jsx("text",{x:r(s),y:g-10,textAnchor:"middle",className:"fill-amber-600 text-[9px] font-bold",children:"BE"})]},p)),e.jsxs("text",{x:m.left-5,y:m.top+5,textAnchor:"end",className:"fill-green-600 text-[10px] font-medium",children:["+₹",(t/1e3).toFixed(0),"K"]}),e.jsx("text",{x:m.left-5,y:g+4,textAnchor:"end",className:"fill-gray-500 text-[10px]",children:"0"}),e.jsxs("text",{x:m.left-5,y:o-m.bottom,textAnchor:"end",className:"fill-red-600 text-[10px] font-medium",children:["-₹",(Math.abs(h)/1e3).toFixed(0),"K"]})]})},R=[{id:"oi",label:"OI Analysis",icon:F,component:H},{id:"volume",label:"Volume",icon:pe,component:je},{id:"greeks",label:"Greeks",icon:B,component:ue},{id:"straddle",label:"Straddle",icon:T,component:ve},{id:"multistrike",label:"Multi-Strike",icon:ge,component:ke},{id:"strategy",label:"Strategy",icon:I,component:_e}],Be=()=>{var x;const n=X(),b=w(re),c=w(W),u=w(le),o=w(L),m=w(U),j=w(ie),k=w($),h=c||b||"NIFTY",[t,l]=v.useState("oi"),[r,d]=v.useState(new Date),g=v.useCallback(()=>{b&&u&&(n(de({symbol:b,expiry:String(u)})),d(new Date))},[n,b,u]);v.useEffect(()=>{const s=setInterval(g,3e4);return()=>clearInterval(s)},[g]);const f=s=>s?new Date(Number(s)*1e3).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"2-digit"}):"",a=((x=R.find(s=>s.id===t))==null?void 0:x.component)||H;return!k&&!j?e.jsxs(e.Fragment,{children:[e.jsx(D,{children:e.jsx("title",{children:"Analytics | Stockify"})}),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:e.jsxs("div",{className:"text-center p-8 bg-white dark:bg-gray-800 rounded-2xl shadow-xl max-w-md",children:[e.jsx(F,{className:"w-16 h-16 mx-auto text-gray-300 dark:text-gray-600 mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"No Data Available"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"Please visit the Option Chain page first to load market data."}),e.jsx("a",{href:"/option-chain",className:"inline-block px-6 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors",children:"Go to Option Chain"})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx(D,{children:e.jsxs("title",{children:[h," Analytics | Stockify"]})}),e.jsxs("div",{className:"min-h-screen bg-mesh-gradient",children:[e.jsx("div",{className:"sticky top-0 z-40 glass-strong border-b border-slate-200/50 dark:border-slate-700/50",children:e.jsxs("div",{className:"px-4 py-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"relative flex h-2.5 w-2.5",children:[e.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"}),e.jsx("span",{className:"relative inline-flex rounded-full h-2.5 w-2.5 bg-green-500"})]}),e.jsx("span",{className:"text-xs font-medium text-green-600 dark:text-green-400",children:"Live"})]}),e.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:h}),e.jsxs("span",{className:"text-xl font-bold text-blue-600 dark:text-blue-400",children:["₹",o==null?void 0:o.toFixed(2)]}),e.jsx("span",{className:"px-2 py-1 bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 rounded-lg text-xs font-medium",children:f(u)}),e.jsxs("span",{className:"px-2 py-1 bg-purple-100 dark:bg-purple-900/50 text-purple-700 dark:text-purple-300 rounded-lg text-xs font-bold flex items-center gap-1",children:[e.jsx(K,{className:"w-3 h-3"}),m," DTE"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-xs text-gray-400 hidden sm:block",children:["Updated: ",r.toLocaleTimeString()]}),e.jsx("button",{onClick:g,disabled:j,className:"p-2.5 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-xl hover:shadow-lg hover:shadow-blue-500/25 transition-all disabled:opacity-50",children:e.jsx(be,{className:`w-4 h-4 ${j?"animate-spin":""}`})})]})]}),e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-1 scrollbar-hide",children:R.map(s=>{const p=s.icon,_=t===s.id;return e.jsxs("button",{onClick:()=>l(s.id),className:`flex items-center gap-2 px-4 py-2.5 rounded-xl text-sm font-semibold whitespace-nowrap transition-all duration-200 ${_?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-lg shadow-blue-500/25":"bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-700"}`,children:[e.jsx(p,{className:"w-4 h-4"}),s.label]},s.id)})})]})}),e.jsx("div",{className:"p-4 md:p-6",children:e.jsx("div",{className:"glass-strong rounded-2xl p-4 md:p-6 animate-fade-in",children:e.jsx(a,{})})})]})]})};export{Be as default};
//# sourceMappingURL=Analytics-B_vGiy7e.js.map
