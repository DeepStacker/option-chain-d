import{af as e,aa as a,j as t,r as s,au as r,av as l,ah as n,at as i}from"./vendor-61R5RNdl.js";import{g as o,h as d,i as c,j as x,k as m,l as u,m as g}from"./index-DpMGw747.js";import{V as h,W as b,X as p,Y as y,Z as f,_ as j,$ as v,a0 as k,a1 as N,d as w,z as C,l as D,i as P,a as S,F as A,H as T,a2 as L}from"./ui-icons-BuGoXOaE.js";import{C as M,i as $,a as R,b as F,P as E,c as B,p as V,d as z,e as I}from"./charts-BVf48S-_.js";import{m as q,A as G}from"./animations-9kslzpSP.js";import"./firebase-Dm1Xd1Ru.js";const O=({handleGenerateClick:s})=>{const r=e(),l=a(e=>e.theme.theme),{tradePerDay:n,ndtpc:i,tradeAmount:g,riskReward:h,chancePercent:b,chargesPerTrade:p}=a(e=>e.tca);return t.jsxs("div",{className:`rounded-3xl ${"dark"===l?"bg-black text-white":"bg-gray-100 text-black"} p-5  pb-10`,children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium",children:"Trades per Day"}),t.jsx("input",{type:"number",value:n,onChange:e=>r(o(parseInt(e.target.value))),className:("dark"===l?"bg-gray-800 text-white":"bg-gray-100 text-black")+" w-full p-3 mt-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium",children:"Days to Simulate"}),t.jsx("input",{type:"number",value:i,onChange:e=>r(d(parseInt(e.target.value))),className:("dark"===l?"bg-gray-800 text-white":"bg-gray-100 text-black")+" w-full p-3 mt-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium",children:"Trade Amount"}),t.jsx("input",{type:"number",value:g,onChange:e=>r(c(parseFloat(e.target.value))),className:("dark"===l?"bg-gray-800 text-white":"bg-gray-100 text-black")+"  w-full p-3 mt-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium",children:"Risk-Reward Ratio"}),t.jsx("input",{type:"number",value:h,onChange:e=>r(x(parseFloat(e.target.value))),className:("dark"===l?"bg-gray-800 text-white":"bg-gray-100 text-black")+"  w-full p-3 mt-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium",children:"Chance Percent"}),t.jsx("input",{type:"number",value:b,onChange:e=>r(m(parseFloat(e.target.value))),className:("dark"===l?"bg-gray-800 text-white":"bg-gray-100 text-black")+"  w-full p-3 mt-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium",children:"Charges per Trade"}),t.jsx("input",{type:"number",value:p,onChange:e=>r(u(parseFloat(e.target.value))),className:("dark"===l?"bg-gray-800 text-white":"bg-gray-100 text-black")+"  w-full p-3 mt-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t.jsx("div",{className:"text-center",children:t.jsx("button",{onClick:s,className:"px-2 mt-2 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Generate Profit/Loss"})})]})},W=({results:e})=>{const r="p-4 rounded-3xl shadow-lg "+("dark"===a(e=>e.theme.theme)?"bg-gray-950 text-white":"bg-gray-100 text-black"),l="1.5em";return s.useMemo(()=>{if(!e)return t.jsx("div",{className:"flex justify-center items-center h-full text-xl text-gray-600",children:"Generate results to view profit/loss chart and trades"});const{totalNetProfitLoss:a=0,daysInProfit:s=0,daysInLoss:n=0,daysInBreakEven:i=0}=e;return t.jsxs("div",{className:r,children:[t.jsxs("h3",{className:"text-2xl font-semibold mb-4 flex items-center gap-2",children:[t.jsx(h,{className:"text-blue-500",size:l}),"Total P&L:",t.jsx("span",{className:(a>=0?"text-green-500":"text-red-500")+" ml-2",children:a.toFixed(2)})]}),t.jsxs("div",{className:"text-lg space-y-2",children:[t.jsxs("p",{className:"flex items-center gap-2",children:[t.jsx(b,{className:"text-green-500",size:l}),t.jsx("span",{className:"font-semibold text-green-500",children:"Days in Profit:"}),t.jsx("span",{children:s})]}),t.jsxs("p",{className:"flex items-center gap-2",children:[t.jsx(p,{className:"text-red-500",size:l}),t.jsx("span",{className:"font-semibold text-red-500",children:"Days in Loss:"}),t.jsx("span",{children:n})]}),t.jsxs("p",{className:"flex items-center gap-2",children:[t.jsx(y,{className:"text-gray-500",size:l}),t.jsx("span",{className:"font-semibold text-gray-500",children:"Days in Break-Even:"}),t.jsx("span",{children:i})]})]})]})},[e,r])},H=({pnl:e})=>{a(e=>e.theme.theme);return s.useMemo(()=>{if(!e)return t.jsx("div",{className:"flex justify-center items-center h-full text-xl text-gray-600",children:"Generate results to view profit/loss chart and trades"});const{totalNetProfitLoss:a=0}=e;return t.jsx("div",{children:t.jsxs("h3",{className:" justify-end flex gap-2",children:[t.jsx(h,{className:"text-blue-500",size:"1.5em"}),"Total P&L:",t.jsx("span",{className:""+(a>=0?"text-green-500":"text-red-500"),children:a.toFixed(2)})]})})},[e])};M.register($);const U=({profitLossData:e,theme:a})=>{const r=s.useRef(null),[l,n]=s.useState(null);return s.useEffect(()=>{l&&l.destroy();const t=r.current.getContext("2d"),s=new M(t,{type:"line",data:{labels:Array.from({length:e.length},(e,a)=>`Day ${a+1}`),datasets:[{label:"Net Profit/Loss",data:e,fill:!0,borderColor:"dark"===a?"rgba(255, 99, 132, 1)":"rgba(75, 192, 192, 1)",backgroundColor:"dark"===a?"rgba(255, 250, 255, 0.1)":"rgba(75, 192, 192, 0.2)",tension:.1}]},options:{scales:{y:{title:{display:!0,text:"Net Profit/Loss"}},x:{title:{display:!0,text:"Days"}}},plugins:{legend:{labels:{color:"dark"===a?"#fff":"#00000"}}}}});return n(s),()=>{s&&s.destroy()}},[e,a]),t.jsx("canvas",{ref:r,className:("dark"===a?"bg-gray-950 text-white":"bg-gray-100 text-black")+"  w-full h-80 mt-3 p-3 rounded-3xl ",id:"profitLossChart"})};function J({results:e}){const r=a(e=>e.theme.theme),[l,n]=s.useState({}),[i,o]=s.useState(1);if(!e||!e.generatedTrades)return t.jsx("div",{className:`text-center text-gray-500 ${"dark"===r?"dark:text-gray-400":""} mt-8`,children:"No trades generated. Please run the calculation."});const d=e.generatedTrades.length,c=Math.ceil(d/5),x=5*i,m=x-5,u=e.generatedTrades.slice(m,x);return t.jsxs("div",{className:`mt-8  ${"dark"===r?"bg-gray-950 text-white":"bg-gray-100 text-black"} p-5 rounded-3xl mb-10 `,children:[t.jsx("h3",{className:"text-2xl font-semibold mb-4 "+("dark"===r?"text-white":"text-black"),children:"Generated Trades"}),u.map((e,a)=>{const s=m+a;return t.jsxs("div",{className:"mb-4 border rounded-lg "+("dark"===r?"border-gray-950":"border-gray-300"),children:[t.jsxs("button",{onClick:()=>{return e=s,void n(a=>({...a,[e]:!a[e]}));var e},className:`flex justify-between w-full px-4 py-2 ${"dark"===r?"bg-gray-800 text-white":"bg-gray-200 text-black"} text-left font-semibold text-lg rounded-t-lg`,children:[t.jsxs("span",{children:["Day ",s+1]}),l[s]?t.jsx(f,{className:""+("dark"===r?"text-gray-400":"text-gray-600")}):t.jsx(j,{className:""+("dark"===r?"text-gray-400":"text-gray-600")})]}),l[s]&&t.jsx("ul",{className:"pl-5 pr-4 py-3 space-y-2 "+("dark"===r?"bg-gray-900 text-gray-300":"bg-gray-50 text-gray-700"),children:e.map((e,a)=>{let s="text-gray-500",l=t.jsx(v,{className:"inline mr-2"}),n=e;return"profit"===e?(s="dark"===r?"text-green-400":"text-green-600",l=t.jsx(k,{className:"inline mr-2"}),n="Profit"):"loss"===e?(s="dark"===r?"text-red-400":"text-red-600",l=t.jsx(N,{className:"inline mr-2"}),n="Loss"):"break-even"===e&&(s="dark"===r?"text-yellow-400":"text-yellow-600",l=t.jsx(v,{className:"inline mr-2"}),n="Break-Even"),t.jsxs("li",{className:`${s} flex items-center space-x-2`,children:[l,t.jsx("span",{children:`Trade ${a+1}: `}),t.jsx("span",{className:"font-semibold",children:n})]},a)})})]},s)}),t.jsxs("div",{className:"flex justify-center space-x-4 mt-6",children:[t.jsx("button",{onClick:()=>o(e=>Math.max(e-1,1)),disabled:1===i,className:`px-4 py-2 rounded-lg ${"dark"===r?"bg-gray-700 text-white":"bg-gray-300 text-black"} disabled:opacity-50`,children:"Previous"}),t.jsxs("span",{className:"font-semibold text-lg "+("dark"===r?"text-white":"text-black"),children:["Page ",i," of ",c]}),t.jsx("button",{onClick:()=>o(e=>Math.min(e+1,c)),disabled:i===c,className:`px-4 py-2 rounded-lg ${"dark"===r?"bg-gray-700 text-white":"bg-gray-300 text-black"} disabled:opacity-50`,children:"Next"})]})]})}const _=(e,a)=>{const t=2/(a+1);let s=[e[0]];for(let r=1;r<e.length;r++)s.push(e[r]*t+s[r-1]*(1-t));return s},X=e=>{const a=Math.min(...e),t=Math.max(...e);return e.map(e=>(e-a)/(t-a))},Y=e=>{const[a,t,s,r,l]=e;return t>a&&t>s&&r>s&&r<t&&l<r},Z=e=>{const[a,t,s,r,l]=e;return t>a&&t>s&&r>s&&Math.abs(t-r)<.1&&l<r},K=e=>{const[a,t,s,r,l]=e;return t<a&&t<s&&r<s&&Math.abs(t-r)<.1&&l>r},Q=e=>{const[a,t,s,r]=e,l=(s-a)/2,n=(r-t)/2;return Math.abs(l+n)<.1};M.register(R,F,E,B,V,z,I,$);const ee=({results:e,theme:a})=>{const[l,n]=s.useState("basic"),[i,o]=s.useState("all"),[d,c]=s.useState(!1),[x,m]=s.useState("all"),[u,g]=s.useState(5),[h,b]=s.useState("modern"),p=s.useMemo(()=>{if(!e)return null;const a=e.netProfitLossValues.filter(e=>e>0),t=e.netProfitLossValues.filter(e=>e<0);let s=0,r=0,l=0,n=null;return e.netProfitLossValues.forEach(e=>{const a=e>0;null===n?(n=a,s=1):n===a?s++:(n?r=Math.max(r,s):l=Math.max(l,s),n=a,s=1)}),n?r=Math.max(r,s):l=Math.max(l,s),{avgDailyProfit:a.reduce((e,a)=>e+a,0)/a.length,avgDailyLoss:Math.abs(t.reduce((e,a)=>e+a,0)/t.length),maxWinStreak:r,maxLossStreak:l,currentStreak:s,currentStreakType:n,profitDaysCount:a.length,lossDaysCount:t.length,maxDailyProfit:Math.max(...e.netProfitLossValues),maxDailyLoss:Math.min(...e.netProfitLossValues),avgTradeSize:e.netProfitLossValues.reduce((e,a)=>e+Math.abs(a),0)/e.netProfitLossValues.length,profitFactor:Math.abs(a.reduce((e,a)=>e+a,0)/t.reduce((e,a)=>e+a,0))}},[e]),y=s.useMemo(()=>{if(!e)return null;const a=e.netProfitLossValues,t=((e,a=20,t=2)=>((e,a)=>e.map((t,s)=>s<a-1?null:e.slice(s-a+1,s+1).reduce((e,a)=>e+a,0)/a))(e,a).map((s,r)=>{if(null===s)return{upper:null,middle:null,lower:null};const l=e.slice(r-a+1,r+1),n=Math.sqrt(l.reduce((e,a)=>e+Math.pow(a-s,2),0)/a);return{upper:s+t*n,middle:s,lower:s-t*n}}))(a),s=(e=>{const a=_(e,12),t=_(e,26),s=a.map((e,a)=>e-t[a]),r=_(s,9),l=s.map((e,a)=>e-r[a]);return{macd:s,signal:r,histogram:l}})(a),{forecast:r,confidence:l}=((e,a)=>{const t=Array.from({length:e.length},(e,a)=>a),s=e,r=t.length,l=t.reduce((e,a)=>e+a,0),n=s.reduce((e,a)=>e+a,0),i=(r*t.reduce((e,a,t)=>e+a*s[t],0)-l*n)/(r*t.reduce((e,a)=>e+a*a,0)-l*l),o=(n-i*l)/r;return{forecast:Array.from({length:a},(a,t)=>{const s=e.length+t;return i*s+o}),confidence:1-Math.abs(e.reduce((e,a,t)=>{const s=i*t+o;return e+Math.abs(a-s)/a},0)/e.length)}})(a,u),n=((e,a=2)=>{const t=[],s=[...e];for(let r=a;r<s.length-a;r++){const e=s[r],l=s.slice(r-a,r),n=s.slice(r+1,r+a+1);l.every(a=>a>=e)&&n.every(a=>a>=e)&&t.push({type:"support",price:e,index:r}),l.every(a=>a<=e)&&n.every(a=>a<=e)&&t.push({type:"resistance",price:e,index:r})}return t})(a);return{bollingerBands:t,macd:s,forecast:r,confidence:l,supportResistance:n,patterns:((e,a=5)=>{const t=[];for(let s=a;s<e.length;s++){const r=e.slice(s-a,s),l=X(r);Y(l)&&t.push({type:"Head and Shoulders",index:s}),Z(l)&&t.push({type:"Double Top",index:s}),K(l)&&t.push({type:"Double Bottom",index:s}),Q(l)&&t.push({type:"Triangle",index:s})}return t})(a)}},[e,u]),f={modern:{backgroundColor:"dark"===a?"rgba(17, 24, 39, 0.8)":"rgba(255, 255, 255, 0.8)",borderColor:"dark"===a?"#60A5FA":"#3B82F6",gridColor:"dark"===a?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)",textColor:"dark"===a?"#E5E7EB":"#4B5563"},classic:{backgroundColor:"dark"===a?"rgba(45, 55, 72, 0.8)":"rgba(247, 250, 252, 0.8)",borderColor:"dark"===a?"#48BB78":"#38A169",gridColor:"dark"===a?"rgba(255, 255, 255, 0.05)":"rgba(0, 0, 0, 0.05)",textColor:"dark"===a?"#CBD5E0":"#2D3748"},minimal:{backgroundColor:"transparent",borderColor:"dark"===a?"#A0AEC0":"#718096",gridColor:"dark"===a?"rgba(255, 255, 255, 0.03)":"rgba(0, 0, 0, 0.03)",textColor:"dark"===a?"#A0AEC0":"#718096"}},j={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:f[h].textColor,font:{family:"Inter, system-ui, sans-serif",weight:500}}},tooltip:{callbacks:{label:function(e){return`${e.dataset.label}: ${e.raw.toFixed(2)}`}}}},scales:{r:{ticks:{color:f[h].textColor},grid:{color:f[h].gridColor}},y:{grid:{color:f[h].gridColor},ticks:{color:f[h].textColor}},x:{grid:{color:f[h].gridColor},ticks:{color:f[h].textColor}}}};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex flex-wrap gap-4",children:[t.jsxs("select",{value:l,onChange:e=>n(e.target.value),className:"px-4 py-2 rounded-lg border "+("dark"===a?"bg-gray-700 border-gray-600 text-gray-200":"bg-white border-gray-300 text-gray-700"),children:[t.jsx("option",{value:"basic",children:"Basic Metrics"}),t.jsx("option",{value:"risk",children:"Risk Metrics"}),t.jsx("option",{value:"pattern",children:"Pattern Analysis"}),t.jsx("option",{value:"statistical",children:"Statistical Analysis"})]}),t.jsxs("select",{value:i,onChange:e=>o(e.target.value),className:"px-4 py-2 rounded-lg border "+("dark"===a?"bg-gray-700 border-gray-600 text-gray-200":"bg-white border-gray-300 text-gray-700"),children:[t.jsx("option",{value:"all",children:"All Time"}),t.jsx("option",{value:"recent",children:"Recent"}),t.jsx("option",{value:"custom",children:"Custom Range"})]}),t.jsxs("select",{value:x,onChange:e=>m(e.target.value),className:"px-4 py-2 rounded-lg border "+("dark"===a?"bg-gray-700 border-gray-600 text-gray-200":"bg-white border-gray-300 text-gray-700"),children:[t.jsx("option",{value:"all",children:"All Patterns"}),t.jsx("option",{value:"reversals",children:"Reversals"}),t.jsx("option",{value:"breakouts",children:"Breakouts"}),t.jsx("option",{value:"consolidations",children:"Consolidations"})]}),t.jsx("input",{type:"range",min:"1",max:"20",value:u,onChange:e=>g(parseInt(e.target.value)),className:"w-32"}),t.jsxs("span",{className:"text-sm text-gray-500",children:["Prediction Range: ",u," days"]}),t.jsxs("button",{onClick:()=>c(!d),className:`px-4 py-2 rounded-lg ${"dark"===a?"bg-blue-600 hover:bg-blue-700":"bg-blue-500 hover:bg-blue-600"} text-white transition-colors`,children:[d?"Hide":"Show"," Advanced Stats"]}),t.jsxs("select",{value:h,onChange:e=>b(e.target.value),className:"px-4 py-2 rounded-lg border "+("dark"===a?"bg-gray-700 border-gray-600 text-gray-200":"bg-white border-gray-300 text-gray-700"),children:[t.jsx("option",{value:"modern",children:"Modern"}),t.jsx("option",{value:"classic",children:"Classic"}),t.jsx("option",{value:"minimal",children:"Minimal"})]})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[{label:"Avg Daily Profit",value:`â‚¹${p?.avgDailyProfit.toFixed(2)}`,color:"text-green-500",icon:"â†‘"},{label:"Avg Daily Loss",value:`â‚¹${p?.avgDailyLoss.toFixed(2)}`,color:"text-red-500",icon:"â†“"},{label:"Win Streak",value:`${p?.maxWinStreak} days`,color:"text-blue-500",icon:"ðŸ”¥"},{label:"Loss Streak",value:`${p?.maxLossStreak} days`,color:"text-yellow-500",icon:"â„ï¸"}].map((e,s)=>t.jsxs(q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*s},className:`p-4 rounded-lg ${"dark"===a?"bg-gray-800":"bg-white"} shadow-lg`,children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.label}),t.jsx("div",{className:"text-xl",children:e.icon})]}),t.jsx("div",{className:`text-xl font-bold ${e.color}`,children:e.value})]},s))}),t.jsxs(q.div,{initial:{opacity:0},animate:{opacity:1},className:`p-4 rounded-lg ${"dark"===a?"bg-gray-800":"bg-white"} shadow-lg`,children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h3",{className:"text-lg font-semibold "+("dark"===a?"text-white":"text-gray-900"),children:"Current Streak"}),t.jsx("div",{className:"text-2xl "+(p?.currentStreakType?"text-green-500":"text-red-500"),children:p?.currentStreakType?"ðŸ“ˆ":"ðŸ“‰"})]}),t.jsxs("div",{className:"mt-2",children:[t.jsx("span",{className:"text-2xl font-bold mr-2",children:p?.currentStreak}),t.jsxs("span",{className:"text-gray-500",children:["consecutive ",p?.currentStreakType?"profitable":"loss"," days"]})]})]}),t.jsxs(q.div,{initial:{opacity:0},animate:{opacity:1},className:`p-4 rounded-lg ${"dark"===a?"bg-gray-800":"bg-white"} shadow-lg`,children:[t.jsx("h3",{className:"text-lg font-semibold mb-4 "+("dark"===a?"text-white":"text-gray-900"),children:"ML-Based Predictions"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Forecast Confidence"}),t.jsxs("div",{className:"text-2xl font-bold text-blue-500",children:[(100*y?.confidence).toFixed(1),"%"]})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Detected Patterns"}),t.jsx("div",{className:"text-lg",children:y?.patterns.slice(-3).map(e=>t.jsx("span",{className:"inline-block px-2 py-1 m-1 rounded-full bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200",children:e.type},e.index))})]})]}),t.jsx("div",{className:"mt-4 h-[300px]",children:t.jsx(r,{data:{labels:Array.from({length:e.netProfitLossValues.length+u},(e,a)=>`Day ${a+1}`),datasets:[{label:"Actual",data:[...e.netProfitLossValues,...Array(u).fill(null)],borderColor:f[h].borderColor,backgroundColor:"transparent"},{label:"Forecast",data:[...Array(e.netProfitLossValues.length).fill(null),...y?.forecast||[]],borderColor:"dark"===a?"#9333EA":"#7C3AED",backgroundColor:"transparent",borderDash:[5,5]},{label:"Upper Band",data:y?.bollingerBands.map(e=>e.upper),borderColor:"dark"===a?"#34D399":"#10B981",backgroundColor:"transparent",borderDash:[2,2]},{label:"Lower Band",data:y?.bollingerBands.map(e=>e.lower),borderColor:"dark"===a?"#F87171":"#EF4444",backgroundColor:"transparent",borderDash:[2,2]}]},options:j})})]}),t.jsxs(q.div,{initial:{opacity:0},animate:{opacity:1},className:`p-4 rounded-lg ${"dark"===a?"bg-gray-800":"bg-white"} shadow-lg`,children:[t.jsx("h3",{className:"text-lg font-semibold mb-4 "+("dark"===a?"text-white":"text-gray-900"),children:"Trading Performance Summary"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Profit Days vs Loss Days"}),t.jsxs("div",{className:"text-lg",children:[t.jsx("span",{className:"text-green-500 font-bold",children:p?.profitDaysCount}),t.jsx("span",{className:"text-gray-500 mx-2",children:"vs"}),t.jsx("span",{className:"text-red-500 font-bold",children:p?.lossDaysCount})]})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Max Daily P&L"}),t.jsxs("div",{className:"text-lg",children:[t.jsxs("span",{className:"text-green-500 font-bold",children:["+â‚¹",p?.maxDailyProfit.toFixed(2)]}),t.jsx("span",{className:"text-gray-500 mx-2",children:"/"}),t.jsxs("span",{className:"text-red-500 font-bold",children:["-â‚¹",Math.abs(p?.maxDailyLoss).toFixed(2)]})]})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-500",children:"Avg Trade Size"}),t.jsxs("div",{className:"text-lg font-bold text-blue-500",children:["â‚¹",p?.avgTradeSize.toFixed(2)]})]})]})]})]})};class ae{constructor(){this.baseURL="https://tca-server-3kvr.onrender.com",this.timeout=3e4,this.retryAttempts=3,this.retryDelay=2e3}async makeRequest(e,a,t=1){const s=new AbortController,r=setTimeout(()=>s.abort(),this.timeout);try{const t=await fetch(`${this.baseURL}${e}`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-Request-ID":`tca_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},body:JSON.stringify(a),signal:s.signal});if(clearTimeout(r),!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);const l=await t.json();if(!l||"object"!=typeof l)throw new Error("Invalid response format from server");return l}catch(l){if(clearTimeout(r),"AbortError"===l.name)throw new Error("Request timeout. The calculation is taking longer than expected.");if(t<this.retryAttempts&&l.message.includes("fetch"))return await new Promise(e=>setTimeout(e,this.retryDelay*t)),this.makeRequest(e,a,t+1);throw l}}}const te=()=>{const r=e(),{tradePerDay:o,ndtpc:d,tradeAmount:c,riskReward:x,chancePercent:m,chargesPerTrade:u,results:h,profitLossChart:b}=a(e=>e.tca),p=a(e=>e.theme.theme),[y,f]=s.useState(!1),[j,v]=s.useState(null),[k,N]=s.useState(null),[M]=s.useState(()=>new ae),$="Shivam";s.useEffect(()=>{document.title="DeepStrike | Advanced Risk Analysis & TCA";const e=document.querySelector('meta[name="description"]');e&&e.setAttribute("content","Professional trading cost analysis and risk management tools for algorithmic trading strategies")},[]);const R=s.useMemo(()=>{const e={tradePerDay:Number(o)||0,ndtpc:Number(d)||0,tradeAmount:Number(c)||0,riskReward:Number(x)||0,chancePercent:Number(m)||0,chargesPerTrade:Number(u)||0};return{data:e,isValid:Object.values(e).every(e=>"number"==typeof e&&!isNaN(e)&&e>=0)}},[o,d,c,x,m,u]),F=s.useMemo(()=>{try{return R.isValid?l.AES.encrypt(JSON.stringify(R.data),$).toString():null}catch(e){return null}},[R,$]),E=s.useCallback(async()=>{if(!R.isValid)return void n.error("Please fill in all fields with valid numbers");if(!F)return void n.error("Failed to encrypt data. Please try again.");f(!0),v(null);const e=Date.now();try{n.info("Calculating trading strategy analysis...",{autoClose:500,hideProgressBar:!1});const a=await M.makeRequest("/api/generate",{encryptedData:F,timestamp:Date.now(),version:"2.0"});if(!a.encryptedData)throw new Error("Invalid response: Missing encrypted data");const s=l.AES.decrypt(a.encryptedData,$).toString(l.enc.Utf8);if(!s)throw new Error("Failed to decrypt response data");const i=JSON.parse(s);if(!i||"object"!=typeof i)throw new Error("Invalid result format received");const o=Date.now()-e;N(o),r(g(i)),n.success(`Analysis completed successfully in ${(o/1e3).toFixed(1)}s`,{autoClose:500,icon:t.jsx(w,{className:"w-5 h-5"})})}catch(a){const e=a.message||"Failed to generate trading analysis";v(e),n.error(e,{autoClose:500,icon:t.jsx(C,{className:"w-5 h-5"})})}finally{f(!1)}},[R,F,$,r,M]),B=s.useMemo(()=>h?{totalTrades:h.totalTrades||0,winRate:h.winRate||0,maxDrawdown:h.maxDrawdown||0,sharpeRatio:h.sharpeRatio||0,expectedReturn:h.expectedReturn||0}:null,[h]),V="dark"===p;return t.jsxs(t.Fragment,{children:[t.jsxs(i,{children:[t.jsx("title",{children:"TCA | DeepStrike"}),t.jsx("meta",{name:"description",content:"Trading Cost Analysis and Risk Management"})]}),t.jsxs("div",{className:"min-h-screen transition-colors duration-300 "+(V?"text-white":"text-gray-900"),children:[t.jsx("div",{className:"sticky top-0 z-10 backdrop-blur-md border-b "+(V?"bg-gray-900/90 border-gray-800":"bg-white/90 border-gray-200"),children:t.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-3",children:[t.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center space-y-4 lg:space-y-0",children:[t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("div",{className:"p-3 rounded-xl "+("dark"===p?"bg-blue-900/30":"bg-blue-100"),children:t.jsx(D,{className:"w-8 h-8 "+("dark"===p?"text-blue-400":"text-blue-600")})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold",children:"Trading Cost Analysis"}),t.jsx("p",{className:"text-sm mt-1 "+("dark"===p?"text-gray-400":"text-gray-600"),children:"Advanced risk management and strategy optimization"})]})]}),t.jsxs("div",{className:"flex items-center space-x-4",children:[k&&t.jsxs("div",{className:"flex items-center space-x-2 px-3 py-1 rounded-full text-sm "+("dark"===p?"bg-green-900/30 text-green-400":"bg-green-100 text-green-700"),children:[t.jsx(P,{className:"w-4 h-4"}),t.jsxs("span",{children:["Last: ",(k/1e3).toFixed(1),"s"]})]}),t.jsx(H,{results:h})]})]}),B&&t.jsx(q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"grid grid-cols-2 md:grid-cols-5 gap-4 mt-6",children:[{label:"Total Trades",value:B.totalTrades,icon:S},{label:"Win Rate",value:`${B.winRate.toFixed(1)}%`,icon:A},{label:"Max Drawdown",value:`${B.maxDrawdown.toFixed(2)}%`,icon:C},{label:"Sharpe Ratio",value:B.sharpeRatio.toFixed(2),icon:T},{label:"Expected Return",value:`â‚¹${B.expectedReturn.toLocaleString()}`,icon:L}].map(e=>{const a=e.icon;return t.jsxs("div",{className:`p-4 rounded-lg ${"dark"===p?"bg-gray-800/50":"bg-white/50"} backdrop-blur-sm border ${"dark"===p?"border-gray-700":"border-gray-200"}`,children:[t.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[t.jsx(a,{className:"w-4 h-4 "+("dark"===p?"text-gray-400":"text-gray-600")}),t.jsx("span",{className:"text-xs font-medium "+("dark"===p?"text-gray-400":"text-gray-600"),children:e.label})]}),t.jsx("div",{className:"text-lg font-bold",children:e.value})]},e.label)})})]})}),t.jsx(G,{children:j&&t.jsx(q.div,{initial:{opacity:0,y:-50},animate:{opacity:1,y:0},exit:{opacity:0,y:-50},className:"max-w-7xl mx-auto p-4",children:t.jsx("div",{className:"p-4 rounded-lg border-l-4 "+("dark"===p?"bg-red-900/20 border-red-500 text-red-200":"bg-red-50 border-red-500 text-red-800"),children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(C,{className:"w-5 h-5"}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-semibold",children:"Calculation Error"}),t.jsx("p",{className:"text-sm mt-1",children:j})]})]}),t.jsx("button",{onClick:()=>v(null),className:"text-lg font-bold hover:opacity-70",children:"Ã—"})]})})})}),t.jsx("div",{className:"max-w-7xl mx-auto p-6",children:t.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-8",children:[t.jsx("div",{className:"xl:col-span-1",children:t.jsx(q.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"p-6 rounded-xl shadow-xl border "+("dark"===p?"bg-gray-800/50 border-gray-700 backdrop-blur-sm":"bg-white/80 border-gray-200 backdrop-blur-sm"),children:t.jsxs("div",{className:"space-y-6",children:[t.jsx(O,{handleGenerateClick:E,isLoading:y,isValid:R.isValid}),t.jsx("div",{className:"border-t pt-6 border-gray-300 dark:border-gray-600",children:t.jsx(W,{results:h})})]})})}),t.jsx("div",{className:"xl:col-span-2",children:t.jsx(G,{mode:"wait",children:y?t.jsx(q.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:`flex flex-col justify-center items-center h-96 rounded-xl ${"dark"===p?"bg-gray-800/50":"bg-white/80"} shadow-xl backdrop-blur-sm border ${"dark"===p?"border-gray-700":"border-gray-200"}`,children:t.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-blue-200 border-t-blue-600"}),t.jsx(D,{className:"absolute inset-0 m-auto w-6 h-6 text-blue-600"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Analyzing Trading Strategy"}),t.jsx("p",{className:"text-sm "+("dark"===p?"text-gray-400":"text-gray-600"),children:"Processing complex calculations and risk metrics..."})]})]})},"loading"):h?t.jsxs(q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-8",children:[t.jsx(U,{profitLossChart:b,profitLossData:h.netProfitLossValues,theme:p}),t.jsx(ee,{results:h,theme:p}),t.jsx(J,{results:h})]},"results"):t.jsx(q.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:`flex flex-col justify-center items-center h-96 rounded-xl ${"dark"===p?"bg-gray-800/50":"bg-white/80"} shadow-xl backdrop-blur-sm border ${"dark"===p?"border-gray-700":"border-gray-200"}`,children:t.jsxs("div",{className:"text-center space-y-4",children:[t.jsx("div",{className:"mx-auto w-16 h-16 rounded-full flex items-center justify-center "+("dark"===p?"bg-gray-700":"bg-gray-100"),children:t.jsx(S,{className:"w-8 h-8 "+("dark"===p?"text-gray-400":"text-gray-500")})}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Ready for Analysis"}),t.jsx("p",{className:"text-sm "+("dark"===p?"text-gray-400":"text-gray-600"),children:'Run analysis to see AI-generated trade setups based on "The Complete Audio" strategy rules.'})]})]})},"empty")})})]})})]})]})};export{te as default};
