import{aa as e,r as s,j as t,af as a,at as r}from"./vendor-61R5RNdl.js";import{K as l,a as d,C as i,L as n,M as c,N as x,O as o,P as m,Q as h,R as g,b as p,o as b,t as j,x as u}from"./index-DpMGw747.js";import{a as v,ag as y,x as N,a3 as f,F as k,b as w,C as _,m as E,i as C,ah as F,ai as P,aj as S,ak as B,l as L,al as M,am as I,h as $,ae as T}from"./ui-icons-BuGoXOaE.js";import"./charts-BVf48S-_.js";import"./firebase-Dm1Xd1Ru.js";import"./animations-9kslzpSP.js";const O=()=>{const a=e(l),r=e(d),m=e(i),h=e(n),g=e(c),p=e(x),b=e(o),[j,u]=s.useState(null),[w,_]=s.useState(null),E=e=>{if(!e||0===e)return"0";const s=Math.abs(e),t=e<0?"-":"";return s>=1e12?t+(s/1e12).toFixed(2)+"T":s>=1e9?t+(s/1e9).toFixed(2)+"B":s>=1e6?t+(s/1e6).toFixed(2)+"M":s>=1e3?t+(s/1e3).toFixed(1)+"K":t+s.toFixed(0)},C=s.useMemo(()=>a?Object.entries(a).map(([e,s])=>{const t=s.ce||{},a=s.pe||{},r=t.OI||t.oi||0,l=a.OI||a.oi||0,d=t.oichng||t.oi_change||0,i=a.oichng||a.oi_change||0,n=r>0?l/r:0,c=0!==d?Math.abs(i/d):0,x=t.reversal||0,o=a.reversal||0;return{strike:parseFloat(e),ce_oi:r,pe_oi:l,ce_oi_chng:d,pe_oi_chng:i,pcr_oi:n,pcr_oi_chng:c,ce_reversal:x,pe_reversal:o,ce_ltp:t.ltp||0,pe_ltp:a.ltp||0,ce_iv:t.iv||0,pe_iv:a.iv||0}}).filter(e=>e.ce_oi>0||e.pe_oi>0).sort((e,s)=>e.strike-s.strike):[],[a]),F=s.useMemo(()=>[...C].sort((e,s)=>s.ce_oi-e.ce_oi).slice(0,5),[C]),P=s.useMemo(()=>[...C].sort((e,s)=>s.pe_oi-e.pe_oi).slice(0,5),[C]),S=s.useMemo(()=>Math.max(...C.flatMap(e=>[e.ce_oi,e.pe_oi]),1),[C]),B=s.useMemo(()=>w?C.find(e=>e.strike===w):null,[w,C]),L=h>1.2?"text-green-600":h>.8?"text-amber-600":"text-red-600",M=h>1.2?"Bullish":h>.8?"Neutral":"Bearish",I=e=>e>1.5?"text-green-600 bg-green-50 dark:bg-green-900/30":e>1?"text-green-500 bg-green-50/50 dark:bg-green-900/20":e>.7?"text-amber-600 bg-amber-50 dark:bg-amber-900/30":"text-red-600 bg-red-50 dark:bg-red-900/30";return a?t.jsxs("div",{className:"space-y-6",children:[b&&t.jsxs("div",{className:"text-center mb-2",children:[t.jsx("span",{className:"text-xs text-gray-500",children:"Showing data for"}),t.jsx("span",{className:"ml-2 px-3 py-1 bg-blue-100 dark:bg-blue-900/50 text-blue-700 dark:text-blue-300 rounded-lg font-bold",children:b})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"bg-gradient-to-br from-red-500 to-red-600 rounded-xl p-4 text-white",children:[t.jsx("div",{className:"text-xs opacity-80 mb-1",children:"Total Call OI"}),t.jsx("div",{className:"text-2xl font-bold",children:E(g.calls)})]}),t.jsxs("div",{className:"bg-gradient-to-br from-green-500 to-green-600 rounded-xl p-4 text-white",children:[t.jsx("div",{className:"text-xs opacity-80 mb-1",children:"Total Put OI"}),t.jsx("div",{className:"text-2xl font-bold",children:E(g.puts)})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700",children:[t.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"PCR"}),t.jsx("div",{className:`text-2xl font-bold ${L}`,children:h?.toFixed(2)}),t.jsx("div",{className:`text-xs ${L}`,children:M})]}),t.jsxs("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl p-4 text-white",children:[t.jsxs("div",{className:"text-xs opacity-80 mb-1 flex items-center gap-1",children:[t.jsx(y,{className:"w-3 h-3"})," Max Pain"]}),t.jsx("div",{className:"text-2xl font-bold",children:p}),t.jsxs("div",{className:"text-xs opacity-80",children:[((p-r)/r*100).toFixed(2),"% from spot"]})]})]}),w&&B&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>_(null),children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full p-6",onClick:e=>e.stopPropagation(),children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("h3",{className:"text-xl font-bold",children:["Strike ",w]}),t.jsx("button",{onClick:()=>_(null),className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",children:t.jsx(N,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"mb-4 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-xl",children:[t.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Strike PCR (PE/CE OI)"}),t.jsx("div",{className:`text-2xl font-bold ${I(B.pcr_oi).split(" ")[0]}`,children:B.pcr_oi.toFixed(2)}),t.jsx("div",{className:"text-xs text-gray-400",children:B.pcr_oi>1?"More Puts = Bullish Support":"More Calls = Bearish Resistance"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[t.jsxs("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 rounded-xl",children:[t.jsxs("div",{className:"text-xs text-red-600 mb-1 flex items-center gap-1",children:[t.jsx(f,{className:"w-3 h-3"})," Resistance (CE)"]}),t.jsx("div",{className:"text-lg font-bold text-red-700 dark:text-red-400",children:B.ce_reversal?B.ce_reversal.toFixed(2):"N/A"}),t.jsxs("div",{className:"text-xs text-gray-500",children:["CE OI: ",E(B.ce_oi)]})]}),t.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900/20 rounded-xl",children:[t.jsxs("div",{className:"text-xs text-green-600 mb-1 flex items-center gap-1",children:[t.jsx(k,{className:"w-3 h-3"})," Support (PE)"]}),t.jsx("div",{className:"text-lg font-bold text-green-700 dark:text-green-400",children:B.pe_reversal?B.pe_reversal.toFixed(2):"N/A"}),t.jsxs("div",{className:"text-xs text-gray-500",children:["PE OI: ",E(B.pe_oi)]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-gray-500",children:"CE OI Change"}),t.jsxs("span",{className:B.ce_oi_chng>=0?"text-green-600":"text-red-600",children:[B.ce_oi_chng>=0?"+":"",E(B.ce_oi_chng)]})]}),t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-gray-500",children:"PE OI Change"}),t.jsxs("span",{className:B.pe_oi_chng>=0?"text-red-600":"text-green-600",children:[B.pe_oi_chng>=0?"+":"",E(B.pe_oi_chng)]})]}),t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-gray-500",children:"CE LTP"}),t.jsxs("span",{className:"font-medium",children:["₹",B.ce_ltp.toFixed(2)]})]}),t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-gray-500",children:"PE LTP"}),t.jsxs("span",{className:"font-medium",children:["₹",B.pe_ltp.toFixed(2)]})]}),t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-gray-500",children:"CE IV / PE IV"}),t.jsxs("span",{className:"font-medium",children:[B.ce_iv.toFixed(1),"% / ",B.pe_iv.toFixed(1),"%"]})]})]})]})}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[t.jsxs("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between",children:[t.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[t.jsx(v,{className:"w-5 h-5 text-blue-500"}),"OI Distribution by Strike"]}),t.jsx("span",{className:"text-xs text-gray-500",children:"Click any strike for details"})]}),t.jsxs("div",{className:"p-4 overflow-x-auto",children:[t.jsxs("div",{className:"min-w-[700px]",children:[t.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500 mb-2 pb-2 border-b",children:[t.jsx("div",{className:"w-16 text-right",children:"CE OI"}),t.jsx("div",{className:"flex-1"}),t.jsx("div",{className:"w-12 text-center",children:"Strike"}),t.jsx("div",{className:"w-10 text-center",children:"PCR"}),t.jsx("div",{className:"flex-1"}),t.jsx("div",{className:"w-16 text-left",children:"PE OI"})]}),C.map((e,s)=>{const a=e.ce_oi/S*100,l=e.pe_oi/S*100,d=e.strike===m,i=j===e.strike,n=Math.abs(e.strike-r)<=100;return t.jsxs("div",{className:`flex items-center gap-1 py-1.5 cursor-pointer rounded transition-all ${d?"bg-blue-100 dark:bg-blue-900/40":""} ${i?"bg-gray-100 dark:bg-gray-700/50":""} hover:bg-gray-50 dark:hover:bg-gray-700/30`,onMouseEnter:()=>u(e.strike),onMouseLeave:()=>u(null),onClick:()=>_(e.strike),children:[t.jsx("div",{className:"w-16 text-right text-xs font-medium text-green-600",children:E(e.ce_oi)}),t.jsx("div",{className:"flex-1 flex justify-end items-center",children:t.jsxs("div",{className:"h-6 rounded-l relative overflow-hidden",style:{width:`${a}%`},children:[t.jsx("div",{className:"absolute inset-0 "+(e.ce_oi_chng>0?"bg-gradient-to-l from-green-500 to-green-400":"bg-gradient-to-l from-green-300 to-green-200")}),0!==e.ce_oi_chng&&t.jsxs("div",{className:"absolute right-1 top-1 text-[8px] font-bold "+(e.ce_oi_chng>0?"text-green-800":"text-red-600"),children:[e.ce_oi_chng>0?"+":"",E(e.ce_oi_chng)]})]})}),t.jsx("div",{className:"w-12 text-center text-xs font-bold py-1 rounded "+(d?"bg-blue-500 text-white":n?"bg-gray-200 dark:bg-gray-600":"bg-gray-100 dark:bg-gray-700"),children:e.strike}),t.jsx("div",{className:`w-10 text-center text-[9px] font-bold py-0.5 px-1 rounded ${I(e.pcr_oi)}`,children:e.pcr_oi>0?e.pcr_oi.toFixed(1):"-"}),t.jsx("div",{className:"flex-1 flex items-center",children:t.jsxs("div",{className:"h-6 rounded-r relative overflow-hidden",style:{width:`${l}%`},children:[t.jsx("div",{className:"absolute inset-0 "+(e.pe_oi_chng>0?"bg-gradient-to-r from-red-500 to-red-400":"bg-gradient-to-r from-red-300 to-red-200")}),0!==e.pe_oi_chng&&t.jsxs("div",{className:"absolute left-1 top-1 text-[8px] font-bold "+(e.pe_oi_chng>0?"text-red-800":"text-green-600"),children:[e.pe_oi_chng>0?"+":"",E(e.pe_oi_chng)]})]})}),t.jsx("div",{className:"w-16 text-left text-xs font-medium text-red-600",children:E(e.pe_oi)})]},s)})]}),t.jsxs("div",{className:"flex justify-center gap-6 mt-4 text-xs text-gray-500",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"w-3 h-3 rounded bg-green-500"})," Call OI"]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"w-3 h-3 rounded bg-red-500"})," Put OI"]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"w-4 h-3 rounded bg-blue-500"})," ATM"]}),t.jsx("span",{className:"text-gray-400",children:"PCR: PE/CE ratio"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700 bg-green-50 dark:bg-green-900/20",children:t.jsxs("h3",{className:"font-semibold text-green-700 dark:text-green-400 flex items-center gap-2",children:[t.jsx(k,{className:"w-5 h-5"}),"Top Resistance Levels (Max Call OI)"]})}),t.jsx("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:F.map((e,s)=>t.jsxs("div",{className:"px-4 py-3 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-gray-700/30 cursor-pointer",onClick:()=>_(e.strike),children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("span",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold "+(0===s?"bg-green-500 text-white":"bg-gray-100 dark:bg-gray-700"),children:s+1}),t.jsx("span",{className:"font-bold",children:e.strike}),t.jsxs("span",{className:`text-[10px] px-1.5 py-0.5 rounded ${I(e.pcr_oi)}`,children:["PCR ",e.pcr_oi.toFixed(2)]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"font-semibold text-green-600",children:E(e.ce_oi)}),0!==e.ce_oi_chng&&t.jsxs("div",{className:"text-xs "+(e.ce_oi_chng>0?"text-green-500":"text-red-500"),children:[e.ce_oi_chng>0?"+":"",E(e.ce_oi_chng)]})]})]},s))})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700 bg-red-50 dark:bg-red-900/20",children:t.jsxs("h3",{className:"font-semibold text-red-700 dark:text-red-400 flex items-center gap-2",children:[t.jsx(f,{className:"w-5 h-5"}),"Top Support Levels (Max Put OI)"]})}),t.jsx("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:P.map((e,s)=>t.jsxs("div",{className:"px-4 py-3 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-gray-700/30 cursor-pointer",onClick:()=>_(e.strike),children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("span",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold "+(0===s?"bg-red-500 text-white":"bg-gray-100 dark:bg-gray-700"),children:s+1}),t.jsx("span",{className:"font-bold",children:e.strike}),t.jsxs("span",{className:`text-[10px] px-1.5 py-0.5 rounded ${I(e.pcr_oi)}`,children:["PCR ",e.pcr_oi.toFixed(2)]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"font-semibold text-red-600",children:E(e.pe_oi)}),0!==e.pe_oi_chng&&t.jsxs("div",{className:"text-xs "+(e.pe_oi_chng>0?"text-red-500":"text-green-500"),children:[e.pe_oi_chng>0?"+":"",E(e.pe_oi_chng)]})]})]},s))})]})]})]}):t.jsxs("div",{className:"p-8 text-center text-gray-400",children:[t.jsx(v,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),t.jsx("p",{children:"Load Option Chain data first"})]})},A=({data:e,greek:s,atmStrike:a,colors:r})=>{if(!e||0===e.length)return null;const l=700,d=200,i=50,n=30,c=20,x=30,o=[...e.map(e=>e[`ce_${s}`]),...e.map(e=>e[`pe_${s}`])],m=Math.min(...o),h=Math.max(...o),g=h-m||1,p=s=>i+s/(e.length-1)*(l-i-n),b=e=>c+(h-e)/g*(d-c-x),j=e.map((e,t)=>`${p(t)},${b(e[`ce_${s}`])}`).join(" "),u=e.map((e,t)=>`${p(t)},${b(e[`pe_${s}`])}`).join(" ");return t.jsxs("svg",{width:"100%",height:d,viewBox:"0 0 700 200",children:[m<0&&h>0&&t.jsx("line",{x1:i,y1:b(0),x2:l-n,y2:b(0),stroke:"#E5E7EB",strokeDasharray:"4"}),a&&e.findIndex(e=>e.strike===a)>=0&&t.jsx("line",{x1:p(e.findIndex(e=>e.strike===a)),y1:c,x2:p(e.findIndex(e=>e.strike===a)),y2:d-x,stroke:"#3B82F6",strokeWidth:"2",strokeDasharray:"4"}),t.jsx("polyline",{points:j,fill:"none",stroke:r.ce,strokeWidth:"3",strokeLinecap:"round"}),t.jsx("polyline",{points:u,fill:"none",stroke:r.pe,strokeWidth:"3",strokeLinecap:"round"}),e.map((e,a)=>t.jsxs("g",{children:[t.jsx("circle",{cx:p(a),cy:b(e[`ce_${s}`]),r:"3",fill:r.ce}),t.jsx("circle",{cx:p(a),cy:b(e[`pe_${s}`]),r:"3",fill:r.pe})]},a)),t.jsx("text",{x:i-5,y:c+5,textAnchor:"end",className:"fill-gray-400 text-[10px]",children:h.toFixed(2)}),t.jsx("text",{x:i-5,y:d-x,textAnchor:"end",className:"fill-gray-400 text-[10px]",children:m.toFixed(2)}),t.jsxs("g",{transform:"translate(600, 10)",children:[t.jsx("line",{x1:"0",y1:"6",x2:"15",y2:"6",stroke:r.ce,strokeWidth:"3"}),t.jsx("text",{x:"20",y:"10",className:"fill-gray-600 text-[10px]",children:"CE"}),t.jsx("line",{x1:"45",y1:"6",x2:"60",y2:"6",stroke:r.pe,strokeWidth:"3"}),t.jsx("text",{x:"65",y:"10",className:"fill-gray-600 text-[10px]",children:"PE"})]})]})},V=({data:e,atmStrike:s})=>{if(!e||0===e.length)return null;const a=700,r=180,l=50,d=30,i=20,n=30,c=e.filter(e=>e.ce_iv>0||e.pe_iv>0),x=Math.max(...c.flatMap(e=>[e.ce_iv,e.pe_iv])),o=e=>l+e/(c.length-1)*(a-l-d),m=e=>i+(x-e)/x*(r-i-n),h=c.map((e,s)=>`${o(s)},${m(e.ce_iv)}`).join(" "),g=c.map((e,s)=>`${o(s)},${m(e.pe_iv)}`).join(" ");return t.jsxs("svg",{width:"100%",height:r,viewBox:"0 0 700 180",children:[[.25,.5,.75].map((e,s)=>t.jsx("line",{x1:l,y1:m(x*e),x2:a-d,y2:m(x*e),stroke:"#E5E7EB",strokeDasharray:"2"},s)),s&&c.findIndex(e=>e.strike===s)>=0&&t.jsxs(t.Fragment,{children:[t.jsx("line",{x1:o(c.findIndex(e=>e.strike===s)),y1:i,x2:o(c.findIndex(e=>e.strike===s)),y2:r-n,stroke:"#3B82F6",strokeWidth:"2",strokeDasharray:"4"}),t.jsx("text",{x:o(c.findIndex(e=>e.strike===s)),y:175,textAnchor:"middle",className:"fill-blue-600 text-[10px] font-bold",children:"ATM"})]}),t.jsx("polyline",{points:h,fill:"none",stroke:"#10B981",strokeWidth:"2.5",strokeLinecap:"round"}),t.jsx("polyline",{points:g,fill:"none",stroke:"#EF4444",strokeWidth:"2.5",strokeLinecap:"round"}),t.jsxs("text",{x:l-5,y:i+5,textAnchor:"end",className:"fill-gray-400 text-[10px]",children:[x.toFixed(0),"%"]}),t.jsx("text",{x:l-5,y:r-n,textAnchor:"end",className:"fill-gray-400 text-[10px]",children:"0%"}),t.jsxs("g",{transform:"translate(600, 10)",children:[t.jsx("line",{x1:"0",y1:"6",x2:"15",y2:"6",stroke:"#10B981",strokeWidth:"3"}),t.jsx("text",{x:"20",y:"10",className:"fill-gray-600 text-[10px]",children:"CE IV"}),t.jsx("line",{x1:"55",y1:"6",x2:"70",y2:"6",stroke:"#EF4444",strokeWidth:"3"}),t.jsx("text",{x:"75",y:"10",className:"fill-gray-600 text-[10px]",children:"PE IV"})]})]})},D=({data:e,spotPrice:s,strike:a})=>{if(!e||0===e.length)return null;const r=180,l=40,d=20,i=10,n=30,c=e.map(e=>e.price),x=e.map(e=>e.payoff),o=Math.min(...c),m=Math.max(...c),h=Math.min(...x),g=Math.max(...x),p=g-h||1,b=e=>l+(e-o)/(m-o)*(400-l-d),j=e=>i+(g-e)/p*(r-i-n),u=e.map(e=>`${b(e.price)},${j(e.payoff)}`).join(" "),v=j(0);return t.jsxs("svg",{width:"100%",height:r,viewBox:"0 0 400 180",children:[t.jsx("line",{x1:l,y1:v,x2:400-d,y2:v,stroke:"#E5E7EB",strokeWidth:"1"}),t.jsx("line",{x1:b(a),y1:i,x2:b(a),y2:r-n,stroke:"#8B5CF6",strokeWidth:"2",strokeDasharray:"4"}),t.jsx("line",{x1:b(s),y1:i,x2:b(s),y2:r-n,stroke:"#3B82F6",strokeWidth:"2"}),t.jsx("polyline",{points:u,fill:"none",stroke:"#10B981",strokeWidth:"2.5"}),t.jsx("polygon",{points:`${u} ${b(m)},${v} ${b(o)},${v}`,fill:"url(#payoffGradient)"}),t.jsx("defs",{children:t.jsxs("linearGradient",{id:"payoffGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[t.jsx("stop",{offset:"0%",stopColor:"#10B981",stopOpacity:"0.3"}),t.jsx("stop",{offset:"100%",stopColor:"#10B981",stopOpacity:"0"})]})}),t.jsx("text",{x:b(a),y:175,textAnchor:"middle",className:"fill-purple-600 text-[9px] font-bold",children:"Strike"}),t.jsx("text",{x:b(s),y:175,textAnchor:"middle",className:"fill-blue-600 text-[9px] font-bold",children:"Spot"})]})},K=({data:e,ceKey:s,peKey:a,label:r,colors:l,atmStrike:d})=>{if(!e||0===e.length)return null;const i=Math.max(...e.flatMap(e=>[e[s],e[a]])),n=Math.min(40,300/e.length),c=e.length*(2*n+20)+60,x=150;return t.jsxs("svg",{width:"100%",height:200,viewBox:`0 0 ${c} 200`,children:[[.25,.5,.75,1].map((e,s)=>t.jsx("line",{x1:"40",y1:x-e*x+20,x2:c-20,y2:x-e*x+20,stroke:"#E5E7EB",strokeDasharray:"2"},s)),e.map((e,r)=>{const l=50+r*(2*n+20),c=e[s]/i*x,o=e[a]/i*x,m=e.strike===d;return t.jsxs("g",{children:[m&&t.jsx("rect",{x:l-5,y:15,width:2*n+10,height:160,fill:"#3B82F620",rx:"4"}),t.jsx("rect",{x:l,y:170-c,width:n,height:c,fill:"#EF4444",rx:"2"}),t.jsx("rect",{x:l+n,y:170-o,width:n,height:o,fill:"#10B981",rx:"2"}),t.jsx("text",{x:l+n,y:195,textAnchor:"middle",className:"text-[10px] "+(m?"fill-blue-600 font-bold":"fill-gray-500"),children:e.strike})]},e.strike)}),t.jsxs("g",{transform:"translate(50, 5)",children:[t.jsx("rect",{x:"0",y:"0",width:"12",height:"12",fill:"#EF4444",rx:"2"}),t.jsx("text",{x:"16",y:"10",className:"fill-gray-600 text-[10px]",children:"CE"}),t.jsx("rect",{x:"40",y:"0",width:"12",height:"12",fill:"#10B981",rx:"2"}),t.jsx("text",{x:"56",y:"10",className:"fill-gray-600 text-[10px]",children:"PE"})]})]})},U=({strikes:e,atmStrike:a,onAdd:r})=>{const[l,d]=s.useState(a||e[0]||0),[i,n]=s.useState("CE"),[c,x]=s.useState("BUY");return t.jsxs("div",{className:"flex flex-wrap items-end gap-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"Action"}),t.jsxs("div",{className:"flex gap-1",children:[t.jsx("button",{onClick:()=>x("BUY"),className:"px-3 py-1.5 rounded text-sm font-medium "+("BUY"===c?"bg-green-500 text-white":"bg-gray-100 dark:bg-gray-700"),children:"BUY"}),t.jsx("button",{onClick:()=>x("SELL"),className:"px-3 py-1.5 rounded text-sm font-medium "+("SELL"===c?"bg-red-500 text-white":"bg-gray-100 dark:bg-gray-700"),children:"SELL"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"Strike"}),t.jsx("select",{value:l,onChange:e=>d(Number(e.target.value)),className:"px-3 py-1.5 border rounded bg-white dark:bg-gray-700 text-sm",children:e.map(e=>t.jsxs("option",{value:e,children:[e," ",e===a?"(ATM)":""]},e))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"Type"}),t.jsxs("div",{className:"flex gap-1",children:[t.jsx("button",{onClick:()=>n("CE"),className:"px-3 py-1.5 rounded text-sm font-medium "+("CE"===i?"bg-green-500 text-white":"bg-gray-100 dark:bg-gray-700"),children:"CE"}),t.jsx("button",{onClick:()=>n("PE"),className:"px-3 py-1.5 rounded text-sm font-medium "+("PE"===i?"bg-red-500 text-white":"bg-gray-100 dark:bg-gray-700"),children:"PE"})]})]}),t.jsxs("button",{onClick:()=>r(l,i,c),className:"px-4 py-1.5 bg-blue-600 text-white rounded text-sm font-medium hover:bg-blue-700 flex items-center gap-1",children:[t.jsx(B,{className:"w-4 h-4"})," Add Leg"]})]})},Y=({data:e,spotPrice:s,breakevens:a})=>{if(!e||0===e.length)return null;const r=220,l=60,d=20,i=20,n=30,c=e.map(e=>e.price),x=e.map(e=>e.payoff),o=Math.min(...x,0),m=Math.max(...x,0),h=m-o||1,g=e=>l+(e-c[0])/(c[c.length-1]-c[0])*(600-l-d),p=e=>i+(m-e)/h*(r-i-n),b=p(0),j=e.map(e=>`${g(e.price)},${p(e.payoff)}`).join(" "),u=e.filter(e=>e.payoff>=0),v=e.filter(e=>e.payoff<0);return t.jsxs("svg",{width:"100%",height:r,viewBox:"0 0 600 220",children:[t.jsx("line",{x1:l,y1:b,x2:600-d,y2:b,stroke:"#9CA3AF",strokeWidth:"1.5"}),u.length>1&&t.jsx("polygon",{points:`${g(u[0].price)},${b} ${u.map(e=>`${g(e.price)},${p(e.payoff)}`).join(" ")} ${g(u[u.length-1].price)},${b}`,fill:"rgba(16, 185, 129, 0.3)"}),v.length>1&&t.jsx("polygon",{points:`${g(v[0].price)},${b} ${v.map(e=>`${g(e.price)},${p(e.payoff)}`).join(" ")} ${g(v[v.length-1].price)},${b}`,fill:"rgba(239, 68, 68, 0.3)"}),t.jsx("polyline",{points:j,fill:"none",stroke:"#1F2937",strokeWidth:"2.5",strokeLinejoin:"round"}),t.jsx("line",{x1:g(s),y1:i,x2:g(s),y2:r-n,stroke:"#3B82F6",strokeWidth:"2",strokeDasharray:"4"}),t.jsx("text",{x:g(s),y:215,textAnchor:"middle",className:"fill-blue-600 text-[10px] font-bold",children:"Spot"}),a.map((e,s)=>t.jsxs("g",{children:[t.jsx("circle",{cx:g(e),cy:b,r:"5",fill:"#F59E0B"}),t.jsx("text",{x:g(e),y:b-10,textAnchor:"middle",className:"fill-amber-600 text-[9px] font-bold",children:"BE"})]},s)),t.jsxs("text",{x:l-5,y:i+5,textAnchor:"end",className:"fill-green-600 text-[10px] font-medium",children:["+₹",(m/1e3).toFixed(0),"K"]}),t.jsx("text",{x:l-5,y:b+4,textAnchor:"end",className:"fill-gray-500 text-[10px]",children:"0"}),t.jsxs("text",{x:l-5,y:r-n,textAnchor:"end",className:"fill-red-600 text-[10px] font-medium",children:["-₹",(Math.abs(o)/1e3).toFixed(0),"K"]})]})},W=[{id:"oi",label:"OI Analysis",icon:v,component:O},{id:"volume",label:"Volume",icon:I,component:()=>{const a=e(l);e(d);const r=e(i),[n,c]=s.useState(null),x=s.useMemo(()=>a?Object.entries(a).map(([e,s])=>{const t=s.ce||{},a=s.pe||{};return{strike:parseFloat(e),ce_vol:t.volume||t.vol||0,pe_vol:a.volume||a.vol||0,ce_ltp:t.ltp||0,pe_ltp:a.ltp||0,ce_oi:t.OI||t.oi||0,pe_oi:a.OI||a.oi||0,ce_vol_oi_ratio:(t.volume||t.vol||0)/(t.OI||t.oi||1),pe_vol_oi_ratio:(a.volume||a.vol||0)/(a.OI||a.oi||1)}}).filter(e=>e.ce_vol>0||e.pe_vol>0).sort((e,s)=>e.strike-s.strike):[],[a]),o=s.useMemo(()=>{const e=x.reduce((e,s)=>e+s.ce_vol,0),s=x.reduce((e,s)=>e+s.pe_vol,0);return{ce:e,pe:s,ratio:e/(s||1)}},[x]),m=s.useMemo(()=>{const e=[];return x.forEach(s=>{s.ce_vol_oi_ratio>.5&&e.push({strike:s.strike,type:"CE",ratio:s.ce_vol_oi_ratio,vol:s.ce_vol}),s.pe_vol_oi_ratio>.5&&e.push({strike:s.strike,type:"PE",ratio:s.pe_vol_oi_ratio,vol:s.pe_vol})}),e.sort((e,s)=>s.ratio-e.ratio).slice(0,6)},[x]),h=s.useMemo(()=>Math.max(...x.flatMap(e=>[e.ce_vol,e.pe_vol]),1),[x]),g=e=>{if(!e||0===e)return"0";const s=Math.abs(e),t=e<0?"-":"";return s>=1e12?t+(s/1e12).toFixed(2)+"T":s>=1e9?t+(s/1e9).toFixed(2)+"B":s>=1e6?t+(s/1e6).toFixed(2)+"M":s>=1e3?t+(s/1e3).toFixed(1)+"K":t+s.toFixed(0)};return a?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-cyan-500 to-cyan-600 rounded-2xl p-5 text-white shadow-lg shadow-cyan-500/25",children:[t.jsx("div",{className:"absolute -right-4 -top-4 w-16 h-16 bg-white/10 rounded-full blur-xl"}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"text-xs opacity-80 mb-1 font-medium",children:"Total Call Volume"}),t.jsx("div",{className:"text-3xl font-bold",children:g(o.ce)}),t.jsx("div",{className:"text-xs opacity-70 mt-1",children:"Contracts traded"})]})]}),t.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-pink-500 to-rose-600 rounded-2xl p-5 text-white shadow-lg shadow-pink-500/25",children:[t.jsx("div",{className:"absolute -right-4 -top-4 w-16 h-16 bg-white/10 rounded-full blur-xl"}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"text-xs opacity-80 mb-1 font-medium",children:"Total Put Volume"}),t.jsx("div",{className:"text-3xl font-bold",children:g(o.pe)}),t.jsx("div",{className:"text-xs opacity-70 mt-1",children:"Contracts traded"})]})]}),t.jsxs("div",{className:"glass rounded-2xl p-5 border border-slate-200 dark:border-slate-700",children:[t.jsx("div",{className:"text-xs text-slate-500 mb-1 font-medium",children:"Volume Ratio (CE/PE)"}),t.jsx("div",{className:"text-3xl font-bold "+(o.ratio>1?"text-emerald-600":"text-rose-600"),children:o.ratio.toFixed(2)}),t.jsx("div",{className:"text-xs mt-1 "+(o.ratio>1?"text-emerald-500":"text-rose-500"),children:o.ratio>1?"↑ More calls":"↓ More puts"})]}),t.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-amber-500 to-orange-600 rounded-2xl p-5 text-white shadow-lg shadow-amber-500/25",children:[t.jsx("div",{className:"absolute -right-4 -top-4 w-16 h-16 bg-white/10 rounded-full blur-xl"}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"text-xs opacity-80 mb-1 font-medium",children:"Active Strikes"}),t.jsx("div",{className:"text-3xl font-bold",children:x.length}),t.jsx("div",{className:"text-xs opacity-70 mt-1",children:"With volume"})]})]})]}),m.length>0&&t.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-700/50 rounded-xl p-4",children:[t.jsxs("h3",{className:"font-semibold text-amber-700 dark:text-amber-400 flex items-center gap-2 mb-3",children:[t.jsx(w,{className:"w-5 h-5"}),"Volume Spike Alerts (High Volume/OI Ratio)"]}),t.jsx("div",{className:"flex flex-wrap gap-2",children:m.map((e,s)=>t.jsxs("div",{className:"px-3 py-1.5 rounded-lg text-sm font-medium "+("CE"===e.type?"bg-green-100 text-green-700 dark:bg-green-900/50 dark:text-green-300":"bg-red-100 text-red-700 dark:bg-red-900/50 dark:text-red-300"),children:[e.strike," ",e.type," • ",(100*e.ratio).toFixed(0),"% Vol/OI"]},s))})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:t.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[t.jsx(v,{className:"w-5 h-5 text-cyan-500"}),"Volume Distribution by Strike"]})}),t.jsxs("div",{className:"p-4 overflow-x-auto",children:[t.jsx("div",{className:"min-w-[600px] space-y-1",children:x.map((e,s)=>{const a=e.ce_vol/h*100,l=e.pe_vol/h*100,d=e.strike===r,i=n===e.strike;return t.jsxs("div",{className:`flex items-center gap-1 py-1 cursor-pointer rounded ${d?"bg-blue-50 dark:bg-blue-900/30":""} ${i?"bg-gray-50 dark:bg-gray-700/50":""}`,onMouseEnter:()=>c(e.strike),onMouseLeave:()=>c(null),children:[t.jsxs("div",{className:"flex-1 flex justify-end items-center gap-1",children:[i&&t.jsx("span",{className:"text-[10px] text-cyan-600 font-medium",children:g(e.ce_vol)}),t.jsx("div",{className:"h-4 rounded-l bg-gradient-to-l from-cyan-500 to-cyan-400",style:{width:`${a}%`}})]}),t.jsx("div",{className:"w-14 text-center text-xs font-bold py-1 rounded "+(d?"bg-blue-500 text-white":"bg-gray-100 dark:bg-gray-700"),children:e.strike}),t.jsxs("div",{className:"flex-1 flex items-center gap-1",children:[t.jsx("div",{className:"h-4 rounded-r bg-gradient-to-r from-pink-500 to-pink-400",style:{width:`${l}%`}}),i&&t.jsx("span",{className:"text-[10px] text-pink-600 font-medium",children:g(e.pe_vol)})]})]},s)})}),t.jsxs("div",{className:"flex justify-center gap-6 mt-4 text-xs text-gray-500",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"w-3 h-3 rounded bg-cyan-500"})," Call Volume"]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"w-3 h-3 rounded bg-pink-500"})," Put Volume"]})]})]})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:t.jsx("h3",{className:"font-semibold",children:"Strike-wise Volume Details"})}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-xs",children:[t.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"p-2 text-center",children:"Strike"}),t.jsx("th",{className:"p-2 text-right text-cyan-600",children:"CE Vol"}),t.jsx("th",{className:"p-2 text-right text-cyan-600",children:"CE LTP"}),t.jsx("th",{className:"p-2 text-right text-cyan-600",children:"Vol/OI %"}),t.jsx("th",{className:"p-2 text-left text-pink-600",children:"Vol/OI %"}),t.jsx("th",{className:"p-2 text-left text-pink-600",children:"PE LTP"}),t.jsx("th",{className:"p-2 text-left text-pink-600",children:"PE Vol"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:x.slice(0,20).map((e,s)=>t.jsxs("tr",{className:e.strike===r?"bg-blue-50 dark:bg-blue-900/20":"",children:[t.jsx("td",{className:"p-2 text-center font-bold",children:e.strike}),t.jsx("td",{className:"p-2 text-right",children:g(e.ce_vol)}),t.jsx("td",{className:"p-2 text-right",children:e.ce_ltp.toFixed(2)}),t.jsx("td",{className:"p-2 text-right",children:t.jsxs("span",{className:"px-1 rounded "+(e.ce_vol_oi_ratio>.5?"bg-amber-100 text-amber-700":""),children:[(100*e.ce_vol_oi_ratio).toFixed(0),"%"]})}),t.jsx("td",{className:"p-2 text-left",children:t.jsxs("span",{className:"px-1 rounded "+(e.pe_vol_oi_ratio>.5?"bg-amber-100 text-amber-700":""),children:[(100*e.pe_vol_oi_ratio).toFixed(0),"%"]})}),t.jsx("td",{className:"p-2 text-left",children:e.pe_ltp.toFixed(2)}),t.jsx("td",{className:"p-2 text-left",children:g(e.pe_vol)})]},s))})]})})]})]}):t.jsxs("div",{className:"p-8 text-center text-gray-400",children:[t.jsx(v,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),t.jsx("p",{children:"Load Option Chain data first"})]})}},{id:"greeks",label:"Greeks",icon:_,component:()=>{const a=e(l);e(d);const r=e(i),[n,c]=s.useState("delta"),x=s.useMemo(()=>a?Object.entries(a).map(([e,s])=>{const t=s.ce?.optgeeks||s.ce?.greeks||{},a=s.pe?.optgeeks||s.pe?.greeks||{};return{strike:parseFloat(e),ce_delta:t.delta||0,pe_delta:a.delta||0,ce_gamma:t.gamma||0,pe_gamma:a.gamma||0,ce_theta:t.theta||0,pe_theta:a.theta||0,ce_vega:t.vega||0,pe_vega:a.vega||0,ce_iv:s.ce?.iv||0,pe_iv:s.pe?.iv||0}}).filter(e=>0!==e.ce_delta||0!==e.pe_delta).sort((e,s)=>e.strike-s.strike):[],[a]),o=s.useMemo(()=>({delta:x.reduce((e,s)=>e+s.ce_delta+s.pe_delta,0),gamma:x.reduce((e,s)=>e+s.ce_gamma+s.pe_gamma,0),theta:x.reduce((e,s)=>e+s.ce_theta+s.pe_theta,0),vega:x.reduce((e,s)=>e+s.ce_vega+s.pe_vega,0)}),[x]),m=(e,s,t)=>{const a=Math.abs(e),r=Math.min(a/({delta:1,gamma:.01,theta:50,vega:100}[s]||1),1);return"ce"===t?`rgba(16, 185, 129, ${r})`:`rgba(239, 68, 68, ${r})`};return a&&0!==x.length?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-emerald-500 to-teal-600 rounded-2xl p-5 text-white shadow-lg shadow-emerald-500/25",children:[t.jsx("div",{className:"absolute -right-4 -top-4 w-16 h-16 bg-white/10 rounded-full blur-xl"}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"text-xs opacity-80 mb-1 font-medium",children:"Net Delta"}),t.jsx("div",{className:"text-3xl font-bold",children:o.delta.toFixed(2)}),t.jsx("div",{className:"text-xs opacity-70 mt-1",children:"Direction exposure"})]})]}),t.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-violet-500 to-purple-600 rounded-2xl p-5 text-white shadow-lg shadow-violet-500/25",children:[t.jsx("div",{className:"absolute -right-4 -top-4 w-16 h-16 bg-white/10 rounded-full blur-xl"}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"text-xs opacity-80 mb-1 font-medium",children:"Net Gamma"}),t.jsx("div",{className:"text-3xl font-bold",children:o.gamma.toFixed(4)}),t.jsx("div",{className:"text-xs opacity-70 mt-1",children:"Acceleration"})]})]}),t.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-cyan-500 to-blue-600 rounded-2xl p-5 text-white shadow-lg shadow-cyan-500/25",children:[t.jsx("div",{className:"absolute -right-4 -top-4 w-16 h-16 bg-white/10 rounded-full blur-xl"}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"text-xs opacity-80 mb-1 font-medium",children:"Net Theta"}),t.jsx("div",{className:"text-3xl font-bold",children:o.theta.toFixed(2)}),t.jsx("div",{className:"text-xs opacity-70 mt-1",children:"Time decay"})]})]}),t.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl p-5 text-white shadow-lg shadow-blue-500/25",children:[t.jsx("div",{className:"absolute -right-4 -top-4 w-16 h-16 bg-white/10 rounded-full blur-xl"}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"text-xs opacity-80 mb-1 font-medium",children:"Net Vega"}),t.jsx("div",{className:"text-3xl font-bold",children:o.vega.toFixed(2)}),t.jsx("div",{className:"text-xs opacity-70 mt-1",children:"Volatility"})]})]})]}),t.jsx("div",{className:"flex gap-2 p-1 bg-slate-100 dark:bg-slate-800 rounded-xl w-fit",children:["delta","gamma","theta","vega"].map(e=>t.jsx("button",{onClick:()=>c(e),className:"px-5 py-2.5 rounded-lg text-sm font-bold capitalize transition-all "+(n===e?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-lg":"text-slate-600 dark:text-slate-400 hover:bg-white dark:hover:bg-slate-700"),children:e},e))}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:t.jsxs("h3",{className:"font-semibold flex items-center gap-2 capitalize",children:[t.jsx(_,{className:"w-5 h-5 text-purple-500"}),n," Heatmap by Strike"]})}),t.jsx("div",{className:"p-4 overflow-x-auto",children:t.jsxs("div",{className:"min-w-[600px]",children:[t.jsxs("div",{className:"flex items-center gap-1 mb-2 text-xs text-gray-500",children:[t.jsxs("div",{className:"flex-1 text-right",children:["CE ",n]}),t.jsx("div",{className:"w-14 text-center font-bold",children:"Strike"}),t.jsxs("div",{className:"flex-1 text-left",children:["PE ",n]})]}),x.map((e,s)=>{const a=e[`ce_${n}`],l=e[`pe_${n}`],d=e.strike===r;return t.jsxs("div",{className:"flex items-center gap-1 py-0.5 "+(d?"bg-blue-50 dark:bg-blue-900/20":""),children:[t.jsx("div",{className:"flex-1 flex justify-end",children:t.jsx("div",{className:"px-2 py-1 rounded text-xs font-medium text-right min-w-16",style:{backgroundColor:m(a,n,"ce")},children:a.toFixed("gamma"===n?4:2)})}),t.jsx("div",{className:"w-14 text-center text-xs font-bold py-1 rounded "+(d?"bg-blue-500 text-white":"bg-gray-100 dark:bg-gray-700"),children:e.strike}),t.jsx("div",{className:"flex-1",children:t.jsx("div",{className:"px-2 py-1 rounded text-xs font-medium min-w-16",style:{backgroundColor:m(l,n,"pe")},children:l.toFixed("gamma"===n?4:2)})})]},s)})]})})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:t.jsxs("h3",{className:"font-semibold flex items-center gap-2 capitalize",children:[t.jsx(v,{className:"w-5 h-5 text-blue-500"}),n," Distribution"]})}),t.jsx("div",{className:"p-4",children:t.jsx(A,{data:x,greek:n,atmStrike:r,colors:{delta:{ce:"#10B981",pe:"#EF4444"},gamma:{ce:"#8B5CF6",pe:"#F59E0B"},theta:{ce:"#06B6D4",pe:"#EC4899"},vega:{ce:"#3B82F6",pe:"#84CC16"}}[n]})})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:t.jsx("h3",{className:"font-semibold",children:"IV Skew Analysis"})}),t.jsx("div",{className:"p-4",children:t.jsx(V,{data:x,atmStrike:r})})]})]}):t.jsxs("div",{className:"p-8 text-center text-gray-400",children:[t.jsx(_,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),t.jsx("p",{children:"No Greeks data available. Load Option Chain first."})]})}},{id:"straddle",label:"Straddle",icon:E,component:()=>{const a=e(l),r=e(d),n=e(i),c=e(m);e(h);const[x,o]=s.useState(null),[g,p]=s.useState(100),b=s.useMemo(()=>a?Object.keys(a).map(Number).sort((e,s)=>e-s):[],[a]),j=s.useMemo(()=>{if(!a||!n)return null;const e=x||n,s=a[e];if(!s)return null;const t=s.ce||{},r=s.pe||{},l=t.ltp||0,d=r.ltp||0,i=l+d;return{strike:e,ceLTP:l,peLTP:d,straddlePrice:i,upperBE:e+i,lowerBE:e-i,ceIV:t.iv||0,peIV:r.iv||0,avgIV:((t.iv||0)+(r.iv||0))/2,ceDelta:t.optgeeks?.delta||0,peDelta:r.optgeeks?.delta||0,ceTheta:t.optgeeks?.theta||0,peTheta:r.optgeeks?.theta||0,maxLoss:i,expectedMove:i/e*100}},[a,n,x]),u=s.useMemo(()=>{if(!a||!n)return null;const e=n+g,s=n-g,t=a[e]?.ce||{},r=a[s]?.pe||{},l=t.ltp||0,d=r.ltp||0,i=l+d;return{ceStrike:e,peStrike:s,ceLTP:l,peLTP:d,stranglePrice:i,upperBE:e+i,lowerBE:s-i,savings:j?j.straddlePrice-i:0}},[a,n,g,j]),y=s.useMemo(()=>{if(!j)return[];const{strike:e,straddlePrice:s}=j,t=[];for(let a=e-500;a<=e+500;a+=10){const s=Math.max(0,a-e)-j.ceLTP,r=Math.max(0,e-a)-j.peLTP;t.push({price:a,payoff:s+r})}return t},[j]);return a?t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"glass rounded-2xl p-4 border border-slate-200/50 dark:border-slate-700/50",children:t.jsxs("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("label",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300",children:"Strike:"}),t.jsx("select",{value:x||n,onChange:e=>o(Number(e.target.value)),className:"px-4 py-2 rounded-xl border border-slate-200 dark:border-slate-600 bg-white dark:bg-slate-800 text-sm font-medium focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 transition-all",children:b.map(e=>t.jsxs("option",{value:e,children:[e," ",e===n?"(ATM)":""]},e))})]}),t.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-purple-50 dark:bg-purple-900/30 rounded-xl",children:[t.jsx(C,{className:"w-4 h-4 text-purple-600 dark:text-purple-400"}),t.jsxs("span",{className:"text-sm font-semibold text-purple-700 dark:text-purple-300",children:[c," days to expiry"]})]})]})}),j&&t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-violet-500 to-purple-600 rounded-2xl p-5 text-white shadow-lg shadow-violet-500/25",children:[t.jsx("div",{className:"absolute -right-4 -top-4 w-16 h-16 bg-white/10 rounded-full blur-xl"}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"text-xs opacity-80 mb-1 font-medium",children:"Straddle Price"}),t.jsxs("div",{className:"text-3xl font-bold",children:["₹",j.straddlePrice.toFixed(2)]}),t.jsx("div",{className:"text-xs opacity-70 mt-1",children:"CE + PE Premium"})]})]}),t.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-emerald-500 to-green-600 rounded-2xl p-5 text-white shadow-lg shadow-emerald-500/25",children:[t.jsx("div",{className:"absolute -right-4 -top-4 w-16 h-16 bg-white/10 rounded-full blur-xl"}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"text-xs opacity-80 mb-1 font-medium",children:"Upper Breakeven"}),t.jsx("div",{className:"text-3xl font-bold",children:j.upperBE.toFixed(0)}),t.jsxs("div",{className:"text-xs opacity-70 mt-1",children:["+",(j.upperBE-r).toFixed(0)," from spot"]})]})]}),t.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-rose-500 to-red-600 rounded-2xl p-5 text-white shadow-lg shadow-rose-500/25",children:[t.jsx("div",{className:"absolute -right-4 -top-4 w-16 h-16 bg-white/10 rounded-full blur-xl"}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"text-xs opacity-80 mb-1 font-medium",children:"Lower Breakeven"}),t.jsx("div",{className:"text-3xl font-bold",children:j.lowerBE.toFixed(0)}),t.jsxs("div",{className:"text-xs opacity-70 mt-1",children:[(j.lowerBE-r).toFixed(0)," from spot"]})]})]}),t.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-amber-500 to-orange-600 rounded-2xl p-5 text-white shadow-lg shadow-amber-500/25",children:[t.jsx("div",{className:"absolute -right-4 -top-4 w-16 h-16 bg-white/10 rounded-full blur-xl"}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"text-xs opacity-80 mb-1 font-medium",children:"Expected Move"}),t.jsxs("div",{className:"text-3xl font-bold",children:["±",j.expectedMove.toFixed(2),"%"]}),t.jsxs("div",{className:"text-xs opacity-70 mt-1",children:[j.straddlePrice.toFixed(0)," pts range"]})]})]})]}),j&&t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:t.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[t.jsx(E,{className:"w-5 h-5 text-purple-500"}),"Premium Breakdown"]})}),t.jsxs("div",{className:"p-4 space-y-4",children:[t.jsxs("div",{className:"flex h-8 rounded-lg overflow-hidden",children:[t.jsxs("div",{className:"bg-green-500 flex items-center justify-center text-white text-xs font-bold",style:{width:j.ceLTP/j.straddlePrice*100+"%"},children:["CE ₹",j.ceLTP.toFixed(0)]}),t.jsxs("div",{className:"bg-red-500 flex items-center justify-center text-white text-xs font-bold",style:{width:j.peLTP/j.straddlePrice*100+"%"},children:["PE ₹",j.peLTP.toFixed(0)]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500",children:"CE Premium"}),t.jsxs("div",{className:"font-bold text-green-600",children:["₹",j.ceLTP.toFixed(2)]})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500",children:"PE Premium"}),t.jsxs("div",{className:"font-bold text-red-600",children:["₹",j.peLTP.toFixed(2)]})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500",children:"CE IV"}),t.jsxs("div",{className:"font-bold",children:[j.ceIV.toFixed(2),"%"]})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500",children:"PE IV"}),t.jsxs("div",{className:"font-bold",children:[j.peIV.toFixed(2),"%"]})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500",children:"Net Theta"}),t.jsxs("div",{className:"font-bold text-amber-600",children:["₹",(j.ceTheta+j.peTheta).toFixed(2)]})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500",children:"Net Delta"}),t.jsx("div",{className:"font-bold",children:(j.ceDelta+j.peDelta).toFixed(3)})]})]})]})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:t.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[t.jsx(v,{className:"w-5 h-5 text-blue-500"}),"Payoff Diagram"]})}),t.jsx("div",{className:"p-4",children:t.jsx(D,{data:y,spotPrice:r,strike:j.strike})})]})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:t.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[t.jsx(F,{className:"w-5 h-5 text-indigo-500"}),"Strangle Builder"]})}),t.jsxs("div",{className:"p-4",children:[t.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[t.jsx("label",{className:"text-sm font-medium",children:"Width from ATM:"}),t.jsx("input",{type:"range",min:"50",max:"500",step:"50",value:g,onChange:e=>p(Number(e.target.value)),className:"flex-1"}),t.jsxs("span",{className:"font-bold text-indigo-600",children:[g," pts"]})]}),u&&t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 text-center",children:[t.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-3",children:[t.jsx("div",{className:"text-xs text-green-600",children:"CE Strike"}),t.jsx("div",{className:"font-bold text-lg",children:u.ceStrike}),t.jsxs("div",{className:"text-sm text-green-600",children:["₹",u.ceLTP.toFixed(2)]})]}),t.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 rounded-lg p-3",children:[t.jsx("div",{className:"text-xs text-red-600",children:"PE Strike"}),t.jsx("div",{className:"font-bold text-lg",children:u.peStrike}),t.jsxs("div",{className:"text-sm text-red-600",children:["₹",u.peLTP.toFixed(2)]})]}),t.jsxs("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 rounded-lg p-3",children:[t.jsx("div",{className:"text-xs text-indigo-600",children:"Strangle Price"}),t.jsxs("div",{className:"font-bold text-lg",children:["₹",u.stranglePrice.toFixed(2)]})]}),t.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/20 rounded-lg p-3",children:[t.jsx("div",{className:"text-xs text-amber-600",children:"Savings vs Straddle"}),t.jsxs("div",{className:"font-bold text-lg text-green-600",children:["₹",u.savings.toFixed(2)]})]}),t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3",children:[t.jsx("div",{className:"text-xs text-gray-600",children:"Breakeven Range"}),t.jsxs("div",{className:"font-bold",children:[u.lowerBE.toFixed(0)," - ",u.upperBE.toFixed(0)]})]})]})]})]})]}):t.jsxs("div",{className:"p-8 text-center text-gray-400",children:[t.jsx(E,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),t.jsx("p",{children:"Load Option Chain data first"})]})}},{id:"multistrike",label:"Multi-Strike",icon:$,component:()=>{const a=e(l);e(d);const r=e(i),[n,c]=s.useState([]),[x,o]=s.useState("oi"),m=s.useMemo(()=>a?Object.keys(a).map(Number).sort((e,s)=>e-s):[],[a]),h=s.useCallback(e=>{!n.includes(e)&&n.length<8&&c(s=>[...s,e].sort((e,s)=>e-s))},[n]),g=s.useCallback(e=>{c(s=>s.filter(s=>s!==e))},[]),p=s.useCallback(()=>{if(!r)return;const e=m.filter(e=>Math.abs(e-r)<=300);c(e.slice(0,8))},[r,m]),b=s.useMemo(()=>a&&0!==n.length?n.map(e=>{const s=a[e],t=s?.ce||{},r=s?.pe||{};return{strike:e,ce_oi:t.OI||t.oi||0,pe_oi:r.OI||r.oi||0,ce_volume:t.volume||t.vol||0,pe_volume:r.volume||r.vol||0,ce_iv:t.iv||0,pe_iv:r.iv||0,ce_ltp:t.ltp||0,pe_ltp:r.ltp||0,ce_delta:t.optgeeks?.delta||0,pe_delta:r.optgeeks?.delta||0,ce_theta:t.optgeeks?.theta||0,pe_theta:r.optgeeks?.theta||0,ce_gamma:t.optgeeks?.gamma||0,pe_gamma:r.optgeeks?.gamma||0}}):[],[a,n]),j=[{key:"oi",label:"Open Interest",ceKey:"ce_oi",peKey:"pe_oi"},{key:"volume",label:"Volume",ceKey:"ce_volume",peKey:"pe_volume"},{key:"iv",label:"IV %",ceKey:"ce_iv",peKey:"pe_iv"},{key:"ltp",label:"LTP",ceKey:"ce_ltp",peKey:"pe_ltp"},{key:"delta",label:"Delta",ceKey:"ce_delta",peKey:"pe_delta"},{key:"theta",label:"Theta",ceKey:"ce_theta",peKey:"pe_theta"}],u=j.find(e=>e.key===x)||j[0],y=e=>e>=1e5?(e/1e5).toFixed(2)+"L":e>=1e3?(e/1e3).toFixed(1)+"K":e?.toFixed(2)||"0",f=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#06B6D4","#EC4899","#84CC16"];return a?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[t.jsx(P,{className:"w-5 h-5 text-blue-500"}),"Select Strikes to Compare (max 8)"]}),t.jsx("button",{onClick:p,className:"px-3 py-1.5 bg-blue-100 dark:bg-blue-900/50 text-blue-700 dark:text-blue-300 rounded-lg text-sm font-medium hover:bg-blue-200",children:"Add ATM ±300"})]}),t.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[n.map((e,s)=>t.jsxs("div",{className:"flex items-center gap-1 px-3 py-1.5 rounded-lg text-sm font-medium text-white",style:{backgroundColor:f[s%f.length]},children:[e," ",e===r&&"(ATM)",t.jsx("button",{onClick:()=>g(e),className:"ml-1 hover:bg-white/20 rounded p-0.5",children:t.jsx(N,{className:"w-4 h-4"})})]},e)),0===n.length&&t.jsx("span",{className:"text-gray-400 text-sm",children:"Click strikes below to add..."})]}),t.jsx("div",{className:"flex flex-wrap gap-1 max-h-40 overflow-y-auto",children:m.map(e=>{const s=n.includes(e),a=e===r;return t.jsx("button",{onClick:()=>s?g(e):h(e),disabled:!s&&n.length>=8,className:`px-2 py-1 text-xs rounded transition-colors ${s?"bg-blue-500 text-white":a?"bg-blue-100 dark:bg-blue-900/50 text-blue-700 dark:text-blue-300 hover:bg-blue-200":"bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600"} ${n.length>=8&&!s?"opacity-50 cursor-not-allowed":""}`,children:e},e)})})]}),n.length>0&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"flex gap-2 flex-wrap",children:j.map(e=>t.jsx("button",{onClick:()=>o(e.key),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors "+(x===e.key?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600"),children:e.label},e.key))}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:t.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[t.jsx(v,{className:"w-5 h-5 text-blue-500"}),u.label," Comparison"]})}),t.jsx("div",{className:"p-4",children:t.jsx(K,{data:b,ceKey:u.ceKey,peKey:u.peKey,label:u.label,colors:f,atmStrike:r})})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:t.jsx("h3",{className:"font-semibold",children:"Detailed Comparison"})}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-xs",children:[t.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"p-2 text-left",children:"Metric"}),b.map((e,s)=>t.jsxs("th",{className:"p-2 text-center",style:{color:f[s%f.length]},children:[e.strike," ",e.strike===r&&"⭐"]},e.strike))]})}),t.jsxs("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:[t.jsxs("tr",{children:[t.jsx("td",{className:"p-2 font-medium text-red-600",children:"CE OI"}),b.map(e=>t.jsx("td",{className:"p-2 text-center",children:y(e.ce_oi)},e.strike))]}),t.jsxs("tr",{children:[t.jsx("td",{className:"p-2 font-medium text-green-600",children:"PE OI"}),b.map(e=>t.jsx("td",{className:"p-2 text-center",children:y(e.pe_oi)},e.strike))]}),t.jsxs("tr",{children:[t.jsx("td",{className:"p-2 font-medium text-red-600",children:"CE LTP"}),b.map(e=>t.jsxs("td",{className:"p-2 text-center",children:["₹",e.ce_ltp.toFixed(2)]},e.strike))]}),t.jsxs("tr",{children:[t.jsx("td",{className:"p-2 font-medium text-green-600",children:"PE LTP"}),b.map(e=>t.jsxs("td",{className:"p-2 text-center",children:["₹",e.pe_ltp.toFixed(2)]},e.strike))]}),t.jsxs("tr",{children:[t.jsx("td",{className:"p-2 font-medium text-red-600",children:"CE IV"}),b.map(e=>t.jsxs("td",{className:"p-2 text-center",children:[e.ce_iv.toFixed(1),"%"]},e.strike))]}),t.jsxs("tr",{children:[t.jsx("td",{className:"p-2 font-medium text-green-600",children:"PE IV"}),b.map(e=>t.jsxs("td",{className:"p-2 text-center",children:[e.pe_iv.toFixed(1),"%"]},e.strike))]}),t.jsxs("tr",{children:[t.jsx("td",{className:"p-2 font-medium text-red-600",children:"CE Delta"}),b.map(e=>t.jsx("td",{className:"p-2 text-center",children:e.ce_delta.toFixed(3)},e.strike))]}),t.jsxs("tr",{children:[t.jsx("td",{className:"p-2 font-medium text-green-600",children:"PE Delta"}),b.map(e=>t.jsx("td",{className:"p-2 text-center",children:e.pe_delta.toFixed(3)},e.strike))]}),t.jsxs("tr",{className:"bg-purple-50 dark:bg-purple-900/20",children:[t.jsx("td",{className:"p-2 font-medium",children:"Straddle"}),b.map(e=>t.jsxs("td",{className:"p-2 text-center font-bold",children:["₹",(e.ce_ltp+e.pe_ltp).toFixed(2)]},e.strike))]})]})]})})]})]})]}):t.jsxs("div",{className:"p-8 text-center text-gray-400",children:[t.jsx(v,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),t.jsx("p",{children:"Load Option Chain data first"})]})}},{id:"strategy",label:"Strategy",icon:S,component:()=>{const a=e(l),r=e(d),n=e(i),c=e(g),[x,o]=s.useState([]),[m,h]=s.useState(!1),p=s.useMemo(()=>a?Object.keys(a).map(Number).sort((e,s)=>e-s):[],[a]),b=s.useCallback((e,s,t)=>{const r=a?.[e];if(!r)return;const l="CE"===s?r.ce:r.pe;l&&o(a=>[...a,{id:Date.now(),strike:e,type:s,action:t,qty:1,ltp:l.ltp||0,iv:l.iv||0,delta:l.optgeeks?.delta||0,theta:l.optgeeks?.theta||0,gamma:l.optgeeks?.gamma||0,vega:l.optgeeks?.vega||0}])},[a]),j=s.useCallback(e=>{o(s=>s.filter(s=>s.id!==e))},[]),u=s.useCallback((e,s)=>{o(t=>t.map(t=>t.id===e?{...t,qty:Math.max(1,s)}:t))},[]),y=s.useCallback(()=>o([]),[]),N=[{name:"Long Straddle",build:()=>{b(n,"CE","BUY"),b(n,"PE","BUY")}},{name:"Short Straddle",build:()=>{b(n,"CE","SELL"),b(n,"PE","SELL")}},{name:"Bull Call Spread",build:()=>{b(n,"CE","BUY"),b(n+100,"CE","SELL")}},{name:"Bear Put Spread",build:()=>{b(n,"PE","BUY"),b(n-100,"PE","SELL")}},{name:"Iron Condor",build:()=>{b(n-200,"PE","BUY"),b(n-100,"PE","SELL"),b(n+100,"CE","SELL"),b(n+200,"CE","BUY")}},{name:"Iron Butterfly",build:()=>{b(n,"CE","SELL"),b(n,"PE","SELL"),b(n+100,"CE","BUY"),b(n-100,"PE","BUY")}},{name:"Long Strangle",build:()=>{b(n+100,"CE","BUY"),b(n-100,"PE","BUY")}}],f=s.useMemo(()=>{if(0===x.length)return null;let e=0,s=0,t=0,a=0,r=0;return x.forEach(l=>{const d="BUY"===l.action?-1:1;e+=l.ltp*l.qty*d,s+=l.delta*l.qty*("BUY"===l.action?1:-1),t+=l.gamma*l.qty*("BUY"===l.action?1:-1),a+=l.theta*l.qty*("BUY"===l.action?1:-1),r+=l.vega*l.qty*("BUY"===l.action?1:-1)}),{totalPremium:e*c,netDelta:s,netGamma:t,netTheta:a,netVega:r,maxProfit:e>0?e*c:"Unlimited",maxLoss:e<0?Math.abs(e)*c:"Limited"}},[x,c]),k=s.useMemo(()=>{if(0===x.length)return[];const e=[];for(let s=r-1e3;s<=r+1e3;s+=10){let t=0;x.forEach(e=>{let a=0;a="CE"===e.type?Math.max(0,s-e.strike):Math.max(0,e.strike-s);const r=(a-e.ltp)*e.qty;t+="BUY"===e.action?r:-r}),e.push({price:s,payoff:t*c})}return e},[x,r,c]),w=s.useMemo(()=>{if(k.length<2)return[];const e=[];for(let s=1;s<k.length;s++)(k[s-1].payoff<0&&k[s].payoff>=0||k[s-1].payoff>=0&&k[s].payoff<0)&&e.push(k[s].price);return e},[k]);return a?t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:t.jsxs("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[t.jsx(S,{className:"w-5 h-5 text-purple-500"}),"Strategy Builder"]}),t.jsxs("span",{className:"text-sm text-gray-500",children:["Lot Size: ",c]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("div",{className:"relative",children:[t.jsx("button",{onClick:()=>h(!m),className:"px-4 py-2 bg-purple-100 dark:bg-purple-900/50 text-purple-700 dark:text-purple-300 rounded-lg text-sm font-medium hover:bg-purple-200",children:"Presets ▾"}),m&&t.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700 z-10",children:N.map((e,s)=>t.jsx("button",{onClick:()=>{y(),setTimeout(e.build,50),h(!1)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 dark:hover:bg-gray-700 first:rounded-t-lg last:rounded-b-lg",children:e.name},s))})]}),t.jsx("button",{onClick:y,disabled:0===x.length,className:"px-4 py-2 bg-red-100 dark:bg-red-900/50 text-red-700 dark:text-red-300 rounded-lg text-sm font-medium hover:bg-red-200 disabled:opacity-50",children:"Clear All"})]})]})}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:t.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[t.jsx(B,{className:"w-5 h-5 text-blue-500"}),"Add Legs"]})}),t.jsx("div",{className:"p-4",children:t.jsx(U,{strikes:p,atmStrike:n,onAdd:b})})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:t.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[t.jsx(L,{className:"w-5 h-5 text-green-500"}),"Strategy Summary"]})}),t.jsx("div",{className:"p-4",children:f?t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"p-3 rounded-lg "+(f.totalPremium>=0?"bg-green-50 dark:bg-green-900/20":"bg-red-50 dark:bg-red-900/20"),children:[t.jsx("div",{className:"text-xs text-gray-500",children:"Net Premium"}),t.jsxs("div",{className:"text-lg font-bold "+(f.totalPremium>=0?"text-green-600":"text-red-600"),children:[f.totalPremium>=0?"+":"","₹",f.totalPremium.toFixed(0)]}),t.jsx("div",{className:"text-[10px] text-gray-400",children:f.totalPremium>=0?"Credit":"Debit"})]}),t.jsxs("div",{className:"p-3 rounded-lg bg-gray-50 dark:bg-gray-700/50",children:[t.jsx("div",{className:"text-xs text-gray-500",children:"Net Delta"}),t.jsx("div",{className:"text-lg font-bold",children:f.netDelta.toFixed(3)})]}),t.jsxs("div",{className:"p-3 rounded-lg bg-gray-50 dark:bg-gray-700/50",children:[t.jsx("div",{className:"text-xs text-gray-500",children:"Net Theta"}),t.jsxs("div",{className:"text-lg font-bold "+(f.netTheta>=0?"text-green-600":"text-red-600"),children:["₹",f.netTheta.toFixed(2)]})]}),t.jsxs("div",{className:"p-3 rounded-lg bg-gray-50 dark:bg-gray-700/50",children:[t.jsx("div",{className:"text-xs text-gray-500",children:"Net Gamma"}),t.jsx("div",{className:"text-lg font-bold",children:f.netGamma.toFixed(4)})]}),t.jsxs("div",{className:"p-3 rounded-lg bg-gray-50 dark:bg-gray-700/50",children:[t.jsx("div",{className:"text-xs text-gray-500",children:"Net Vega"}),t.jsx("div",{className:"text-lg font-bold",children:f.netVega.toFixed(2)})]}),t.jsxs("div",{className:"p-3 rounded-lg bg-blue-50 dark:bg-blue-900/20",children:[t.jsx("div",{className:"text-xs text-gray-500",children:"Breakevens"}),t.jsx("div",{className:"text-sm font-bold text-blue-600",children:w.length>0?w.join(", "):"N/A"})]})]}):t.jsx("div",{className:"text-center text-gray-400 py-8",children:"Add legs to see summary"})})]})]}),x.length>0&&t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:t.jsxs("h3",{className:"font-semibold",children:["Strategy Legs (",x.length,")"]})}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"p-2 text-left",children:"Action"}),t.jsx("th",{className:"p-2 text-center",children:"Strike"}),t.jsx("th",{className:"p-2 text-center",children:"Type"}),t.jsx("th",{className:"p-2 text-center",children:"Qty"}),t.jsx("th",{className:"p-2 text-right",children:"LTP"}),t.jsx("th",{className:"p-2 text-right",children:"IV"}),t.jsx("th",{className:"p-2 text-right",children:"Delta"}),t.jsx("th",{className:"p-2 text-right",children:"Value"}),t.jsx("th",{className:"p-2"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:x.map(e=>t.jsxs("tr",{children:[t.jsx("td",{className:"p-2",children:t.jsx("span",{className:"px-2 py-1 rounded text-xs font-bold "+("BUY"===e.action?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:e.action})}),t.jsx("td",{className:"p-2 text-center font-bold",children:e.strike}),t.jsx("td",{className:"p-2 text-center",children:t.jsx("span",{className:"px-2 py-0.5 rounded text-xs "+("CE"===e.type?"bg-green-50 text-green-700":"bg-red-50 text-red-700"),children:e.type})}),t.jsx("td",{className:"p-2 text-center",children:t.jsx("input",{type:"number",min:"1",value:e.qty,onChange:s=>u(e.id,parseInt(s.target.value)||1),className:"w-12 text-center border rounded px-1 py-0.5"})}),t.jsxs("td",{className:"p-2 text-right",children:["₹",e.ltp.toFixed(2)]}),t.jsxs("td",{className:"p-2 text-right",children:[e.iv.toFixed(1),"%"]}),t.jsx("td",{className:"p-2 text-right",children:e.delta.toFixed(3)}),t.jsxs("td",{className:"p-2 text-right font-medium "+("SELL"===e.action?"text-green-600":"text-red-600"),children:["SELL"===e.action?"+":"-","₹",(e.ltp*e.qty*c).toFixed(0)]}),t.jsx("td",{className:"p-2",children:t.jsx("button",{onClick:()=>j(e.id),className:"p-1 hover:bg-red-100 rounded text-red-500",children:t.jsx(M,{className:"w-4 h-4"})})})]},e.id))})]})})]}),k.length>0&&t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[t.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:t.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[t.jsx(v,{className:"w-5 h-5 text-blue-500"}),"Payoff at Expiry"]})}),t.jsx("div",{className:"p-4",children:t.jsx(Y,{data:k,spotPrice:r,breakevens:w})})]})]}):t.jsxs("div",{className:"p-8 text-center text-gray-400",children:[t.jsx(S,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),t.jsx("p",{children:"Load Option Chain data first"})]})}}],R=()=>{const i=a(),n=e(p),c=e(o),x=e(b),h=e(d),g=e(m),y=e(j),N=e(l),f=c||n||"NIFTY",[k,w]=s.useState("oi"),[_,E]=s.useState(new Date),F=s.useCallback(()=>{n&&x&&(i(u({symbol:n,expiry:String(x)})),E(new Date))},[i,n,x]);s.useEffect(()=>{const e=setInterval(F,3e4);return()=>clearInterval(e)},[F]);const P=W.find(e=>e.id===k)?.component||O;return N||y?t.jsxs(t.Fragment,{children:[t.jsx(r,{children:t.jsxs("title",{children:[f," Analytics | Stockify"]})}),t.jsxs("div",{className:"min-h-screen bg-mesh-gradient",children:[t.jsx("div",{className:"sticky top-0 z-40 glass-strong border-b border-slate-200/50 dark:border-slate-700/50",children:t.jsxs("div",{className:"px-4 py-3",children:[t.jsxs("div",{className:"flex items-center justify-between gap-4 mb-3",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("span",{className:"relative flex h-2.5 w-2.5",children:[t.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"}),t.jsx("span",{className:"relative inline-flex rounded-full h-2.5 w-2.5 bg-green-500"})]}),t.jsx("span",{className:"text-xs font-medium text-green-600 dark:text-green-400",children:"Live"})]}),t.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:f}),t.jsxs("span",{className:"text-xl font-bold text-blue-600 dark:text-blue-400",children:["₹",h?.toFixed(2)]}),t.jsx("span",{className:"px-2 py-1 bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 rounded-lg text-xs font-medium",children:(e=>{if(!e)return"";return new Date(1e3*Number(e)).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"2-digit"})})(x)}),t.jsxs("span",{className:"px-2 py-1 bg-purple-100 dark:bg-purple-900/50 text-purple-700 dark:text-purple-300 rounded-lg text-xs font-bold flex items-center gap-1",children:[t.jsx(C,{className:"w-3 h-3"}),g," DTE"]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("span",{className:"text-xs text-gray-400 hidden sm:block",children:["Updated: ",_.toLocaleTimeString()]}),t.jsx("button",{onClick:F,disabled:y,className:"p-2.5 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-xl hover:shadow-lg hover:shadow-blue-500/25 transition-all disabled:opacity-50",children:t.jsx(T,{className:"w-4 h-4 "+(y?"animate-spin":"")})})]})]}),t.jsx("div",{className:"flex gap-2 overflow-x-auto pb-1 scrollbar-hide",children:W.map(e=>{const s=e.icon,a=k===e.id;return t.jsxs("button",{onClick:()=>w(e.id),className:"flex items-center gap-2 px-4 py-2.5 rounded-xl text-sm font-semibold whitespace-nowrap transition-all duration-200 "+(a?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-lg shadow-blue-500/25":"bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-700"),children:[t.jsx(s,{className:"w-4 h-4"}),e.label]},e.id)})})]})}),t.jsx("div",{className:"p-4 md:p-6",children:t.jsx("div",{className:"glass-strong rounded-2xl p-4 md:p-6 animate-fade-in",children:t.jsx(P,{})})})]})]}):t.jsxs(t.Fragment,{children:[t.jsx(r,{children:t.jsx("title",{children:"Analytics | Stockify"})}),t.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:t.jsxs("div",{className:"text-center p-8 bg-white dark:bg-gray-800 rounded-2xl shadow-xl max-w-md",children:[t.jsx(v,{className:"w-16 h-16 mx-auto text-gray-300 dark:text-gray-600 mb-4"}),t.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"No Data Available"}),t.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"Please visit the Option Chain page first to load market data."}),t.jsx("a",{href:"/option-chain",className:"inline-block px-6 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors",children:"Go to Option Chain"})]})})]})};export{R as default};
